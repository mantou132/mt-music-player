{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./fe/components/splash/index.js","webpack:///./fe/js_modules/npm:lit-html@1.0.0/lib/directive.js","webpack:///./fe/js_modules/npm:lit-html@1.0.0/lib/dom.js","webpack:///./fe/js_modules/npm:lit-html@1.0.0/lib/part.js","webpack:///./fe/js_modules/npm:lit-html@1.0.0/lib/template.js","webpack:///./fe/js_modules/npm:lit-html@1.0.0/lib/template-instance.js","webpack:///./fe/js_modules/npm:lit-html@1.0.0/lib/template-result.js","webpack:///./fe/js_modules/npm:lit-html@1.0.0/lib/parts.js","webpack:///./fe/js_modules/npm:lit-html@1.0.0/lib/default-template-processor.js","webpack:///./fe/js_modules/npm:lit-html@1.0.0/lib/template-factory.js","webpack:///./fe/js_modules/npm:lit-html@1.0.0/lib/render.js","webpack:///./fe/js_modules/npm:lit-html@1.0.0/lit-html.js","webpack:///./fe/lib/mediaquery.js","webpack:///./fe/theme.js","webpack:///./fe/icons/index.js","webpack:///./fe/lib/store.js","webpack:///./fe/config/index.js","webpack:///./fe/utils/misc.js","webpack:///./fe/lib/component.js","webpack:///./fe/utils/object.js","webpack:///./fe/utils/storage.js","webpack:///./fe/lib/history.js","webpack:///./fe/models/appstate.js","webpack:///./fe/models/window.js","webpack:///./fe/models/data.js","webpack:///./fe/models/index.js","webpack:///./fe/lib/request.js","webpack:///./fe/models/data-map.js","webpack:///./fe/services/song.js","webpack:///./fe/components/upload/index.js","webpack:///./fe/services/playlist.js","webpack:///./fe/components/modal/body.js","webpack:///./fe/components/modal/index.js","webpack:///./fe/components/modals/add-playlist.js","webpack:///./fe/components/router/map.js","webpack:///./fe/components/drawer/index.js","webpack:///./fe/components/action/index.js","webpack:///./fe/utils/string.js","webpack:///./fe/components/confirm/index.js","webpack:///./fe/utils/color.js","webpack:///./fe/utils/canvas.js","webpack:///./fe/components/image/index.js","webpack:///./fe/components/form/button.js","webpack:///./fe/components/form/image.js","webpack:///./fe/components/form/text.js","webpack:///./fe/components/form/index.js","webpack:///./fe/components/link/index.js","webpack:///./fe/js_modules/npm:lit-html@1.0.0/directives/repeat.js","webpack:///./fe/components/list/song.js","webpack:///./fe/utils/datetime.js","webpack:///./fe/components/menu/index.js","webpack:///./fe/components/modals/song-edit.js","webpack:///./fe/components/list/song-item.js","webpack:///./fe/components/list/playlist.js","webpack:///./fe/components/list/album.js","webpack:///./fe/components/list/artist.js","webpack:///./fe/components/list/gallery-item.js","webpack:///./fe/components/notfound/index.js","webpack:///./fe/components/player/song-info.js","webpack:///./fe/components/player/mediasession.js","webpack:///./fe/components/player/control.js","webpack:///./fe/components/player/volume.js","webpack:///./fe/components/player/progress.js","webpack:///./fe/components/player/audio.js","webpack:///./fe/components/player/index.js","webpack:///./fe/components/range/index.js","webpack:///./fe/components/ripple/index.js","webpack:///./fe/services/album.js","webpack:///./fe/services/artist.js","webpack:///./fe/components/router/index.js","webpack:///./fe/components/title/index.js","webpack:///./fe/components/toast/index.js","webpack:///./fe/index.js","webpack:///./fe/utils/feature.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","installedModules","0","__webpack_require__","exports","module","l","e","promises","installedChunkData","promise","Promise","resolve","reject","onScriptComplete","script","document","createElement","charset","timeout","nc","setAttribute","src","p","jsonpScriptSrc","error","Error","event","onerror","onload","clearTimeout","chunk","errorType","type","realSrc","target","message","name","request","undefined","setTimeout","head","appendChild","all","m","c","d","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","oe","err","console","jsonpArray","window","oldJsonpFunction","slice","s","LIFE_TIME","AppSplash","HTMLElement","constructor","super","this","remove","now","performance","end","customElements","directives","isDirective","isCEPolyfill","reparentNodes","container","start","before","node","removeNodes","startNode","endNode","noChange","nothing","marker","String","Math","nodeMarker","markerRegex","RegExp","boundAttributeSuffix","Template","parts","element","index","partIndex","nodesToRemove","_prepareTemplate","content","template","walker","createTreeWalker","lastPartIndex","attributes","count","stringForPart","result","lastAttributeNameRegex","attributeLookupName","strings","attributeValue","parent","lastIndex","isTemplatePartActive","part","createMarker","_parts","processor","options","update","values","_clone","fragment","cloneNode","nodeIndex","_prepareInstance","handleTextExpression","handleAttributeExpressions","getHTML","endIndex","html","match","getTemplateElement","isPrimitive","AttributeCommitter","dirty","_createPart","_getValue","text","v","Array","commit","committer","comitter","setValue","directive","_pendingValue","appendInto","insertAfterNode","ref","appendIntoPart","insertAfterPart","_commitText","_commitTemplateResult","_commitNode","_commitIterable","clear","_insert","parentNode","insertBefore","templateFactory","instance","itemParts","itemPart","item","removeAttribute","PropertyCommitter","single","PropertyPart","eventOptionsSupported","_e","eventName","eventContext","_boundHandleEvent","handleEvent","newListener","oldListener","shouldRemoveListener","shouldAddListener","removeEventListener","_options","getOptions","addEventListener","capture","passive","once","defaultTemplateProcessor","prefix","templateCache","templateCaches","stringsArray","keyString","Map","render","assign","mediaQuery","HOVER","PHONE","LAPTOP","DESKTOP","PHONE_LANDSCAPE","TABLET","SMALL_PHONE","WATCH","SHORT","PWA","MOTION_REDUCE","attachShadow","connectedCallback","getAttribute","attributeChangedCallback","newValue","attributeName","STORE_MODULE","STORE_MODULE_KEY","FUNC_MARK_KEY","HANDLES_KEY","createStore","originStore","proxy","Proxy","has","set","listeners","func","keys","storeModule","updaterSet","updateStore","queueMicrotask","storeKey","connect","disconnect","async","getAbbrPinyin","长名称","汉字","default","pinyin","py","style","STYLE_INITIALS","str","getPinyin","getSrc","config","storage","renderTaskPool","add","pool","delete","currentId","exec","requestAnimationFrame","callback","timestamp","task","isMountedSymbol","connectedStorePages","state","setState","willMount","mounted","shouldUpdate","updated","connectStores","disconnectStores","attributeChanged","unmounted","observedStores","observedPropertys","prop","propValue","mergeObject","obj1","obj2","newObject","wrap","Set","storeModuleList","disconnectedCallback","forEach","Component","SingleInstanceComponent","cache","localStorage","sessionStorage","QueryString","URLSearchParams","param","append","concat","query","toString","string","toJSON","colseHandleMap","generateState","close","$key","Date","$close","store","historyState","list","currentIndex","history","basePath","location","path","title","href","forward","back","newList","pushState","replace","replaceState","search","newStateIndex","historyItem","closeHandle","userData","avatar","playerState","pip","maximize","errorList","currentSong","volume","muted","shuffle","audioState","currentTime","duration","toastState","selectorState","uploaderState","modalState","isOpen","complete","cancel","onclose","oncomplete","oncancel","confirmState","menuState","stage","drawerState","songData","searchData","favoriteData","artistData","albumData","playlistData","JSON","res","fetch","api","DataMap","id","setList","songMap","playlistMap","map","getFavorite","star","upload","files","fileArr","file","formData","method","body","uploadedIndex","findIndex","f","uploadedItem","song","picture","q","input","shadowRoot","querySelector","AppUpload","addSong","songId","InitData","Modal","hidden","classList","getAddPlaylistModal","form","menus","routeMap","icon","Drawer","getContents","actions","ele","AppAction","getSearchInput","capitalize","kebabCase","htmlClass","obj","reduce","Confirm","luminance","g","b","a","hueToRGB","transformTextToSVG","range","backgroundRGB","h","hslToRGB","randomNumber","color","randomRGBColor","total","background","getTranslate","strs","char","getRotate","encodeURIComponent","transformSVGDataURLToBitmap","width","height","img","canvas","createCanvas","ctx","compressionImg","blob","reader","blobToDataURL","rate","limit","option","toBlob","File","altPlaceholderMap","altPlaceholder","alt","aspectRatio","fit","autoSizeClass","autosize","Image","attr","disabled","revokeURL","blobUrl","URL","onclick","isComposition","inputHandle","compositionHandle","isStartedInput","setStartedInput","dispatchEvent","CustomEvent","detail","label","pattern","placeholder","required","hasAttribute","fn","delay","timer","rest","connected","focus","querySelectorAll","elements","valid","createAndInsertPart","containerPart","beforePart","beforeNode","newPart","updatePart","insertPartBefore","removePart","generateMap","partListCache","keyListCache","repeat","args","items","keyFnOrTemplate","keyFn","oldParts","oldKeys","newParts","newValues","newKeys","newKeyToIndexMap","oldHead","oldTail","newHead","newTail","oldKeyToIndexMap","oldIndex","oldPart","playIcon","isError","updatedAt","filtername","filtervalue","fetchData","AppSongList","secondToMinute","number","second","AppMenu","position","x","y","translate","stageRect","targetRect","getSongEditModal","Number","playlistId","handle","editHandle","deleteHandle","songIndex","sId","removeSong","addToPlaylist","getRootNode","deletedIndex","del","link","cover","subTitle","image","photo","dec","emptyFunction","mediaSession","metadata","artist","album","getPicture","navigator","onplay","onpause","onseekbackward","onseekforward","onprevioustrack","onnexttrack","prevIndex","nextIndex","nextTime","randomPlay","nextPlay","audio","play","randomIndex","isPlayingState","isErrorState","video","requestPictureInPicture","catch","enterPictureInPicture","pause","setInterval","onended","endHandle","playError","onplaying","playSuccess","onabort","setCurrentTime","srcObject","draw","landscape","clickHandle","nextValue","touchHandleTimer","ontouchstart","ontouchend","onmousedown","touchStartHandle","targetTouches","touche","top","left","currentTop","isEqual","ignores","mouseDownHandle","offsetX","offsetY","touchEndHandle","isCircle","parseInt","scale","opacity","clientHeight","cancelAnimationFrame","raf","cssText","clientWidth","scrollTop","action","songs","route","find","showToastList","showUploaderState","preprocess","toast","AppToast","CSS"],"mappings":"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","file":"index.c42071dc3e846b04f519.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t};\n\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t0: 0\n \t};\n\n\n\n \t// script path function\n \tfunction jsonpScriptSrc(chunkId) {\n \t\treturn __webpack_require__.p + \"\" + ({}[chunkId]||chunkId) + \".\" + {\"1\":\"f63af56f06ff0b75b4bb\"}[chunkId] + \".js\"\n \t}\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n \t// This file contains only the entry chunk.\n \t// The chunk loading function for additional chunks\n \t__webpack_require__.e = function requireEnsure(chunkId) {\n \t\tvar promises = [];\n\n\n \t\t// JSONP chunk loading for javascript\n\n \t\tvar installedChunkData = installedChunks[chunkId];\n \t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n \t\t\t// a Promise means \"currently loading\".\n \t\t\tif(installedChunkData) {\n \t\t\t\tpromises.push(installedChunkData[2]);\n \t\t\t} else {\n \t\t\t\t// setup Promise in chunk cache\n \t\t\t\tvar promise = new Promise(function(resolve, reject) {\n \t\t\t\t\tinstalledChunkData = installedChunks[chunkId] = [resolve, reject];\n \t\t\t\t});\n \t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n \t\t\t\t// start chunk loading\n \t\t\t\tvar script = document.createElement('script');\n \t\t\t\tvar onScriptComplete;\n\n \t\t\t\tscript.charset = 'utf-8';\n \t\t\t\tscript.timeout = 120;\n \t\t\t\tif (__webpack_require__.nc) {\n \t\t\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n \t\t\t\t}\n \t\t\t\tscript.src = jsonpScriptSrc(chunkId);\n\n \t\t\t\t// create error before stack unwound to get useful stacktrace later\n \t\t\t\tvar error = new Error();\n \t\t\t\tonScriptComplete = function (event) {\n \t\t\t\t\t// avoid mem leaks in IE.\n \t\t\t\t\tscript.onerror = script.onload = null;\n \t\t\t\t\tclearTimeout(timeout);\n \t\t\t\t\tvar chunk = installedChunks[chunkId];\n \t\t\t\t\tif(chunk !== 0) {\n \t\t\t\t\t\tif(chunk) {\n \t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n \t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n \t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n \t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n \t\t\t\t\t\t\terror.type = errorType;\n \t\t\t\t\t\t\terror.request = realSrc;\n \t\t\t\t\t\t\tchunk[1](error);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tinstalledChunks[chunkId] = undefined;\n \t\t\t\t\t}\n \t\t\t\t};\n \t\t\t\tvar timeout = setTimeout(function(){\n \t\t\t\t\tonScriptComplete({ type: 'timeout', target: script });\n \t\t\t\t}, 120000);\n \t\t\t\tscript.onerror = script.onload = onScriptComplete;\n \t\t\t\tdocument.head.appendChild(script);\n \t\t\t}\n \t\t}\n \t\treturn Promise.all(promises);\n \t};\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// on error function for async loading\n \t__webpack_require__.oe = function(err) { console.error(err); throw err; };\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n","const LIFE_TIME = 1000;\n\nclass AppSplash extends HTMLElement {\n  constructor() {\n    super();\n    const now = performance.now();\n    if (now > LIFE_TIME) {\n      this.end();\n    } else {\n      setTimeout(this.end, LIFE_TIME - now);\n    }\n  }\n\n  end = () => {\n    this.remove();\n  };\n}\ncustomElements.define('app-splash', AppSplash);\n","/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\nconst directives = new WeakMap();\n/**\n * Brands a function as a directive so that lit-html will call the function\n * during template rendering, rather than passing as a value.\n *\n * @param f The directive factory function. Must be a function that returns a\n * function of the signature `(part: Part) => void`. The returned function will\n * be called with the part object\n *\n * @example\n *\n * ```\n * import {directive, html} from 'lit-html';\n *\n * const immutable = directive((v) => (part) => {\n *   if (part.value !== v) {\n *     part.setValue(v)\n *   }\n * });\n * ```\n */\n// tslint:disable-next-line:no-any\nexport const directive = (f) => ((...args) => {\n    const d = f(...args);\n    directives.set(d, true);\n    return d;\n});\nexport const isDirective = (o) => {\n    return typeof o === 'function' && directives.has(o);\n};\n//# sourceMappingURL=directive.js.map","/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n/**\n * True if the custom elements polyfill is in use.\n */\nexport const isCEPolyfill = window.customElements !== undefined &&\n    window.customElements.polyfillWrapFlushCallback !==\n        undefined;\n/**\n * Reparents nodes, starting from `startNode` (inclusive) to `endNode`\n * (exclusive), into another container (could be the same container), before\n * `beforeNode`. If `beforeNode` is null, it appends the nodes to the\n * container.\n */\nexport const reparentNodes = (container, start, end = null, before = null) => {\n    let node = start;\n    while (node !== end) {\n        const n = node.nextSibling;\n        container.insertBefore(node, before);\n        node = n;\n    }\n};\n/**\n * Removes nodes, starting from `startNode` (inclusive) to `endNode`\n * (exclusive), from `container`.\n */\nexport const removeNodes = (container, startNode, endNode = null) => {\n    let node = startNode;\n    while (node !== endNode) {\n        const n = node.nextSibling;\n        container.removeChild(node);\n        node = n;\n    }\n};\n//# sourceMappingURL=dom.js.map","/**\n * @license\n * Copyright (c) 2018 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n/**\n * A sentinel value that signals that a value was handled by a directive and\n * should not be written to the DOM.\n */\nexport const noChange = {};\n/**\n * A sentinel value that signals a NodePart to fully clear its content.\n */\nexport const nothing = {};\n//# sourceMappingURL=part.js.map","/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n/**\n * An expression marker with embedded unique key to avoid collision with\n * possible text in templates.\n */\nexport const marker = `{{lit-${String(Math.random()).slice(2)}}}`;\n/**\n * An expression marker used text-positions, multi-binding attributes, and\n * attributes with markup-like text values.\n */\nexport const nodeMarker = `<!--${marker}-->`;\nexport const markerRegex = new RegExp(`${marker}|${nodeMarker}`);\n/**\n * Suffix appended to all bound attribute names.\n */\nexport const boundAttributeSuffix = '$lit$';\n/**\n * An updateable Template that tracks the location of dynamic parts.\n */\nexport class Template {\n    constructor(result, element) {\n        this.parts = [];\n        this.element = element;\n        let index = -1;\n        let partIndex = 0;\n        const nodesToRemove = [];\n        const _prepareTemplate = (template) => {\n            const content = template.content;\n            // Edge needs all 4 parameters present; IE11 needs 3rd parameter to be\n            // null\n            const walker = document.createTreeWalker(content, 133 /* NodeFilter.SHOW_{ELEMENT|COMMENT|TEXT} */, null, false);\n            // Keeps track of the last index associated with a part. We try to delete\n            // unnecessary nodes, but we never want to associate two different parts\n            // to the same index. They must have a constant node between.\n            let lastPartIndex = 0;\n            while (walker.nextNode()) {\n                index++;\n                const node = walker.currentNode;\n                if (node.nodeType === 1 /* Node.ELEMENT_NODE */) {\n                    if (node.hasAttributes()) {\n                        const attributes = node.attributes;\n                        // Per\n                        // https://developer.mozilla.org/en-US/docs/Web/API/NamedNodeMap,\n                        // attributes are not guaranteed to be returned in document order.\n                        // In particular, Edge/IE can return them out of order, so we cannot\n                        // assume a correspondance between part index and attribute index.\n                        let count = 0;\n                        for (let i = 0; i < attributes.length; i++) {\n                            if (attributes[i].value.indexOf(marker) >= 0) {\n                                count++;\n                            }\n                        }\n                        while (count-- > 0) {\n                            // Get the template literal section leading up to the first\n                            // expression in this attribute\n                            const stringForPart = result.strings[partIndex];\n                            // Find the attribute name\n                            const name = lastAttributeNameRegex.exec(stringForPart)[2];\n                            // Find the corresponding attribute\n                            // All bound attributes have had a suffix added in\n                            // TemplateResult#getHTML to opt out of special attribute\n                            // handling. To look up the attribute value we also need to add\n                            // the suffix.\n                            const attributeLookupName = name.toLowerCase() + boundAttributeSuffix;\n                            const attributeValue = node.getAttribute(attributeLookupName);\n                            const strings = attributeValue.split(markerRegex);\n                            this.parts.push({ type: 'attribute', index, name, strings });\n                            node.removeAttribute(attributeLookupName);\n                            partIndex += strings.length - 1;\n                        }\n                    }\n                    if (node.tagName === 'TEMPLATE') {\n                        _prepareTemplate(node);\n                    }\n                }\n                else if (node.nodeType === 3 /* Node.TEXT_NODE */) {\n                    const data = node.data;\n                    if (data.indexOf(marker) >= 0) {\n                        const parent = node.parentNode;\n                        const strings = data.split(markerRegex);\n                        const lastIndex = strings.length - 1;\n                        // Generate a new text node for each literal section\n                        // These nodes are also used as the markers for node parts\n                        for (let i = 0; i < lastIndex; i++) {\n                            parent.insertBefore((strings[i] === '') ? createMarker() :\n                                document.createTextNode(strings[i]), node);\n                            this.parts.push({ type: 'node', index: ++index });\n                        }\n                        // If there's no text, we must insert a comment to mark our place.\n                        // Else, we can trust it will stick around after cloning.\n                        if (strings[lastIndex] === '') {\n                            parent.insertBefore(createMarker(), node);\n                            nodesToRemove.push(node);\n                        }\n                        else {\n                            node.data = strings[lastIndex];\n                        }\n                        // We have a part for each match found\n                        partIndex += lastIndex;\n                    }\n                }\n                else if (node.nodeType === 8 /* Node.COMMENT_NODE */) {\n                    if (node.data === marker) {\n                        const parent = node.parentNode;\n                        // Add a new marker node to be the startNode of the Part if any of\n                        // the following are true:\n                        //  * We don't have a previousSibling\n                        //  * The previousSibling is already the start of a previous part\n                        if (node.previousSibling === null || index === lastPartIndex) {\n                            index++;\n                            parent.insertBefore(createMarker(), node);\n                        }\n                        lastPartIndex = index;\n                        this.parts.push({ type: 'node', index });\n                        // If we don't have a nextSibling, keep this node so we have an end.\n                        // Else, we can remove it to save future costs.\n                        if (node.nextSibling === null) {\n                            node.data = '';\n                        }\n                        else {\n                            nodesToRemove.push(node);\n                            index--;\n                        }\n                        partIndex++;\n                    }\n                    else {\n                        let i = -1;\n                        while ((i = node.data.indexOf(marker, i + 1)) !==\n                            -1) {\n                            // Comment node has a binding marker inside, make an inactive part\n                            // The binding won't work, but subsequent bindings will\n                            // TODO (justinfagnani): consider whether it's even worth it to\n                            // make bindings in comments work\n                            this.parts.push({ type: 'node', index: -1 });\n                        }\n                    }\n                }\n            }\n        };\n        _prepareTemplate(element);\n        // Remove text binding nodes after the walk to not disturb the TreeWalker\n        for (const n of nodesToRemove) {\n            n.parentNode.removeChild(n);\n        }\n    }\n}\nexport const isTemplatePartActive = (part) => part.index !== -1;\n// Allows `document.createComment('')` to be renamed for a\n// small manual size-savings.\nexport const createMarker = () => document.createComment('');\n/**\n * This regex extracts the attribute name preceding an attribute-position\n * expression. It does this by matching the syntax allowed for attributes\n * against the string literal directly preceding the expression, assuming that\n * the expression is in an attribute-value position.\n *\n * See attributes in the HTML spec:\n * https://www.w3.org/TR/html5/syntax.html#attributes-0\n *\n * \"\\0-\\x1F\\x7F-\\x9F\" are Unicode control characters\n *\n * \" \\x09\\x0a\\x0c\\x0d\" are HTML space characters:\n * https://www.w3.org/TR/html5/infrastructure.html#space-character\n *\n * So an attribute is:\n *  * The name: any character except a control character, space character, ('),\n *    (\"), \">\", \"=\", or \"/\"\n *  * Followed by zero or more space characters\n *  * Followed by \"=\"\n *  * Followed by zero or more space characters\n *  * Followed by:\n *    * Any character except space, ('), (\"), \"<\", \">\", \"=\", (`), or\n *    * (\") then any non-(\"), or\n *    * (') then any non-(')\n */\nexport const lastAttributeNameRegex = /([ \\x09\\x0a\\x0c\\x0d])([^\\0-\\x1F\\x7F-\\x9F \\x09\\x0a\\x0c\\x0d\"'>=/]+)([ \\x09\\x0a\\x0c\\x0d]*=[ \\x09\\x0a\\x0c\\x0d]*(?:[^ \\x09\\x0a\\x0c\\x0d\"'`<>=]*|\"[^\"]*|'[^']*))$/;\n//# sourceMappingURL=template.js.map","/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n\n/**\n * @module lit-html\n */\nimport { isCEPolyfill } from './dom.js';\nimport { isTemplatePartActive } from './template.js';\n/**\n * An instance of a `Template` that can be attached to the DOM and updated\n * with new values.\n */\n\nexport class TemplateInstance {\n  constructor(template, processor, options) {\n    this._parts = [];\n    this.template = template;\n    this.processor = processor;\n    this.options = options;\n  }\n\n  update(values) {\n    let i = 0;\n\n    for (const part of this._parts) {\n      if (part !== undefined) {\n        part.setValue(values[i]);\n      }\n\n      i++;\n    }\n\n    for (const part of this._parts) {\n      if (part !== undefined) {\n        part.commit();\n      }\n    }\n  }\n\n  _clone() {\n    // When using the Custom Elements polyfill, clone the node, rather than\n    // importing it, to keep the fragment in the template's document. This\n    // leaves the fragment inert so custom elements won't upgrade and\n    // potentially modify their contents by creating a polyfilled ShadowRoot\n    // while we traverse the tree.\n    const fragment = isCEPolyfill ? this.template.element.content.cloneNode(true) : document.importNode(this.template.element.content, true);\n    const parts = this.template.parts;\n    let partIndex = 0;\n    let nodeIndex = 0;\n\n    const _prepareInstance = fragment => {\n      // Edge needs all 4 parameters present; IE11 needs 3rd parameter to be\n      // null\n      const walker = document.createTreeWalker(fragment, 133\n      /* NodeFilter.SHOW_{ELEMENT|COMMENT|TEXT} */\n      , null, false);\n      let node = walker.nextNode(); // Loop through all the nodes and parts of a template\n\n      while (partIndex < parts.length && node !== null) {\n        const part = parts[partIndex]; // Consecutive Parts may have the same node index, in the case of\n        // multiple bound attributes on an element. So each iteration we either\n        // increment the nodeIndex, if we aren't on a node with a part, or the\n        // partIndex if we are. By not incrementing the nodeIndex when we find a\n        // part, we allow for the next part to be associated with the current\n        // node if neccessasry.\n\n        if (!isTemplatePartActive(part)) {\n          this._parts.push(undefined);\n\n          partIndex++;\n        } else if (nodeIndex === part.index) {\n          if (part.type === 'node') {\n            const part = this.processor.handleTextExpression(this.options);\n            part.insertAfterNode(node.previousSibling);\n\n            this._parts.push(part);\n          } else {\n            this._parts.push(...this.processor.handleAttributeExpressions(node, part.name, part.strings, this.options));\n          }\n\n          partIndex++;\n        } else {\n          nodeIndex++;\n\n          if (node.nodeName === 'TEMPLATE') {\n            _prepareInstance(node.content);\n          }\n\n          node = walker.nextNode();\n        }\n      }\n    };\n\n    _prepareInstance(fragment);\n\n    if (isCEPolyfill) {\n      document.adoptNode(fragment);\n      customElements.upgrade(fragment);\n    }\n\n    return fragment;\n  }\n\n}","/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n\n/**\n * @module lit-html\n */\nimport { reparentNodes } from './dom.js';\nimport { boundAttributeSuffix, lastAttributeNameRegex, marker, nodeMarker } from './template.js';\n/**\n * The return type of `html`, which holds a Template and the values from\n * interpolated expressions.\n */\n\nexport class TemplateResult {\n  constructor(strings, values, type, processor) {\n    this.strings = strings;\n    this.values = values;\n    this.type = type;\n    this.processor = processor;\n  }\n  /**\n   * Returns a string of HTML used to create a `<template>` element.\n   */\n\n\n  getHTML() {\n    const endIndex = this.strings.length - 1;\n    let html = '';\n\n    for (let i = 0; i < endIndex; i++) {\n      const s = this.strings[i]; // This exec() call does two things:\n      // 1) Appends a suffix to the bound attribute name to opt out of special\n      // attribute value parsing that IE11 and Edge do, like for style and\n      // many SVG attributes. The Template class also appends the same suffix\n      // when looking up attributes to create Parts.\n      // 2) Adds an unquoted-attribute-safe marker for the first expression in\n      // an attribute. Subsequent attribute expressions will use node markers,\n      // and this is safe since attributes with multiple expressions are\n      // guaranteed to be quoted.\n\n      const match = lastAttributeNameRegex.exec(s);\n\n      if (match) {\n        // We're starting a new bound attribute.\n        // Add the safe attribute suffix, and use unquoted-attribute-safe\n        // marker.\n        html += s.substr(0, match.index) + match[1] + match[2] + boundAttributeSuffix + match[3] + marker;\n      } else {\n        // We're either in a bound node, or trailing bound attribute.\n        // Either way, nodeMarker is safe to use.\n        html += s + nodeMarker;\n      }\n    }\n\n    return html + this.strings[endIndex];\n  }\n\n  getTemplateElement() {\n    const template = document.createElement('template');\n    template.innerHTML = this.getHTML();\n    return template;\n  }\n\n}\n/**\n * A TemplateResult for SVG fragments.\n *\n * This class wraps HTMl in an `<svg>` tag in order to parse its contents in the\n * SVG namespace, then modifies the template to remove the `<svg>` tag so that\n * clones only container the original fragment.\n */\n\nexport class SVGTemplateResult extends TemplateResult {\n  getHTML() {\n    return `<svg>${super.getHTML()}</svg>`;\n  }\n\n  getTemplateElement() {\n    const template = super.getTemplateElement();\n    const content = template.content;\n    const svgElement = content.firstChild;\n    content.removeChild(svgElement);\n    reparentNodes(content, svgElement.firstChild);\n    return template;\n  }\n\n}","/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n\n/**\n * @module lit-html\n */\nimport { isDirective } from './directive.js';\nimport { removeNodes } from './dom.js';\nimport { noChange, nothing } from './part.js';\nimport { TemplateInstance } from './template-instance.js';\nimport { TemplateResult } from './template-result.js';\nimport { createMarker } from './template.js';\nexport const isPrimitive = value => {\n  return value === null || !(typeof value === 'object' || typeof value === 'function');\n};\n/**\n * Sets attribute values for AttributeParts, so that the value is only set once\n * even if there are multiple parts for an attribute.\n */\n\nexport class AttributeCommitter {\n  constructor(element, name, strings) {\n    this.dirty = true;\n    this.element = element;\n    this.name = name;\n    this.strings = strings;\n    this.parts = [];\n\n    for (let i = 0; i < strings.length - 1; i++) {\n      this.parts[i] = this._createPart();\n    }\n  }\n  /**\n   * Creates a single part. Override this to create a differnt type of part.\n   */\n\n\n  _createPart() {\n    return new AttributePart(this);\n  }\n\n  _getValue() {\n    const strings = this.strings;\n    const l = strings.length - 1;\n    let text = '';\n\n    for (let i = 0; i < l; i++) {\n      text += strings[i];\n      const part = this.parts[i];\n\n      if (part !== undefined) {\n        const v = part.value;\n\n        if (v != null && (Array.isArray(v) || // tslint:disable-next-line:no-any\n        typeof v !== 'string' && v[Symbol.iterator])) {\n          for (const t of v) {\n            text += typeof t === 'string' ? t : String(t);\n          }\n        } else {\n          text += typeof v === 'string' ? v : String(v);\n        }\n      }\n    }\n\n    text += strings[l];\n    return text;\n  }\n\n  commit() {\n    if (this.dirty) {\n      this.dirty = false;\n      this.element.setAttribute(this.name, this._getValue());\n    }\n  }\n\n}\nexport class AttributePart {\n  constructor(comitter) {\n    this.value = undefined;\n    this.committer = comitter;\n  }\n\n  setValue(value) {\n    if (value !== noChange && (!isPrimitive(value) || value !== this.value)) {\n      this.value = value; // If the value is a not a directive, dirty the committer so that it'll\n      // call setAttribute. If the value is a directive, it'll dirty the\n      // committer if it calls setValue().\n\n      if (!isDirective(value)) {\n        this.committer.dirty = true;\n      }\n    }\n  }\n\n  commit() {\n    while (isDirective(this.value)) {\n      const directive = this.value;\n      this.value = noChange;\n      directive(this);\n    }\n\n    if (this.value === noChange) {\n      return;\n    }\n\n    this.committer.commit();\n  }\n\n}\nexport class NodePart {\n  constructor(options) {\n    this.value = undefined;\n    this._pendingValue = undefined;\n    this.options = options;\n  }\n  /**\n   * Inserts this part into a container.\n   *\n   * This part must be empty, as its contents are not automatically moved.\n   */\n\n\n  appendInto(container) {\n    this.startNode = container.appendChild(createMarker());\n    this.endNode = container.appendChild(createMarker());\n  }\n  /**\n   * Inserts this part between `ref` and `ref`'s next sibling. Both `ref` and\n   * its next sibling must be static, unchanging nodes such as those that appear\n   * in a literal section of a template.\n   *\n   * This part must be empty, as its contents are not automatically moved.\n   */\n\n\n  insertAfterNode(ref) {\n    this.startNode = ref;\n    this.endNode = ref.nextSibling;\n  }\n  /**\n   * Appends this part into a parent part.\n   *\n   * This part must be empty, as its contents are not automatically moved.\n   */\n\n\n  appendIntoPart(part) {\n    part._insert(this.startNode = createMarker());\n\n    part._insert(this.endNode = createMarker());\n  }\n  /**\n   * Appends this part after `ref`\n   *\n   * This part must be empty, as its contents are not automatically moved.\n   */\n\n\n  insertAfterPart(ref) {\n    ref._insert(this.startNode = createMarker());\n\n    this.endNode = ref.endNode;\n    ref.endNode = this.startNode;\n  }\n\n  setValue(value) {\n    this._pendingValue = value;\n  }\n\n  commit() {\n    while (isDirective(this._pendingValue)) {\n      const directive = this._pendingValue;\n      this._pendingValue = noChange;\n      directive(this);\n    }\n\n    const value = this._pendingValue;\n\n    if (value === noChange) {\n      return;\n    }\n\n    if (isPrimitive(value)) {\n      if (value !== this.value) {\n        this._commitText(value);\n      }\n    } else if (value instanceof TemplateResult) {\n      this._commitTemplateResult(value);\n    } else if (value instanceof Node) {\n      this._commitNode(value);\n    } else if (Array.isArray(value) || // tslint:disable-next-line:no-any\n    value[Symbol.iterator]) {\n      this._commitIterable(value);\n    } else if (value === nothing) {\n      this.value = nothing;\n      this.clear();\n    } else {\n      // Fallback, will render the string representation\n      this._commitText(value);\n    }\n  }\n\n  _insert(node) {\n    this.endNode.parentNode.insertBefore(node, this.endNode);\n  }\n\n  _commitNode(value) {\n    if (this.value === value) {\n      return;\n    }\n\n    this.clear();\n\n    this._insert(value);\n\n    this.value = value;\n  }\n\n  _commitText(value) {\n    const node = this.startNode.nextSibling;\n    value = value == null ? '' : value;\n\n    if (node === this.endNode.previousSibling && node.nodeType === 3\n    /* Node.TEXT_NODE */\n    ) {\n        // If we only have a single text node between the markers, we can just\n        // set its value, rather than replacing it.\n        // TODO(justinfagnani): Can we just check if this.value is primitive?\n        node.data = value;\n      } else {\n      this._commitNode(document.createTextNode(typeof value === 'string' ? value : String(value)));\n    }\n\n    this.value = value;\n  }\n\n  _commitTemplateResult(value) {\n    const template = this.options.templateFactory(value);\n\n    if (this.value instanceof TemplateInstance && this.value.template === template) {\n      this.value.update(value.values);\n    } else {\n      // Make sure we propagate the template processor from the TemplateResult\n      // so that we use its syntax extension, etc. The template factory comes\n      // from the render function options so that it can control template\n      // caching and preprocessing.\n      const instance = new TemplateInstance(template, value.processor, this.options);\n\n      const fragment = instance._clone();\n\n      instance.update(value.values);\n\n      this._commitNode(fragment);\n\n      this.value = instance;\n    }\n  }\n\n  _commitIterable(value) {\n    // For an Iterable, we create a new InstancePart per item, then set its\n    // value to the item. This is a little bit of overhead for every item in\n    // an Iterable, but it lets us recurse easily and efficiently update Arrays\n    // of TemplateResults that will be commonly returned from expressions like:\n    // array.map((i) => html`${i}`), by reusing existing TemplateInstances.\n    // If _value is an array, then the previous render was of an\n    // iterable and _value will contain the NodeParts from the previous\n    // render. If _value is not an array, clear this part and make a new\n    // array for NodeParts.\n    if (!Array.isArray(this.value)) {\n      this.value = [];\n      this.clear();\n    } // Lets us keep track of how many items we stamped so we can clear leftover\n    // items from a previous render\n\n\n    const itemParts = this.value;\n    let partIndex = 0;\n    let itemPart;\n\n    for (const item of value) {\n      // Try to reuse an existing part\n      itemPart = itemParts[partIndex]; // If no existing part, create a new one\n\n      if (itemPart === undefined) {\n        itemPart = new NodePart(this.options);\n        itemParts.push(itemPart);\n\n        if (partIndex === 0) {\n          itemPart.appendIntoPart(this);\n        } else {\n          itemPart.insertAfterPart(itemParts[partIndex - 1]);\n        }\n      }\n\n      itemPart.setValue(item);\n      itemPart.commit();\n      partIndex++;\n    }\n\n    if (partIndex < itemParts.length) {\n      // Truncate the parts array so _value reflects the current state\n      itemParts.length = partIndex;\n      this.clear(itemPart && itemPart.endNode);\n    }\n  }\n\n  clear(startNode = this.startNode) {\n    removeNodes(this.startNode.parentNode, startNode.nextSibling, this.endNode);\n  }\n\n}\n/**\n * Implements a boolean attribute, roughly as defined in the HTML\n * specification.\n *\n * If the value is truthy, then the attribute is present with a value of\n * ''. If the value is falsey, the attribute is removed.\n */\n\nexport class BooleanAttributePart {\n  constructor(element, name, strings) {\n    this.value = undefined;\n    this._pendingValue = undefined;\n\n    if (strings.length !== 2 || strings[0] !== '' || strings[1] !== '') {\n      throw new Error('Boolean attributes can only contain a single expression');\n    }\n\n    this.element = element;\n    this.name = name;\n    this.strings = strings;\n  }\n\n  setValue(value) {\n    this._pendingValue = value;\n  }\n\n  commit() {\n    while (isDirective(this._pendingValue)) {\n      const directive = this._pendingValue;\n      this._pendingValue = noChange;\n      directive(this);\n    }\n\n    if (this._pendingValue === noChange) {\n      return;\n    }\n\n    const value = !!this._pendingValue;\n\n    if (this.value !== value) {\n      if (value) {\n        this.element.setAttribute(this.name, '');\n      } else {\n        this.element.removeAttribute(this.name);\n      }\n    }\n\n    this.value = value;\n    this._pendingValue = noChange;\n  }\n\n}\n/**\n * Sets attribute values for PropertyParts, so that the value is only set once\n * even if there are multiple parts for a property.\n *\n * If an expression controls the whole property value, then the value is simply\n * assigned to the property under control. If there are string literals or\n * multiple expressions, then the strings are expressions are interpolated into\n * a string first.\n */\n\nexport class PropertyCommitter extends AttributeCommitter {\n  constructor(element, name, strings) {\n    super(element, name, strings);\n    this.single = strings.length === 2 && strings[0] === '' && strings[1] === '';\n  }\n\n  _createPart() {\n    return new PropertyPart(this);\n  }\n\n  _getValue() {\n    if (this.single) {\n      return this.parts[0].value;\n    }\n\n    return super._getValue();\n  }\n\n  commit() {\n    if (this.dirty) {\n      this.dirty = false; // tslint:disable-next-line:no-any\n\n      this.element[this.name] = this._getValue();\n    }\n  }\n\n}\nexport class PropertyPart extends AttributePart {} // Detect event listener options support. If the `capture` property is read\n// from the options object, then options are supported. If not, then the thrid\n// argument to add/removeEventListener is interpreted as the boolean capture\n// value so we should only pass the `capture` property.\n\nlet eventOptionsSupported = false;\n\ntry {\n  const options = {\n    get capture() {\n      eventOptionsSupported = true;\n      return false;\n    }\n\n  }; // tslint:disable-next-line:no-any\n\n  window.addEventListener('test', options, options); // tslint:disable-next-line:no-any\n\n  window.removeEventListener('test', options, options);\n} catch (_e) {}\n\nexport class EventPart {\n  constructor(element, eventName, eventContext) {\n    this.value = undefined;\n    this._pendingValue = undefined;\n    this.element = element;\n    this.eventName = eventName;\n    this.eventContext = eventContext;\n\n    this._boundHandleEvent = e => this.handleEvent(e);\n  }\n\n  setValue(value) {\n    this._pendingValue = value;\n  }\n\n  commit() {\n    while (isDirective(this._pendingValue)) {\n      const directive = this._pendingValue;\n      this._pendingValue = noChange;\n      directive(this);\n    }\n\n    if (this._pendingValue === noChange) {\n      return;\n    }\n\n    const newListener = this._pendingValue;\n    const oldListener = this.value;\n    const shouldRemoveListener = newListener == null || oldListener != null && (newListener.capture !== oldListener.capture || newListener.once !== oldListener.once || newListener.passive !== oldListener.passive);\n    const shouldAddListener = newListener != null && (oldListener == null || shouldRemoveListener);\n\n    if (shouldRemoveListener) {\n      this.element.removeEventListener(this.eventName, this._boundHandleEvent, this._options);\n    }\n\n    if (shouldAddListener) {\n      this._options = getOptions(newListener);\n      this.element.addEventListener(this.eventName, this._boundHandleEvent, this._options);\n    }\n\n    this.value = newListener;\n    this._pendingValue = noChange;\n  }\n\n  handleEvent(event) {\n    if (typeof this.value === 'function') {\n      this.value.call(this.eventContext || this.element, event);\n    } else {\n      this.value.handleEvent(event);\n    }\n  }\n\n} // We copy options because of the inconsistent behavior of browsers when reading\n// the third argument of add/removeEventListener. IE11 doesn't support options\n// at all. Chrome 41 only reads `capture` if the argument is an object.\n\nconst getOptions = o => o && (eventOptionsSupported ? {\n  capture: o.capture,\n  passive: o.passive,\n  once: o.once\n} : o.capture);","/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\nimport { AttributeCommitter, BooleanAttributePart, EventPart, NodePart, PropertyCommitter } from './parts.js';\n/**\n * Creates Parts when a template is instantiated.\n */\n\nexport class DefaultTemplateProcessor {\n  /**\n   * Create parts for an attribute-position binding, given the event, attribute\n   * name, and string literals.\n   *\n   * @param element The element containing the binding\n   * @param name  The attribute name\n   * @param strings The string literals. There are always at least two strings,\n   *   event for fully-controlled bindings with a single expression.\n   */\n  handleAttributeExpressions(element, name, strings, options) {\n    const prefix = name[0];\n\n    if (prefix === '.') {\n      const comitter = new PropertyCommitter(element, name.slice(1), strings);\n      return comitter.parts;\n    }\n\n    if (prefix === '@') {\n      return [new EventPart(element, name.slice(1), options.eventContext)];\n    }\n\n    if (prefix === '?') {\n      return [new BooleanAttributePart(element, name.slice(1), strings)];\n    }\n\n    const comitter = new AttributeCommitter(element, name, strings);\n    return comitter.parts;\n  }\n  /**\n   * Create parts for a text-position binding.\n   * @param templateFactory\n   */\n\n\n  handleTextExpression(options) {\n    return new NodePart(options);\n  }\n\n}\nexport const defaultTemplateProcessor = new DefaultTemplateProcessor();","/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\nimport { marker, Template } from './template.js';\n/**\n * The default TemplateFactory which caches Templates keyed on\n * result.type and result.strings.\n */\n\nexport function templateFactory(result) {\n  let templateCache = templateCaches.get(result.type);\n\n  if (templateCache === undefined) {\n    templateCache = {\n      stringsArray: new WeakMap(),\n      keyString: new Map()\n    };\n    templateCaches.set(result.type, templateCache);\n  }\n\n  let template = templateCache.stringsArray.get(result.strings);\n\n  if (template !== undefined) {\n    return template;\n  } // If the TemplateStringsArray is new, generate a key from the strings\n  // This key is shared between all templates with identical content\n\n\n  const key = result.strings.join(marker); // Check if we already have a Template for this key\n\n  template = templateCache.keyString.get(key);\n\n  if (template === undefined) {\n    // If we have not seen this key before, create a new Template\n    template = new Template(result, result.getTemplateElement()); // Cache the Template for this key\n\n    templateCache.keyString.set(key, template);\n  } // Cache all future queries for this TemplateStringsArray\n\n\n  templateCache.stringsArray.set(result.strings, template);\n  return template;\n}\nexport const templateCaches = new Map();","/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n\n/**\n * @module lit-html\n */\nimport { removeNodes } from './dom.js';\nimport { NodePart } from './parts.js';\nimport { templateFactory } from './template-factory.js';\nexport const parts = new WeakMap();\n/**\n * Renders a template to a container.\n *\n * To update a container with new values, reevaluate the template literal and\n * call `render` with the new result.\n *\n * @param result a TemplateResult created by evaluating a template tag like\n *     `html` or `svg`.\n * @param container A DOM parent to render to. The entire contents are either\n *     replaced, or efficiently updated if the same result type was previous\n *     rendered there.\n * @param options RenderOptions for the entire render tree rendered to this\n *     container. Render options must *not* change between renders to the same\n *     container, as those changes will not effect previously rendered DOM.\n */\n\nexport const render = (result, container, options) => {\n  let part = parts.get(container);\n\n  if (part === undefined) {\n    removeNodes(container, container.firstChild);\n    parts.set(container, part = new NodePart(Object.assign({\n      templateFactory\n    }, options)));\n    part.appendInto(container);\n  }\n\n  part.setValue(result);\n  part.commit();\n};","/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n\n/**\n *\n * Main lit-html module.\n *\n * Main exports:\n *\n * -  [[html]]\n * -  [[svg]]\n * -  [[render]]\n *\n * @module lit-html\n * @preferred\n */\n\n/**\n * Do not remove this comment; it keeps typedoc from misplacing the module\n * docs.\n */\nimport { defaultTemplateProcessor } from './lib/default-template-processor.js';\nimport { SVGTemplateResult, TemplateResult } from './lib/template-result.js';\nexport { DefaultTemplateProcessor, defaultTemplateProcessor } from './lib/default-template-processor.js';\nexport { directive, isDirective } from \"./lib/directive.js\"; // TODO(justinfagnani): remove line when we get NodePart moving methods\n\nexport { removeNodes, reparentNodes } from './lib/dom.js';\nexport { noChange, nothing } from './lib/part.js';\nexport { AttributeCommitter, AttributePart, BooleanAttributePart, EventPart, isPrimitive, NodePart, PropertyCommitter, PropertyPart } from './lib/parts.js';\nexport { parts, render } from './lib/render.js';\nexport { templateCaches, templateFactory } from './lib/template-factory.js';\nexport { TemplateInstance } from './lib/template-instance.js';\nexport { SVGTemplateResult, TemplateResult } from './lib/template-result.js';\nexport { createMarker, isTemplatePartActive, Template } from \"./lib/template.js\"; // IMPORTANT: do not change the property name or the assignment expression.\n// This line will be used in regexes to search for lit-html usage.\n// TODO(justinfagnani): inject version number at build time\n\n(window['litHtmlVersions'] || (window['litHtmlVersions'] = [])).push('1.0.0');\n/**\n * Interprets a template literal as an HTML template that can efficiently\n * render to and update a container.\n */\n\nexport const html = (strings, ...values) => new TemplateResult(strings, values, 'html', defaultTemplateProcessor);\n/**\n * Interprets a template literal as an SVG template that can efficiently\n * render to and update a container.\n */\n\nexport const svg = (strings, ...values) => new SVGTemplateResult(strings, values, 'svg', defaultTemplateProcessor);","// https://gist.github.com/gokulkrishh/242e68d1ee94ad05f488\n// https://mediag.com/news/popular-screen-resolutions-designing-for-all/\n\nconst mediaQuery = {\n  HOVER: '(hover: hover)',\n  get isHover() {\n    return window.matchMedia(this.HOVER).matches;\n  },\n\n  PHONE: '(min-width: 320px) and (max-width: 480px)',\n  get isPhone() {\n    return window.matchMedia(this.PHONE).matches;\n  },\n\n  LAPTOP:\n    '(min-width: 1025px) and (max-width: 1280px) and (orientation: landscape)',\n  get isLaptop() {\n    return window.matchMedia(this.LAPTOP).matches;\n  },\n\n  DESKTOP: '(min-width: 1281px) and (orientation: landscape)',\n  get isDesktop() {\n    return window.matchMedia(this.DESKTOP).matches;\n  },\n\n  PHONE_LANDSCAPE:\n    '(min-width: 481px) and (max-width: 767px) and (orientation: landscape)',\n  // PHONE_LANDSCAPE: '(min-width: 481px) and (max-width: 767px)',\n  get isPhoneLandscape() {\n    return window.matchMedia(this.PHONE_LANDSCAPE).matches;\n  },\n\n  TABLET: '(min-width: 768px) and (max-width: 1024px)',\n  get isTablet() {\n    return window.matchMedia(this.Tablet).matches;\n  },\n\n  SMALL_PHONE:\n    '(min-width: 320px) and (max-width: 480px) and (max-height: 640px)',\n  get isSmallPhone() {\n    return window.matchMedia(this.SMALL_PHONE).matches;\n  },\n\n  WATCH: '(max-width: 319px)',\n  get isWatch() {\n    return window.matchMedia(this.WATCH).matches;\n  },\n\n  SHORT: '(min-width: 480px) and (max-height: 320px)',\n  get isShort() {\n    return window.matchMedia(this.SHORT).matches;\n  },\n\n  PWA: '(display-mode: standalone)',\n  // PWA: '(display-mode: browser)', // debugging\n  get isPWA() {\n    return window.matchMedia(this.PWA).matches;\n  },\n\n  MOTION_REDUCE: '(prefers-reduced-motion: reduce)',\n  get isMotionReduce() {\n    return window.matchMedia(this.MOTION_REDUCE).matches;\n  },\n};\n\nwindow.mediaQuery = mediaQuery;\nexport default mediaQuery;\n","import { html, render } from './js_modules/lit-html.js';\nimport mediaQuery from './lib/mediaquery.js';\n\ncustomElements.define(\n  'app-theme',\n  class extends HTMLElement {\n    constructor() {\n      super();\n      render(\n        html`\n          <style>\n            :root {\n              --safe-width: calc(\n                100% - env(safe-area-inset-left) - env(safe-area-inset-right)\n              );\n              --safe-height: calc(\n                100% - env(safe-area-inset-top) - env(safe-area-inset-bottom)\n              );\n\n              --scrollbar-track-color: rgba(0, 0, 0, 0.2);\n              --scrollbar-color: rgba(255, 255, 255, 0.2);\n\n              --theme-background-color: #20272b;\n              --theme-color: #18d150;\n              --theme-error-color: red;\n              --theme-backdrop-color: rgba(0, 0, 0, 0.6);\n\n              --drawer-width: 22rem;\n              --drawer-user-background-color: transparent;\n              --drawer-user-text-color: #fff;\n              --drawer-background-color: rgba(0, 0, 0, 0.25);\n              --drawer-text-primary-color: #fff;\n              --drawer-text-secondary-color: #707070;\n\n              --action-background-color: transparent;\n              --action-text-color: inherit;\n\n              --list-padding: 5.6rem;\n              --list-background-color: #263238;\n              --list-background-light-color: #34434a;\n              --list-hover-background-color: #0002;\n              --list-text-primary-color: #fff;\n              --list-text-secondary-color: #707070;\n\n              --notfound-text-primary-color: #fff;\n              --notfound-text-secondary-color: #707070;\n\n              --player-height: calc(9rem + env(safe-area-inset-bottom));\n              --player-background-color: #20272b;\n              --player-separator-color: black;\n              --player-text-primary-color: #fff;\n              --player-text-secondary-color: #707070;\n              --player-cover-box-shadow: 0px 1px 3px #0007;\n\n              --toast-background-color: #20272b;\n              --toast-text-color: #fff;\n              --toast-border-color: #000;\n\n              --menu-background-color: #20272b;\n              --menu-hover-background-color: #263238;\n              --menu-text-color: #c3c3c3;\n              --menu-hover-text-color: #fff;\n              --menu-box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);\n\n              --modal-margin: 2.4rem;\n              --modal-background-color: #fff;\n              --modal-text-primary-color: #000;\n              --modal-text-secondary-color: #707070;\n              --modal-box-shadow: 0px 9px 13px #0007;\n\n              --form-background-color: #fff;\n              --form-hover-background-color: #0001;\n              --form-text-primary-color: #000;\n              --form-text-secondary-color: #707070;\n              --form-text-disabled-color: #c3c3c3;\n            }\n            @media ${mediaQuery.PHONE_LANDSCAPE},\n              ${mediaQuery.PHONE},\n              ${mediaQuery.TABLET} {\n              :root {\n                --drawer-background-color: rgba(0, 0, 0, 0.75);\n\n                --list-padding: 1.6rem;\n              }\n            }\n            @media ${mediaQuery.PHONE} {\n              :root {\n                --drawer-width: 30.4rem;\n                --drawer-user-background-color: #20272b;\n                --drawer-user-text-color: #fff;\n                --drawer-background-color: #fff;\n                --drawer-text-primary-color: #fff;\n                --drawer-text-secondary-color: #000;\n\n                --action-background-color: #20272b;\n                --action-text-color: #fff;\n                --action-border-color: #eee;\n                --action-box-shadow: 0 -4px 4px 4px rgba(0, 0, 0, 0.4);\n\n                --list-padding: 0;\n                --list-background-color: #fff;\n                --list-background-light-color: #fff;\n                --list-hover-background-color: #fff;\n                --list-text-primary-color: #000;\n\n                --notfound-text-primary-color: #000;\n                --notfound-text-secondary-color: #c3c3c3;\n\n                --menu-background-color: #fff;\n                --menu-hover-background-color: #eee;\n                --menu-text-color: #000;\n                --menu-hover-text-color: #000;\n\n                --player-height: calc(5.6rem + env(safe-area-inset-bottom));\n              }\n            }\n            @media ${mediaQuery.WATCH}, ${mediaQuery.SHORT} {\n              :root {\n                --player-height: 100%;\n              }\n            }\n          </style>\n        `,\n        this,\n      );\n    }\n  },\n);\n","import { html, render } from '../js_modules/lit-html.js';\n\ncustomElements.define(\n  'app-icon',\n  class extends HTMLElement {\n    static observedAttributes = ['name'];\n\n    constructor() {\n      super();\n      this.attachShadow({ mode: 'open' });\n    }\n\n    connectedCallback() {\n      const name = this.getAttribute('name');\n      const template = document.querySelector(`#icon-${name}`);\n      render(\n        html`\n          <style>\n            :host {\n              position: relative;\n              width: 2.4rem;\n              height: 2.4rem;\n            }\n            :host(:not([hidden])) {\n              display: inline-block;\n            }\n          </style>\n          ${template.cloneNode(true).content}\n          <slot></slot>\n        `,\n        this.shadowRoot,\n      );\n    }\n\n    attributeChangedCallback(attributeName, newValue, oldValue) {\n      if (!this.isConnected || newValue === oldValue) return;\n      if (attributeName === 'name') {\n        this.connectedCallback();\n      }\n    }\n  },\n);\n","export const STORE_MODULE = Symbol('key: get store module');\nexport const STORE_MODULE_KEY = Symbol('key: get store module key');\n\nconst FUNC_MARK_KEY = Symbol('function mark');\nconst HANDLES_KEY = Symbol('handles key');\n\nexport const createStore = originStore => {\n  const handler = {\n    has(target, key) {\n      return key in target;\n    },\n    get(target, key) {\n      return target[key];\n    },\n    set(target, key, value) {\n      target[key] = value;\n      const listeners = target[key][HANDLES_KEY].get(key);\n      listeners.forEach(func => func[FUNC_MARK_KEY].has(key) && func(value));\n      return true;\n    },\n  };\n\n  const proxy = new Proxy(originStore, handler);\n  const keys = Object.keys(originStore);\n  keys.forEach(key => {\n    const storeModule = originStore[key];\n    storeModule[STORE_MODULE] = storeModule;\n    storeModule[STORE_MODULE_KEY] = key;\n    storeModule[HANDLES_KEY] = new Map([[key, new Set()]]);\n    proxy[key] = storeModule;\n  });\n\n  return proxy;\n};\n\nconst updaterSet = new Set();\nexport const updateStore = (storeModule, value) => {\n  if (!updaterSet.size) {\n    // delayed execution callback after updating store\n    queueMicrotask(() => {\n      updaterSet.forEach(func => func(value));\n      updaterSet.clear();\n    });\n  }\n  const storeKey = storeModule[STORE_MODULE_KEY];\n  Object.assign(storeModule[STORE_MODULE], value); // Equivalent set store[key]\n  const listeners = storeModule[HANDLES_KEY].get(storeKey);\n  listeners.forEach(func => {\n    if (func[FUNC_MARK_KEY].has(storeKey)) {\n      updaterSet.add(func);\n    }\n  });\n};\n\nexport const connect = (storeModule, func) => {\n  const storeKey = storeModule[STORE_MODULE_KEY];\n  const listeners = storeModule[HANDLES_KEY].get(storeKey);\n  if (!func[FUNC_MARK_KEY]) func[FUNC_MARK_KEY] = new Set();\n  func[FUNC_MARK_KEY].add(storeKey);\n  listeners.add(func);\n};\n\nexport const disconnect = (storeModule, func) => {\n  const storeKey = storeModule[STORE_MODULE_KEY];\n  const listeners = storeModule[HANDLES_KEY].get(storeKey);\n  listeners.delete(func);\n};\n","export default {\n  api: `${window.location.host}/api`,\n  storage: 'mt-music-storage.test.upcdn.net',\n};\n","import config from '../config/index.js';\n\nexport function throttle(fn, delay = 500) {\n  let timer = 0;\n  return (...rest) => {\n    clearTimeout(timer);\n    timer = setTimeout(fn.bind(null, ...rest), delay);\n  };\n}\n\nexport async function sleep(ms) {\n  return new Promise(resolve => setTimeout(resolve, ms));\n}\n\nexport async function getPinyin(汉字) {\n  const { default: pinyin } = await import('../js_modules/pinyin.js');\n  const py = pinyin(汉字, { style: pinyin.STYLE_INITIALS }).flat();\n  if (py.length < 2) return py.join('');\n  return py.map(str => str.substr(0, 1)).join('');\n}\n\nexport async function getAbbrPinyin(长名称, length = 2) {\n  return (await getPinyin(长名称)).substr(0, length).toUpperCase();\n}\n\nexport function getSrc(src) {\n  if (!src) return '';\n  if (String(src).match(/^(\\/\\/|https?:|blob:|data:)/)) {\n    return src;\n  }\n  return `http://${config.storage}/${src}`;\n}\n\nexport class Pool {\n  currentId = 0;\n  count = 0;\n  pool = new Map();\n\n  add(item) {\n    this.pool.set(this.count, item);\n    this.count += 1;\n  }\n\n  get() {\n    const item = this.pool.get(this.currentId);\n    if (item) {\n      this.pool.delete(this.currentId);\n      this.currentId += 1;\n    }\n    return item;\n  }\n}\n","import { connect, disconnect, STORE_MODULE_KEY } from './store.js';\nimport { html, render } from '../js_modules/lit-html.js';\nimport { mergeObject } from '../utils/object.js';\nimport { Pool } from '../utils/misc.js';\n\n// global component render task pool\nconst renderTaskPool = new Pool();\nconst exec = () =>\n  window.requestAnimationFrame(function callback(timestamp) {\n    const task = renderTaskPool.get();\n    if (task) {\n      task();\n      if (performance.now() - timestamp < 16) {\n        callback(timestamp);\n        return;\n      }\n    }\n    exec();\n  });\n\nexec();\n\nconst isMountedSymbol = Symbol('mounted');\nconst connectedStorePages = Symbol('connectedStorePages');\nexport default class Component extends HTMLElement {\n  static observedAttributes; // string[]\n  static observedPropertys; // string[]\n  static observedStores; // story[]\n\n  constructor() {\n    super();\n    this[connectedStorePages] = new Set();\n    this.state = {};\n    this.setState = this.setState.bind(this);\n    this.willMount = this.willMount.bind(this);\n    this.render = this.render.bind(this);\n    this.mounted = this.mounted.bind(this);\n    this.shouldUpdate = this.shouldUpdate.bind(this);\n    this.update = this.update.bind(this);\n    this.updated = this.updated.bind(this);\n    this.connectStores = this.connectStores.bind(this);\n    this.disconnectStores = this.disconnectStores.bind(this);\n    this.attributeChanged = this.attributeChanged.bind(this);\n    this.unmounted = this.unmounted.bind(this);\n\n    const { observedPropertys, observedStores } = this.constructor;\n    if (observedPropertys) {\n      observedPropertys.forEach(prop => {\n        let propValue;\n        Object.defineProperty(this, prop, {\n          get() {\n            return propValue;\n          },\n          set(v) {\n            if (v !== propValue) {\n              propValue = v;\n              this.update();\n            }\n          },\n        });\n      });\n    }\n    if (observedStores) {\n      observedStores.forEach(storeModule => {\n        if (!storeModule[STORE_MODULE_KEY]) {\n          throw new Error('`observedStores` only support store module');\n        }\n\n        connect(\n          storeModule,\n          this.update,\n        );\n        this[connectedStorePages].add(storeModule);\n      });\n    }\n    this.attachShadow({ mode: 'open' });\n  }\n\n  /**\n   * @readonly\n   * update component\n   * @param {object} payload Will be merged into the state object\n   */\n  setState(payload) {\n    this.state = mergeObject(this.state, payload);\n    this.update();\n  }\n\n  willMount() {}\n\n  render() {\n    return html``;\n  }\n\n  mounted() {}\n\n  shouldUpdate() {\n    return true;\n  }\n\n  /**\n   * @readonly\n   */\n  update() {\n    if (this.shouldUpdate()) {\n      render(this.render(), this.shadowRoot);\n      this.updated();\n    }\n  }\n\n  updated() {}\n\n  /**\n   * @readonly\n   */\n  connectStores(storeModuleList) {\n    storeModuleList.forEach(storeModule => {\n      connect(\n        storeModule,\n        this.update,\n      );\n      this[connectedStorePages].add(storeModule);\n    });\n  }\n\n  /**\n   * @readonly\n   */\n  disconnectStores(storeModuleList) {\n    storeModuleList.forEach(storeModule => {\n      disconnect(storeModule, this.update);\n    });\n  }\n\n  attributeChanged() {}\n  unmounted() {}\n\n  /**\n   * the following is the webcomponets API native method\n   */\n  /**\n   * @private\n   * use `willMount` or `mounted`\n   */\n  connectedCallback() {\n    this.willMount();\n    render(this.render(), this.shadowRoot);\n    this.mounted();\n    this[isMountedSymbol] = true;\n  }\n\n  /**\n   * @private\n   * use `attributeChanged`\n   */\n  attributeChangedCallback(...rest) {\n    if (this[isMountedSymbol]) {\n      this.attributeChanged(...rest);\n      this.update();\n    }\n  }\n\n  // adoptedCallback() {}\n\n  /**\n   * @private\n   * use `unmounted`\n   */\n  disconnectedCallback() {\n    this[connectedStorePages].forEach(storeModule => {\n      disconnect(storeModule, this.update);\n    });\n    this.unmounted();\n    this[isMountedSymbol] = false;\n  }\n}\n\nexport class SingleInstanceComponent extends Component {\n  /**\n   * @type {SingleInstanceComponent}\n   */\n  static instance;\n\n  constructor() {\n    super();\n    if (this.constructor.instance) {\n      throw new Error('multiple instances are not allowed');\n    } else {\n      this.constructor.instance = this;\n    }\n  }\n}\n\nexport class AsyncComponent extends Component {\n  /**\n   * @readonly\n   */\n  update() {\n    renderTaskPool.add(() => {\n      if (this.shouldUpdate()) {\n        render(this.render(), this.shadowRoot);\n        this.updated();\n      }\n    });\n  }\n\n  /**\n   * async render\n   * @private\n   * use `willMount` or `mounted`\n   */\n  connectedCallback() {\n    this.willMount();\n    renderTaskPool.add(() => {\n      render(this.render(), this.shadowRoot);\n      this.mounted();\n      this[isMountedSymbol] = true;\n    });\n  }\n}\n","export function mergeObject(obj1, obj2, newObject) {\n  const wrap = newObject || obj1;\n  const keys = new Set(Object.keys(obj1).concat(Object.keys(obj2)));\n  keys.forEach(key => {\n    if (!(key in obj1)) {\n      wrap[key] = obj2[key];\n    } else if (!(key in obj2)) {\n      wrap[key] = obj1[key];\n    } else if (obj2[key] && obj2[key].constructor === Object) {\n      wrap[key] = mergeObject(obj1[key], obj2[key]);\n    } else {\n      wrap[key] = obj2[key];\n    }\n  });\n\n  return wrap;\n}\n\nexport function isEqual(obj, obj2, option = {}) {\n  if (!obj || !obj2) {\n    return obj === obj2;\n  }\n  const ignores = option.ignores || [];\n  const keys = [...new Set(Object.keys(obj).concat(Object.keys(obj2)))];\n\n  for (let i = 0; i < keys.length; i += 1) {\n    const key = keys[i];\n    if (!ignores.includes(key)) {\n      if (obj[key] && typeof obj[key] === 'object') {\n        if (!isEqual(obj[key], obj2[key], option)) {\n          return false;\n        }\n      } else if (obj[key] !== obj2[key]) {\n        return false;\n      }\n    }\n  }\n  return true;\n}\n","const cache = {\n  localStorage: {},\n  sessionStorage: {},\n};\n\nexport default {\n  get(key, type) {\n    if (cache[type][key]) return cache[type][key];\n\n    let value = window[type].getItem(key);\n\n    if (!value) return undefined;\n    try {\n      value = JSON.parse(value);\n    } catch (e) {\n      localStorage.removeItem(key);\n      value = undefined;\n    }\n    return value;\n  },\n  getLocal(key) {\n    return this.get(key, 'localStorage');\n  },\n  getSession(key) {\n    return this.get(key, 'sessionStorage');\n  },\n  set(key, value, type) {\n    delete cache[type][key];\n    return window[type].setItem(key, JSON.stringify(value));\n  },\n  setLocal(key, value) {\n    return this.set(key, value, 'localStorage');\n  },\n  setSession(key, value) {\n    return this.set(key, value, 'sessionStorage');\n  },\n};\n","import { createStore, updateStore } from './store.js';\nimport storage from '../utils/storage.js';\n\n/**\n * toString method contains \"?\"\n */\nexport class QueryString extends URLSearchParams {\n  constructor(param) {\n    if (param instanceof QueryString) {\n      return param;\n    }\n    if (typeof param === 'string') {\n      super(param);\n    } else {\n      super();\n      Object.keys(param).forEach(key => {\n        this.append(key, param[key]);\n      });\n    }\n  }\n\n  concat(param) {\n    let query;\n    if (typeof param === 'string') {\n      query = new URLSearchParams(param);\n    } else {\n      query = param;\n    }\n    Object.keys(query).forEach(key => {\n      this.append(key, query[key]);\n    });\n  }\n\n  toString() {\n    const string = super.toString();\n    return string ? `?${string}` : '';\n  }\n\n  toJSON() {\n    return this.toString();\n  }\n}\n\nconst colseHandleMap = new WeakMap();\nfunction generateState(data, close) {\n  if (data.$key) throw new Error('`$key` is not allowed');\n  if (data.$close) throw new Error('`$close` is not allowed');\n\n  const state = {\n    ...data,\n    $key: Date.now() + performance.now(),\n    $close: !!close,\n  };\n  colseHandleMap.set(state, close);\n  return state;\n}\n\n/**\n * @typedef {Object} HistoryItemState\n * @property {boolean} $close\n * @property {number} $key\n */\n\n/**\n * @typedef {Object} HistoryItem\n * @property {String} path window.location.pathname\n * @property {String|QueryString} query window.location.search\n * @property {String} title  window.document.title\n * @property {HistoryItemState} state window.history.state\n */\n\n/**\n * @typedef {Object} NavigationParameter\n * @property {String} path\n * @property {String|QueryString} query\n * @property {String} title\n * @property {function} close\n * @property {object} data\n */\n\nconst initStore = {\n  historyState: {\n    /**\n     * @type {HistoryItem[]}\n     */\n    list: [],\n    currentIndex: -1,\n  },\n};\n\n/**\n * @type {typeof initStore}\n */\nconst store = createStore(initStore);\n\nconst history = {\n  historyState: store.historyState,\n  basePath: '',\n\n  get location() {\n    const { list, currentIndex } = store.historyState;\n    const location = list[currentIndex];\n    // if (!location) return {};\n    const query = new QueryString(location.query);\n    return {\n      path: location.path,\n      query,\n      state: location.state,\n      title: location.title,\n      href: location.path + query,\n    };\n  },\n\n  forward() {\n    window.history.forward();\n  },\n\n  back() {\n    window.history.back();\n  },\n\n  /**\n   * push history item\n   * @param {NavigationParameter} options\n   */\n  push(options) {\n    const { path, close } = options;\n    const query = options.query || '';\n    const title = options.title || '';\n    const data = options.data || {};\n\n    const state = generateState(data, close);\n\n    window.history.pushState(\n      state,\n      title,\n      history.basePath + path + new QueryString(query),\n    );\n\n    const { list, currentIndex } = store.historyState;\n    const newList = list.slice(0, currentIndex + 1).concat({\n      state,\n      title,\n      path,\n      query,\n    });\n    updateStore(store.historyState, {\n      list: newList,\n      currentIndex: newList.length - 1,\n    });\n  },\n  pushState(options) {\n    const { path, query } = history.location;\n    history.push({\n      path,\n      query,\n      ...options,\n    });\n  },\n\n  /**\n   * push history item\n   * @param {NavigationParameter} options\n   */\n  replace(options) {\n    const { path, close } = options;\n    const query = options.query || '';\n    const data = options.data || {};\n    const title = options.title || '';\n\n    const state = generateState(data, close);\n\n    window.history.replaceState(\n      state,\n      title,\n      history.basePath + path + new QueryString(query),\n    );\n\n    const { list, currentIndex } = store.historyState;\n    list.splice(currentIndex, 1, {\n      state,\n      title,\n      path,\n      query,\n    });\n    updateStore(store.historyState, {\n      list,\n    });\n  },\n  replaceState(options) {\n    const { path, query } = history.location;\n    history.replace({\n      path,\n      query,\n      ...options,\n    });\n  },\n};\n\nif (!window.history.state) {\n  // first time use app\n  const { pathname, search } = window.location;\n  history.push({ path: pathname, query: search });\n} else if (window.history.state.$close) {\n  // reload on page with modal window\n  history.back();\n}\nupdateStore(store.historyState, storage.getSession('historyState'));\n\nwindow.addEventListener('unload', () => {\n  storage.setSession('historyState', store.historyState);\n});\n\nwindow.addEventListener('popstate', event => {\n  // forward or back\n  // none replace\n\n  // prev data\n  const { list, currentIndex } = store.historyState;\n\n  if (event.state === null) {\n    const { state, title, path, query } = list[0];\n    window.history.pushState(\n      state,\n      title,\n      history.basePath + path + new QueryString(query),\n    );\n    return;\n  }\n\n  const { state } = list[currentIndex];\n  const newStateIndex = list.findIndex(\n    historyItem => historyItem.state.$key === event.state.$key,\n  );\n\n  if (state.$close) {\n    const closeHandle = colseHandleMap.get(state);\n    if (closeHandle) {\n      // reason: back button close modal\n      closeHandle();\n    } else {\n      // reason: reload modal\n    }\n  }\n\n  updateStore(store.historyState, {\n    currentIndex: newStateIndex,\n  });\n});\n\nexport default history;\n\n// eslint-disable-next-line\nwindow._history = history;\n","export const userData = {\n  name: '',\n  avatar: '',\n  key: '',\n};\nexport const playerState = {\n  pip: null, // pip 图片\n  maximize: false,\n  errorList: [],\n  currentSong: null,\n  state: 'paused', // playing, paused, loading, error\n  volume: 0.1,\n  muted: false,\n  shuffle: false,\n  mode: 'repeat',\n};\nexport const audioState = {\n  currentTime: 0,\n  duration: 180,\n};\nexport const toastState = {\n  type: 'info',\n  text: null,\n};\nexport const selectorState = {\n  type: '',\n  list: [],\n};\nexport const uploaderState = {\n  // {file}\n  list: [],\n  errorList: [],\n};\n","// Non-persistent storage\n// InitData may be needed for updates\n// May modify the history stack\n\nexport const modalState = {\n  isOpen: false,\n  title: '',\n  complete: 'ok',\n  cancel: 'cancel',\n  template: '',\n  onclose: null,\n  oncomplete: null,\n  oncancel: null,\n};\nexport const confirmState = {\n  isOpen: false,\n  title: '',\n  complete: 'confirm',\n  cancel: 'cancel',\n  text: '',\n  oncomplete: null,\n  oncancel: null,\n};\nexport const menuState = {\n  isOpen: false,\n  type: '',\n  target: null,\n  stage: document.body,\n  // {text, handle}\n  list: [],\n  onclose: null,\n};\nexport const drawerState = {\n  isOpen: false,\n};\n","// list only save `id`\n\nexport const songData = {\n  list: [],\n};\nexport const searchData = {\n  text: '',\n  list: [],\n};\nexport const favoriteData = {\n  list: [],\n};\n\nexport const artistData = {\n  list: [],\n};\n\nexport const albumData = {\n  list: [],\n};\n\nexport const playlistData = {\n  list: [],\n};\n","import { createStore } from '../lib/store.js';\nimport * as appState from './appstate.js';\nimport * as windowState from './window.js';\nimport * as data from './data.js';\n\nexport * from '../lib/store.js';\n\nexport const store = createStore({\n  ...appState,\n  ...windowState,\n  ...data,\n});\n\n// eslint-disable-next-line\nwindow._store = store;\n","import { store } from '../models/index.js';\nimport config from '../config/index.js';\n\nexport default async function request(path, options = {}) {\n  if (store.userData.key) {\n    options.headers = {\n      ...options.headers,\n      'x-user': store.userData.key,\n    };\n  }\n  if (\n    options.body &&\n    !(options.body instanceof FormData) &&\n    typeof options.body === 'object'\n  ) {\n    options.body = JSON.stringify(options.body);\n    options.headers = {\n      ...options.headers,\n      'content-type': 'application/json',\n    };\n  }\n  const res = await fetch(`//${config.api}${path}`, options);\n  const data = await res.json();\n  return data;\n}\n","class DataMap extends Map {\n  get(id) {\n    return super.get(id) || {};\n  }\n\n  setList(list = []) {\n    list.forEach(data => {\n      this.set(data.id, data);\n    });\n  }\n}\n\nexport const songMap = new DataMap();\n// Map <id: { ...info, list: songId[] }>\nexport const playlistMap = new DataMap();\n\n// Currently these data are front-end generated\n// export const artistMap = new DataMap();\n// export const albumMap = new DataMap();\n","import request from '../lib/request.js';\nimport { store, updateStore } from '../models/index.js';\nimport history, { QueryString } from '../lib/history.js';\nimport { songMap } from '../models/data-map.js';\n\nexport const get = async () => {\n  const list = await request('/songs');\n  updateStore(store.songData, {\n    list: list.map(data => {\n      songMap.set(data.id, data);\n      return data.id;\n    }),\n  });\n\n  return list;\n};\n\nexport const getFavorite = async () => {\n  await get();\n  const list = [];\n  songMap.forEach(({ star, id }) => {\n    if (star) list.push(id);\n  });\n  updateStore(store.favoriteData, { list });\n  return list;\n};\n\nexport const upload = files => {\n  const fileArr = Array.from(files);\n  updateStore(store.uploaderState, {\n    list: store.uploaderState.list.concat(fileArr.map(file => ({ file }))),\n    errorList: [],\n  });\n\n  fileArr.forEach(async file => {\n    const formData = new FormData();\n    formData.append('file', file);\n\n    let error;\n    let data;\n    try {\n      data = await request('/songs', { method: 'post', body: formData });\n    } catch (e) {\n      error = true;\n    }\n\n    const { list, errorList } = store.uploaderState;\n    const uploadedIndex = list.findIndex(({ file: f }) => file === f);\n    const uploadedItem = list.splice(uploadedIndex, 1);\n    if (error) {\n      updateStore(store.uploaderState, {\n        list,\n        errorList: errorList.concat(uploadedItem),\n      });\n    } else {\n      updateStore(store.uploaderState, { list });\n      songMap.set(data.id, data);\n      updateStore(store.songData, {\n        list: [data.id].concat(store.songData.list),\n      });\n    }\n  });\n};\n\nexport const del = async id => {\n  const { list } = store.songData;\n  await request(`/songs/${id}`, { method: 'delete' });\n  const deletedIndex = list.findIndex(songId => songId === id);\n  list.splice(deletedIndex, 1);\n  updateStore(store.songData, { list });\n};\n\nexport const update = async (id, song) => {\n  const { currentSong } = store.playerState;\n  const data = await request(`/songs/${id}`, { method: 'put', body: song });\n  Object.assign(songMap.get(id), data, {\n    picture: data.picture || undefined,\n  });\n  updateStore(store.songData, {});\n  if (currentSong === id) {\n    updateStore(store.playerState, {});\n  }\n  if ('star' in song) {\n    updateStore(store.favoriteData, { list: await getFavorite() });\n  }\n};\n\nexport const search = async text => {\n  const list = await request(\n    `/search${new QueryString({ q: text, type: 'song' })}`,\n  );\n  updateStore(store.searchData, {\n    list: list.map(data => {\n      songMap.set(data.id, data);\n      return data.id;\n    }),\n    text,\n  });\n  history.replace({\n    path: history.location.path,\n    query: new QueryString({ q: text }),\n  });\n};\n","import { html } from '../../js_modules/lit-html.js';\nimport { SingleInstanceComponent } from '../../lib/component.js';\nimport { store } from '../../models/index.js';\nimport { upload } from '../../services/song.js';\n\nexport default class AppUpload extends SingleInstanceComponent {\n  static open() {\n    const input = AppUpload.instance.shadowRoot.querySelector('input');\n    input.click();\n  }\n\n  static observedStores = [store.playerState];\n\n  changeHandle = () => {\n    const input = this.shadowRoot.querySelector('input');\n    upload(input.files);\n    input.value = '';\n  };\n\n  render() {\n    return html`\n      <style>\n        :host {\n          display: none;\n        }\n      </style>\n      <input\n        @change=\"${this.changeHandle}\"\n        type=\"file\"\n        multiple\n        accept=\"audio/*\"\n      />\n    `;\n  }\n}\n\ncustomElements.define('app-upload', AppUpload);\n","import request from '../lib/request.js';\nimport { store, updateStore } from '../models/index.js';\nimport { songMap, playlistMap } from '../models/data-map.js';\n\nexport const get = async () => {\n  const list = await request('/playlist');\n  updateStore(store.playlistData, {\n    list: list.map(data => {\n      playlistMap.set(data.id, data);\n      return data.id;\n    }),\n  });\n\n  return list;\n};\n\nexport const getSong = async id => {\n  const playlistData = await request(`/playlist/${id}/songs`);\n  playlistData.list = playlistData.songs.map(data => {\n    songMap.set(data.id, data);\n    return data.id;\n  });\n  delete playlistData.songs;\n  playlistMap.set(id, playlistData);\n  updateStore(store.playlistData, {});\n};\n\nexport const addSong = async (id, songId) => {\n  const { list = [] } = playlistMap.get(id);\n  await request(`/playlist/${id}/songs/${songId}`, { method: 'post' });\n  list.unshift(songId);\n  updateStore(store.playlistData, {});\n};\n\nexport const removeSong = async (id, songId) => {\n  const { list = [] } = playlistMap.get(id);\n  await request(`/playlist/${id}/songs/${songId}`, { method: 'delete' });\n  const songIndex = list.findIndex(sId => songId === sId);\n  list.splice(songIndex, 1);\n  updateStore(store.playlistData, {});\n};\n\nexport const create = async body => {\n  const { list } = store.playlistData;\n  const data = await request('/playlist', { method: 'post', body });\n  playlistMap.set(data.id, data);\n  updateStore(store.playlistData, {\n    list: [data.id].concat(list),\n  });\n\n  return data;\n};\n","import { html } from '../../js_modules/lit-html.js';\nimport Component from '../../lib/component.js';\nimport { store } from '../../models/index.js';\nimport mediaQuery from '../../lib/mediaquery.js';\n\ncustomElements.define(\n  'modal-body',\n  class extends Component {\n    static observedStores = [store.modalState];\n\n    render() {\n      const { template } = store.modalState;\n      return html`\n        <style>\n          @media ${mediaQuery.PHONE} {\n            :host::-webkit-scrollbar {\n              width: 0;\n            }\n            :host {\n              scrollbar-width: none;\n            }\n          }\n        </style>\n        ${template}\n      `;\n    }\n  },\n);\n","import { html } from '../../js_modules/lit-html.js';\nimport { SingleInstanceComponent } from '../../lib/component.js';\nimport history from '../../lib/history.js';\nimport { store, updateStore } from '../../models/index.js';\nimport mediaQuery from '../../lib/mediaquery.js';\n\nimport './body.js';\n\nconst InitData = Object.assign({}, store.modalState);\n\nexport default class Modal extends SingleInstanceComponent {\n  static open(state) {\n    updateStore(store.modalState, {\n      ...InitData,\n      ...state,\n      isOpen: true,\n    });\n    history.pushState({\n      close: Modal.close,\n    });\n  }\n\n  static close() {\n    updateStore(store.modalState, { isOpen: false });\n  }\n\n  static observedStores = [store.modalState];\n\n  okHandle = async () => {\n    const { oncomplete } = store.modalState;\n    try {\n      if (oncomplete) await oncomplete();\n      Modal.close();\n      history.back();\n    } catch (err) {\n      //\n    }\n  };\n\n  cancelHandle = () => {\n    const { oncancel } = store.modalState;\n    if (oncancel) oncancel();\n    Modal.close();\n    history.back();\n  };\n\n  closeHandle = () => {\n    const { onclose } = store.modalState;\n    if (onclose) onclose();\n    history.back();\n  };\n\n  render() {\n    const { title, complete, cancel } = store.modalState;\n\n    return html`\n      <style>\n        :host {\n          z-index: 8;\n          position: fixed;\n          top: 0;\n          left: 0;\n          display: flex;\n          justify-content: center;\n          align-items: center;\n          width: 100%;\n          height: 100%;\n          opacity: 0;\n          pointer-events: none;\n          transform: translateY(30%);\n        }\n        :host(.open) {\n          opacity: 1;\n          pointer-events: auto;\n          transform: translateY(0);\n        }\n        .backdrop {\n          position: absolute;\n          top: 0;\n          left: 0;\n          width: 100%;\n          height: 100%;\n        }\n        .modal {\n          flex-shrink: 1;\n          position: absolute;\n          width: 45rem;\n          padding: var(--modal-margin);\n          border-radius: 2px;\n          background: var(--modal-background-color);\n          color: var(--modal-text-primary-color);\n          fill: var(--modal-text-primary-color);\n          box-shadow: var(--modal-box-shadow);\n          overflow: auto;\n        }\n        .titlebar {\n          display: flex;\n          align-items: center;\n          flex-shrink: 0;\n        }\n        .complete {\n          display: none;\n        }\n        .title {\n          flex-grow: 1;\n          margin: 0;\n          padding: 0;\n          font-size: 2rem;\n          font-weight: 500;\n          text-transform: capitalize;\n        }\n        .close {\n          color: var(--modal-text-secondary-color);\n          fill: var(--modal-text-secondary-color);\n        }\n        modal-body {\n          display: block;\n          padding: 2.4rem 0;\n        }\n        .footer {\n          display: flex;\n          justify-content: flex-end;\n          flex-shrink: 0;\n        }\n        .footer form-button:not(:last-of-type) {\n          margin-right: 0.8rem;\n        }\n        @media ${mediaQuery.PHONE} {\n          :host {\n            transition-duration: 0.2s;\n            transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n          }\n          .backdrop {\n            background: var(--theme-backdrop-color);\n          }\n          .modal {\n            display: flex;\n            flex-direction: column;\n            height: 100%;\n            width: 100%;\n            padding: 0;\n            border-radius: 0;\n          }\n          .titlebar {\n            border-bottom: 1px solid var(--action-border-color);\n            padding-top: env(safe-area-inset-top);\n          }\n          .title {\n            padding-left: 1.6rem;\n          }\n          .close {\n            padding: 1.6rem;\n            color: inherit;\n            fill: inherit;\n          }\n          modal-body {\n            flex-grow: 1;\n            padding: 1.6rem;\n            overflow: auto;\n          }\n          .footer {\n            padding: 0.8rem 1.6rem;\n          }\n        }\n        @media ${mediaQuery.PHONE} and ${mediaQuery.PWA} {\n          .titlebar {\n            z-index: 4;\n            position: -webkit-sticky;\n            position: sticky;\n            top: 0;\n            flex-direction: row-reverse;\n            border-bottom: none;\n            background: var(--action-background-color);\n            color: var(--action-text-color);\n            fill: var(--action-text-color);\n            box-shadow: var(--action-box-shadow);\n          }\n          .complete {\n            display: block;\n            padding: 1.6rem;\n            font-size: 1.4rem;\n            font-weight: 500;\n            text-transform: uppercase;\n          }\n          .footer {\n            display: none;\n          }\n        }\n      </style>\n      <div class=\"backdrop\"></div>\n      <div class=\"modal\">\n        <div class=\"titlebar\">\n          <div\n            class=\"complete\"\n            @click=\"${this.okHandle}\"\n            ?hidden=\"${!complete}\"\n          >\n            ${complete}\n          </div>\n          <h1 class=\"title\">${title}</h1>\n          <app-icon name=\"clear\" class=\"close\" @click=\"${this.closeHandle}\">\n            <app-ripple circle color=\"rgba(0,0,0,0.54)\"></app-ripple>\n          </app-icon>\n        </div>\n        <modal-body></modal-body>\n        <div class=\"footer\">\n          <form-button\n            @click=\"${this.cancelHandle}\"\n            ?hidden=\"${!cancel}\"\n            type=\"secondary\"\n          >\n            ${cancel}\n          </form-button>\n          <form-button @click=\"${this.okHandle}\" ?hidden=\"${!complete}\">\n            ${complete}\n          </form-button>\n        </div>\n      </div>\n    `;\n  }\n\n  mounted() {\n    this.hidden = false;\n  }\n\n  updated() {\n    const { isOpen } = store.modalState;\n    if (isOpen) {\n      this.classList.add('open');\n    } else {\n      this.classList.remove('open');\n    }\n  }\n}\n\ncustomElements.define('app-modal', Modal);\n","import { html, render } from '../../js_modules/lit-html.js';\nimport { create } from '../../services/playlist.js';\n\nexport default function getAddPlaylistModal() {\n  const form = document.createElement('app-form');\n  render(\n    html`\n      <form-text\n        label=\"title\"\n        name=\"title\"\n        required\n        pattern=\".*\\\\S.*\"\n      ></form-text>\n    `,\n    form,\n  );\n  const oncomplete = async () => {\n    if (!form.valid()) throw new Error('Failed validation');\n    create(form.value);\n  };\n  return {\n    title: 'add playlist',\n    complete: 'save',\n    cancel: 'cancel',\n    template: form,\n    oncomplete,\n  };\n}\n","export default {\n  HOME: {\n    path: '/',\n    title: 'MT Music Player',\n  },\n  SONGS: {\n    path: '/songs',\n    title: 'songs',\n    getSubPageTitle: (subPage, title) => `${subPage} - ${title}`,\n  },\n  PLAYLIST: {\n    path: '/playlist',\n    title: 'playlist',\n  },\n  FAVORITES: {\n    path: '/favorites',\n    title: 'favorites',\n  },\n  SEARCH: {\n    path: '/search',\n    title: 'search',\n  },\n  ALBUMS: {\n    path: '/albums',\n    title: 'albums',\n    subTitle: 'album',\n  },\n  ARTISTS: {\n    path: '/artists',\n    title: 'artists',\n    subTitle: 'artist',\n  },\n  PLAYLISTS: {\n    path: '/playlists',\n    title: 'playlists',\n    getSubPageTitle: title => `playlist - ${title}`,\n  },\n  404: {\n    title: 'not found',\n  },\n};\n","import { html } from '../../js_modules/lit-html.js';\nimport { SingleInstanceComponent } from '../../lib/component.js';\nimport history from '../../lib/history.js';\nimport { store, updateStore } from '../../models/index.js';\nimport mediaQuery from '../../lib/mediaquery.js';\nimport { get } from '../../services/playlist.js';\nimport Modal from '../modal/index.js';\nimport getAddPlaylistModal from '../modals/add-playlist.js';\nimport routeMap from '../router/map.js';\nimport { playlistMap } from '../../models/data-map.js';\n\nconst menus = [\n  // {\n  //   path: '/',\n  //   icon: 'queue-music',\n  //   text: 'play queue',\n  // },\n  {\n    path: routeMap.ALBUMS.path,\n    icon: 'album',\n    text: routeMap.ALBUMS.title,\n  },\n  {\n    path: routeMap.ARTISTS.path,\n    icon: 'person',\n    text: routeMap.ARTISTS.title,\n  },\n  {\n    path: routeMap.SONGS.path,\n    icon: 'music-note',\n    text: routeMap.SONGS.title,\n  },\n  {\n    path: routeMap.FAVORITES.path,\n    icon: 'star',\n    text: routeMap.FAVORITES.title,\n  },\n  {\n    path: routeMap.PLAYLISTS.path,\n    icon: 'playlist-play',\n    text: routeMap.PLAYLISTS.title,\n  },\n];\n\nexport default class Drawer extends SingleInstanceComponent {\n  static open() {\n    updateStore(store.drawerState, {\n      isOpen: true,\n    });\n    history.pushState({ close: Drawer.close });\n  }\n\n  static close() {\n    updateStore(store.drawerState, { isOpen: false });\n  }\n\n  static closeHandle() {\n    Drawer.close();\n    history.back();\n  }\n\n  static renderItem({ path, icon, text }) {\n    return html`\n      <li>\n        <app-link path=\"${path}\" title=\"${text}\">\n          <app-icon name=\"${icon}\"></app-icon>\n          <span>${text}</span>\n          <app-ripple type=\"${mediaQuery.isPhone ? 'touch' : ''}\"></app-ripple>\n        </app-link>\n      </li>\n    `;\n  }\n\n  static renderPlaylist(id) {\n    const { title } = playlistMap.get(id);\n    return html`\n      <li>\n        <app-link\n          path=\"${routeMap.PLAYLIST.path}\"\n          query=\"?id=${id}\"\n          title=\"${title}\"\n        >\n          <span>${title || '<empty name>'}</span>\n          <app-ripple type=\"${mediaQuery.isPhone ? 'touch' : ''}\"></app-ripple>\n        </app-link>\n      </li>\n    `;\n  }\n\n  static addPlaylistHandle() {\n    Modal.open(getAddPlaylistModal());\n  }\n\n  static observedStores = [\n    store.drawerState,\n    store.userData,\n    store.playlistData,\n  ];\n\n  render() {\n    const { name, avatar } = store.userData;\n    const { list } = store.playlistData;\n\n    return html`\n      <style>\n        :host {\n          position: fixed;\n          top: 0;\n          left: 0;\n          width: var(--drawer-width);\n          height: calc(100% - var(--player-height));\n          font-size: 1.4rem;\n          background: var(--drawer-background-color);\n          overflow: auto;\n          scrollbar-width: thin;\n          scrollbar-color: var(--scrollbar-color) var(--scrollbar-track-color);\n        }\n        .menu {\n          box-sizing: border-box;\n          height: 100%;\n          padding-bottom: env(safe-area-inset-bottom);\n        }\n        .user {\n          position: relative;\n          display: flex;\n          align-items: center;\n          padding: calc(4.8rem + env(safe-area-inset-top)) 2.4rem 2.4rem;\n          background: var(--drawer-user-background-color);\n          color: var(--drawer-user-text-color);\n        }\n        .avatar {\n          margin: 0 1.6rem 0 0;\n          border-radius: 100%;\n          width: 3.2rem;\n        }\n        ol {\n          margin: 0;\n          padding: 0;\n          margin-bottom: 3.2rem;\n          list-style: none;\n          color: var(--drawer-text-secondary-color);\n          fill: var(--drawer-text-secondary-color);\n        }\n        .default {\n          font-weight: 700;\n        }\n        .default app-icon {\n          display: none;\n        }\n        .playlist {\n          display: none;\n        }\n        li {\n          position: relative;\n          display: flex;\n          align-items: center;\n          padding: 1.6rem 2.4rem;\n          text-transform: capitalize;\n        }\n        li app-icon {\n          margin-right: 1.6rem;\n        }\n        [active] {\n          color: var(--theme-color);\n          fill: var(--theme-color);\n        }\n        @media ${mediaQuery.HOVER} {\n          app-link:hover:not([active]) {\n            color: var(--drawer-text-primary-color);\n          }\n          li {\n            cursor: pointer;\n          }\n        }\n        @media ${mediaQuery.DESKTOP} {\n          .playlist {\n            display: block;\n          }\n        }\n        @media ${mediaQuery.PHONE_LANDSCAPE},\n          ${mediaQuery.PHONE},\n          ${mediaQuery.TABLET} {\n          :host {\n            z-index: 9;\n            left: -100%;\n            right: 100%;\n            width: 100%;\n            height: 100%;\n            transition-property: left;\n            transition-delay: 0.2s;\n            background: none;\n            overflow: hidden;\n          }\n          .backdrop {\n            position: absolute;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            opacity: 0;\n            background: var(--theme-backdrop-color);\n          }\n          .menu {\n            position: relative;\n            width: var(--drawer-width);\n            transform: translateX(-100%);\n            background: var(--drawer-background-color);\n            overflow: auto;\n          }\n          .menu::-webkit-scrollbar {\n            width: 0;\n          }\n          .menu {\n            scrollbar-width: none;\n          }\n          .menu,\n          .backdrop {\n            transition-duration: 0.2s;\n            transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n            pointer-events: none;\n          }\n          .user {\n            flex-direction: column;\n            align-items: flex-start;\n            margin-bottom: 1.6rem;\n          }\n          .avatar {\n            margin: 0 0 1.6rem 0;\n          }\n          .default {\n            font-weight: normal;\n          }\n          .default app-icon {\n            display: block;\n          }\n          :host(.open) {\n            left: 0;\n            transition: none;\n          }\n          :host(.open) .menu {\n            transform: translateX(0);\n          }\n          :host(.open) .backdrop {\n            opacity: 1;\n          }\n          :host(.open) .menu,\n          :host(.open) .backdrop {\n            pointer-events: auto;\n          }\n        }\n      </style>\n      <div class=\"backdrop\" @click=\"${Drawer.closeHandle}\"></div>\n      <div class=\"menu\">\n        <div class=\"user\">\n          <app-img\n            class=\"avatar\"\n            data-alt=\"avatar\"\n            data-src=\"${avatar}\"\n          ></app-img>\n          <div>${name || 'Login'}</div>\n        </div>\n        <ol class=\"default\">\n          ${menus.map(Drawer.renderItem)}\n        </ol>\n        ${mediaQuery.isDesktop\n          ? html`\n              <ol class=\"playlist\">\n                ${list.map(Drawer.renderPlaylist)}\n              </ol>\n              <ol class=\"playlist\">\n                <li @click=\"${Drawer.addPlaylistHandle}\">\n                  <app-icon name=\"playlist-add\"></app-icon>\n                  <span>add playlisy</span>\n                  <app-ripple></app-ripple>\n                </li>\n              </ol>\n            `\n          : ''}\n      </div>\n    `;\n  }\n\n  mounted() {\n    get();\n  }\n\n  updated() {\n    const { isOpen } = store.drawerState;\n    if (isOpen) {\n      this.classList.add('open');\n    } else {\n      this.classList.remove('open');\n    }\n  }\n}\n\ncustomElements.define('app-drawer', Drawer);\n","import { html } from '../../js_modules/lit-html.js';\nimport Component from '../../lib/component.js';\nimport history from '../../lib/history.js';\nimport AppUpload from '../upload/index.js';\nimport { store } from '../../models/index.js';\nimport { search } from '../../services/song.js';\nimport mediaQuery from '../../lib/mediaquery.js';\nimport Drawer from '../drawer/index.js';\nimport Modal from '../modal/index.js';\nimport getAddPlaylistModal from '../modals/add-playlist.js';\nimport routeMap from '../router/map.js';\n\nfunction getTitle() {\n  return html`\n    <app-title class=\"title\"></app-title>\n  `;\n}\n\nfunction getUploadButton() {\n  return html`\n    <app-icon @click=\"${AppUpload.open}\" name=\"add\">\n      <app-ripple scale=\".8\" circle></app-ripple>\n    </app-icon>\n  `;\n}\n\nfunction getMenuButton() {\n  return html`\n    <app-icon @click=\"${Drawer.open}\" name=\"menu\">\n      <app-ripple scale=\".8\" circle></app-ripple>\n    </app-icon>\n  `;\n}\n\nfunction getSearchButton() {\n  return html`\n    <app-link path=\"${routeMap.SEARCH.path}\">\n      <app-icon name=\"search\">\n        <app-ripple scale=\".8\" circle></app-ripple>\n      </app-icon>\n    </app-link>\n  `;\n}\n\nfunction getAddPlaylistButton() {\n  return html`\n    <app-icon\n      name=\"playlist-add\"\n      @click=\"${() => Modal.open(getAddPlaylistModal())}\"\n    >\n      <app-ripple scale=\".8\" circle></app-ripple>\n    </app-icon>\n  `;\n}\n\nfunction getBackButton() {\n  return html`\n    <app-link path=\"${routeMap.HOME.path}\" title=\"back\">\n      <app-icon name=\"arrow-back\">\n        <app-ripple scale=\".8\" circle></app-ripple>\n      </app-icon>\n    </app-link>\n  `;\n}\n\nfunction getSearchInput() {\n  const { query } = history.location;\n  return html`\n    <form-text\n      class=\"input\"\n      value=\"${query.get('q') || store.searchData.text}\"\n      autofocus\n      @change=\"${({ detail }) => search(detail)}\"\n    >\n    </form-text>\n  `;\n}\nexport default class AppAction extends Component {\n  static TITLE = Symbol('title');\n  static UPLOAD = Symbol('upload');\n  static SEARCH = Symbol('search');\n  static BACK = Symbol('back');\n  static ADD_PLAYLIST = Symbol('add playlist');\n  static MENU = Symbol('menu');\n  static SEARCH_INPUT = Symbol('search input');\n\n  static observedPropertys = ['actions'];\n  static observedStores = [store.selectorState];\n\n  getContents() {\n    return this.actions.map(ele => {\n      switch (ele) {\n        case AppAction.TITLE:\n          return getTitle();\n        case AppAction.UPLOAD:\n          return getUploadButton();\n        case AppAction.SEARCH:\n          return getSearchButton();\n        case AppAction.BACK:\n          return getBackButton();\n        case AppAction.ADD_PLAYLIST:\n          return getAddPlaylistButton();\n        case AppAction.MENU:\n          return getMenuButton();\n        case AppAction.SEARCH_INPUT:\n          return getSearchInput();\n        default:\n          return '';\n      }\n    });\n  }\n\n  render() {\n    if (!this.actions.length) return html``;\n\n    return html`\n      <style>\n        :host {\n          flex-shrink: 0;\n          display: flex;\n          align-items: center;\n          padding: calc(1.6rem + env(safe-area-inset-top)) 1.6rem 1.6rem;\n        }\n        .title {\n          display: none;\n        }\n        .contents {\n          display: contents;\n        }\n        .contents app-icon {\n          margin-right: 1.6rem;\n        }\n        @media ${mediaQuery.LAPTOP}, ${mediaQuery.DESKTOP} {\n          app-icon[name='menu'] {\n            display: none;\n          }\n        }\n        @media ${mediaQuery.PHONE} and ${mediaQuery.PWA} {\n          :host {\n            z-index: 4;\n            position: -webkit-sticky;\n            position: sticky;\n            top: 0;\n            padding: calc(0.4rem + env(safe-area-inset-top)) 0.4rem 0.4rem;\n            background: var(--action-background-color);\n            color: var(--action-text-color);\n            fill: var(--action-text-color);\n            box-shadow: var(--action-box-shadow);\n          }\n          .title {\n            flex-grow: 1;\n            display: block;\n            margin: 0;\n            padding: 0 1.2rem;\n            font-size: 2rem;\n            font-weight: 500;\n            overflow: hidden;\n            white-space: nowrap;\n            text-overflow: ellipsis;\n          }\n          .contents app-icon {\n            padding: 1.2rem;\n            margin-right: 0;\n          }\n          .input {\n            padding-right: 1.2rem;\n          }\n        }\n      </style>\n      <div class=\"contents\">\n        ${this.getContents()}\n      </div>\n    `;\n  }\n}\ncustomElements.define('app-action', AppAction);\n","export function capitalize(str) {\n  return str.replace(/^\\w/, match => match.toUpperCase());\n}\n\nexport function kebabCase(str) {\n  return str.replace(/[A-Z]/g, match => `-${match.toLowerCase()}`);\n}\n\nexport function htmlClass(obj) {\n  return Object.keys(obj).reduce((p, key) => {\n    if (!obj[key]) return p;\n    return `${p}${p ? ' ' : ''}${kebabCase(key)}`;\n  }, '');\n}\n\nexport function htmlStyle(obj) {\n  return Object.keys(obj).reduce((p, key) => {\n    return `${p}${kebabCase(key)}: ${obj[key]};`;\n  }, '');\n}\n","import { html } from '../../js_modules/lit-html.js';\nimport { SingleInstanceComponent } from '../../lib/component.js';\nimport history from '../../lib/history.js';\nimport { capitalize } from '../../utils/string.js';\nimport { store, updateStore } from '../../models/index.js';\nimport mediaQuery from '../../lib/mediaquery.js';\n\nconst InitData = Object.assign({}, store.confirmState);\n\nexport default class Confirm extends SingleInstanceComponent {\n  static open(state) {\n    updateStore(store.confirmState, {\n      ...InitData,\n      ...state,\n      isOpen: true,\n    });\n    history.pushState({\n      title: state.title,\n      close: Confirm.close,\n    });\n  }\n\n  static close() {\n    updateStore(store.confirmState, { isOpen: false });\n  }\n\n  static observedStores = [store.confirmState];\n\n  okHandle = () => {\n    const { oncomplete } = store.confirmState;\n    if (oncomplete) oncomplete();\n    Confirm.close();\n    history.back();\n  };\n\n  cancelHandle = () => {\n    const { oncancel } = store.confirmState;\n    if (oncancel) oncancel();\n    Confirm.close();\n    history.back();\n  };\n\n  render() {\n    const { title, complete, cancel, text } = store.confirmState;\n\n    return html`\n      <style>\n        :host {\n          z-index: 10;\n          position: fixed;\n          top: 0;\n          left: 0;\n          display: flex;\n          justify-content: center;\n          align-items: center;\n          width: 100%;\n          height: 100%;\n          opacity: 0;\n          pointer-events: none;\n        }\n        :host(.open) {\n          opacity: 1;\n          pointer-events: auto;\n        }\n        .backdrop {\n          position: absolute;\n          top: 0;\n          left: 0;\n          width: 100%;\n          height: 100%;\n        }\n        .warp {\n          flex-shrink: 1;\n          position: absolute;\n          width: 28rem;\n          padding: 1.6rem;\n          border-radius: 0.2rem;\n          background: var(--modal-background-color);\n          color: var(--modal-text-primary-color);\n          fill: var(--modal-text-primary-color);\n          box-shadow: var(--modal-box-shadow);\n          overflow: auto;\n        }\n        .title {\n          flex-grow: 1;\n          margin: 0 0 1.4rem;\n          padding: 0;\n          font-size: 2rem;\n          font-weight: 500;\n          text-transform: capitalize;\n        }\n        .body {\n          min-height: 4em;\n          margin-bottom: 1em;\n        }\n        .footer {\n          display: flex;\n          flex-direction: row-reverse;\n        }\n        @media ${mediaQuery.PHONE} {\n          :host {\n            transition-duration: 0.2s;\n            transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n          }\n          .backdrop {\n            background: var(--theme-backdrop-color);\n          }\n        }\n      </style>\n      <div class=\"backdrop\"></div>\n      <div class=\"warp\">\n        <h1 class=\"title\" ?hidden=\"${!title}\">${title}</h1>\n        <div class=\"body\">${capitalize(text)}</div>\n        <div class=\"footer\">\n          <form-button @click=\"${this.okHandle}\" ?hidden=\"${!complete}\">\n            ${complete}\n          </form-button>\n          <form-button\n            @click=\"${this.cancelHandle}\"\n            ?hidden=\"${!cancel}\"\n            type=\"secondary\"\n          >\n            ${cancel}\n          </form-button>\n        </div>\n      </div>\n    `;\n  }\n\n  mounted() {\n    this.hidden = false;\n  }\n\n  updated() {\n    const { isOpen } = store.confirmState;\n    if (isOpen) {\n      this.classList.add('open');\n    } else {\n      this.classList.remove('open');\n    }\n  }\n}\n\ncustomElements.define('app-confirm', Confirm);\n","export function randomRGBColor(type) {\n  const randomNumber = () => Math.floor(Math.random() * 256);\n  const color = [randomNumber(), randomNumber(), randomNumber()];\n  if (type === 'hex') {\n    return `#${color.reduce((p, c) => p + c.toString(16), '')}`;\n  }\n  return color;\n}\n\nexport function luminance(r, g, b) {\n  const a = [r, g, b].map(v => {\n    v /= 255;\n    return v <= 0.03928 ? v / 12.92 : ((v + 0.055) / 1.055) ** 2.4;\n  });\n  return a[0] * 0.2126 + a[1] * 0.7152 + a[2] * 0.0722;\n}\n\nexport function contrast(rgb1, rgb2) {\n  const l1 = luminance(rgb1[0], rgb1[1], rgb1[2]) + 0.05;\n  const l2 = luminance(rgb2[0], rgb2[1], rgb2[2]) + 0.05;\n  return Math.max(l1, l2) / Math.min(l1, l2);\n}\n\n/**\n * Converts an RGB color value to HSL. Conversion formula\n * adapted from http://en.wikipedia.org/wiki/HSL_color_space.\n * Assumes r, g, and b are contained in the set [0, 255] and\n * returns h, s, and l in the set [0, 1].\n *\n * @param   Number  r       The red color value\n * @param   Number  g       The green color value\n * @param   Number  b       The blue color value\n * @return  Array           The HSL representation\n */\nexport function rgbToHsl(r, g, b) {\n  r /= 255;\n  g /= 255;\n  b /= 255;\n\n  const max = Math.max(r, g, b);\n\n  const min = Math.min(r, g, b);\n  let h;\n\n  let s;\n\n  const l = (max + min) / 2;\n\n  if (max === min) {\n    // achromatic\n    h = 0;\n    s = 0;\n  } else {\n    const d = max - min;\n    s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n\n    switch (max) {\n      case r:\n        h = (g - b) / d + (g < b ? 6 : 0);\n        break;\n      case g:\n        h = (b - r) / d + 2;\n        break;\n      case b:\n        h = (r - g) / d + 4;\n        break;\n      default:\n    }\n\n    h /= 6;\n  }\n\n  return [h, s, l];\n}\n\nexport function hueToRGB(p, q, t) {\n  if (t < 0) t += 1;\n  if (t > 1) t -= 1;\n  if (t < 1 / 6) return p + (q - p) * 6 * t;\n  if (t < 1 / 2) return q;\n  if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6;\n  return p;\n}\n\n/**\n * Converts an HSL color value to RGB. Conversion formula\n * adapted from http://en.wikipedia.org/wiki/HSL_color_space.\n * Assumes h, s, and l are contained in the set [0, 1] and\n * returns r, g, and b in the set [0, 255].\n *\n * @param   Number  h       The hue\n * @param   Number  s       The saturation\n * @param   Number  l       The lightness\n * @return  Array           The RGB representation\n */\nexport function hslToRGB(h, s, l) {\n  let r;\n  let g;\n  let b;\n\n  if (s === 0) {\n    // achromatic\n    r = l;\n    g = l;\n    b = l;\n  } else {\n    const q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n    const p = 2 * l - q;\n\n    r = hueToRGB(p, q, h + 1 / 3);\n    g = hueToRGB(p, q, h);\n    b = hueToRGB(p, q, h - 1 / 3);\n  }\n\n  return [Math.round(r * 255), Math.round(g * 255), Math.round(b * 255)];\n}\n\nexport const hexToRGB = str =>\n  str\n    .replace('#', '')\n    .split(/(\\w{2})?/)\n    .filter(e => e)\n    .map(e => Number(`0x${e}`));\n","import { randomRGBColor, luminance, hslToRGB } from './color.js';\n\nexport function createCanvas(width, height) {\n  const canvas = document.createElement('canvas');\n  canvas.width = width;\n  canvas.height = height;\n  return canvas;\n}\n\nexport function transformTextToSVG(text) {\n  const range = [[0, 1], [0.2, 0.7], [0.3, 0.6]];\n  const backgroundHSL = randomRGBColor().map((e, i) => {\n    const total = e / 255;\n    return range[i][0] + total * (range[i][1] - range[i][0]);\n  });\n  const backgroundRGB = hslToRGB(...backgroundHSL);\n  const background = `rgb(${backgroundRGB.join(',')})`;\n  const color = luminance(...backgroundRGB) < 0.2 ? '#ffffff44' : '#00000044';\n  const getTranslate = () => Math.random() / 5;\n  const getRotate = () => (Math.random() - 0.5) * 45;\n\n  const strs = [...String(text)].map(\n    char => `<text\n      x=\"50%\"\n      y=\"50%\"\n      dominant-baseline=\"middle\"\n      text-anchor=\"middle\"\n      transform=\"translate(${getTranslate()}, ${getTranslate()}) rotate(${getRotate()})\"\n    >${char}</text>`,\n  );\n  return `data:image/svg+xml,${encodeURIComponent(`<svg width=\"300\" height=\"300\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 1 1\">\n      <style>\n        :root {\n          background: ${background};\n          fill: ${color};\n          font: 1px sans-serif;\n        }\n      </style>\n      ${strs.join('')}\n    </svg>`)}`;\n}\n\nexport async function transformSVGDataURLToBitmap(\n  dataUrl,\n  { width = 512, height = 512 } = {},\n) {\n  const img = new Image();\n  const canvas = createCanvas(width, height);\n  const ctx = canvas.getContext('2d');\n  img.src = dataUrl;\n  await new Promise(resolve => {\n    img.onload = () => {\n      ctx.drawImage(img, 0, 0, width, height);\n      resolve();\n    };\n  });\n  return canvas.toDataURL();\n}\n\nexport const blobToDataURL = blob => {\n  const reader = new FileReader();\n  return new Promise(resolve => {\n    reader.addEventListener(\n      'load',\n      () => {\n        resolve(reader.result);\n      },\n      false,\n    );\n\n    reader.readAsDataURL(blob);\n  });\n};\n\nexport const compressionImg = async (\n  { img = new Image(), file },\n  limit,\n  option,\n) => {\n  const canvas = document.createElement('canvas');\n  try {\n    if (!img.naturalWidth) {\n      img.src = await blobToDataURL(file);\n      await new Promise((resolve, reject) => {\n        img.onload = resolve;\n        img.onerror = reject;\n      });\n    }\n    const rate = Math.min(\n      limit.filesize ? Math.sqrt(limit.filesize / file.size) : 1,\n      limit.size ? limit.size.width / img.naturalWidth : 1,\n      limit.size ? limit.size.height / img.naturalHeight : 1,\n    );\n    if (rate >= 1) return Promise.resolve(file);\n    canvas.width = img.naturalWidth * rate;\n    canvas.height = img.naturalHeight * rate;\n    const ctx = canvas.getContext('2d');\n    ctx.imageSmoothingQuality = 'high';\n    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\n    if (option && option.output === 'dataUrl')\n      return Promise.resolve(canvas.toDataURL());\n    return new Promise(resolve =>\n      canvas.toBlob(blob => {\n        resolve(\n          new File([blob], file.name, {\n            type: blob.type,\n          }),\n        );\n      }, file.type),\n    );\n  } catch (err) {\n    throw new Error('compressionImg error');\n  }\n};\n","/**\n * [x] Async render placeholder\n * * Lazy loading\n * [x] Aspect ratio\n */\nimport { html } from '../../js_modules/lit-html.js';\nimport Component from '../../lib/component.js';\nimport { getSrc, getAbbrPinyin } from '../../utils/misc.js';\nimport { transformTextToSVG } from '../../utils/canvas.js';\nimport { htmlClass } from '../../utils/string.js';\n\nconst altPlaceholderMap = new Map();\n\nexport default class Image extends Component {\n  static async getAltPlaceholder(alt = '') {\n    if (!altPlaceholderMap.has(alt)) {\n      altPlaceholderMap.set(\n        alt,\n        new Promise(async resolve => {\n          resolve(transformTextToSVG(await getAbbrPinyin(alt)));\n        }),\n      );\n    }\n    return altPlaceholderMap.get(alt);\n  }\n\n  static observedAttributes = [\n    'data-alt',\n    'data-src',\n    'data-aspect-ratio',\n    'data-lazy',\n    'data-fit',\n  ];\n\n  get img() {\n    return this.shadowRoot.querySelector('img');\n  }\n\n  state = {\n    altPlaceholder: null,\n  };\n\n  render() {\n    const { aspectRatio = 1, fit = 'cover', src } = this.dataset;\n    const { altPlaceholder } = this.state;\n    const autoSizeClass = htmlClass({ autosize: aspectRatio === 'auto' });\n\n    return html`\n      <style>\n        :host {\n          display: block;\n          position: relative;\n          overflow: hidden;\n          contain: content;\n          font-size: 0;\n        }\n        .img {\n          position: absolute;\n          width: 100%;\n          height: 100%;\n          top: 0;\n          left: 0;\n          object-fit: ${fit};\n          color: transparent;\n        }\n        .img.autosize {\n          position: static;\n        }\n        .img::before {\n          content: '';\n          display: inline-block;\n          width: 100%;\n          height: 100%;\n          background: var(--player-text-secondary-color) center no-repeat;\n          background-size: contain;\n        }\n        .img:not([src])::before {\n          visibility: hidden;\n        }\n        .dimension {\n          width: 100%;\n          padding-bottom: ${aspectRatio * 100}%;\n        }\n        .dimension.autosize {\n          display: none;\n        }\n      </style>\n      <img\n        crossorigin=\"anonymous\"\n        alt=\" \"\n        class=\"img ${autoSizeClass}\"\n        src=\"${getSrc(src || altPlaceholder)}\"\n      />\n      <div class=\"dimension ${autoSizeClass}\"></div>\n    `;\n  }\n\n  async mounted() {\n    const { alt, src } = this.dataset;\n    if (!src) {\n      this.setState({\n        altPlaceholder: await Image.getAltPlaceholder(alt),\n      });\n    }\n  }\n\n  async attributeChanged(attr) {\n    const { src, alt } = this.dataset;\n    if (attr === 'data-alt' || attr === 'data-src') {\n      // component is sync update !!!\n      // if the dependency of `Image.getAltPlaceholder` is already loaded\n      // will not cause redundant updates\n      this.setState({\n        altPlaceholder: src ? null : await Image.getAltPlaceholder(alt),\n      });\n    }\n  }\n}\n\ncustomElements.define('app-img', Image);\n","import { html } from '../../js_modules/lit-html.js';\nimport Component from '../../lib/component.js';\nimport mediaQuery from '../../lib/mediaquery.js';\n\ncustomElements.define(\n  'form-button',\n  class extends Component {\n    static observedAttributes = ['disabled', 'type'];\n\n    render() {\n      const disabled = this.getAttribute('disabled');\n      const type = this.getAttribute('type') || '';\n\n      return html`\n        <style>\n          :focus {\n            outline: none;\n          }\n          button {\n            position: relative;\n            overflow: hidden;\n            padding: 1rem;\n            border: none;\n            border-radius: 2px;\n            background: transparent;\n            text-transform: uppercase;\n            color: var(--theme-color);\n            font-size: 1.4rem;\n            font-weight: 500;\n          }\n          button.secondary {\n            color: var(--form-text-secondary-color);\n          }\n          button:disabled {\n            cursor: not-allowed;\n            color: var(--form-text-disabled-color);\n          }\n          @media ${mediaQuery.HOVER} {\n            button:hover:not(:disabled) {\n              background: var(--form-hover-background-color);\n            }\n          }\n        </style>\n        <button class=\"${type}\" ?disabled=\"${disabled}\">\n          <slot></slot>\n          <app-ripple type=\"touch\" ?disabled=\"${disabled}\"></app-ripple>\n        </button>\n      `;\n    }\n  },\n);\n","import { html } from '../../js_modules/lit-html.js';\nimport Component from '../../lib/component.js';\nimport { getSrc } from '../../utils/misc.js';\nimport { compressionImg } from '../../utils/canvas.js';\nimport mediaQuery from '../../lib/mediaquery.js';\n\ncustomElements.define(\n  'form-img',\n  class extends Component {\n    static observedAttributes = ['name'];\n\n    constructor() {\n      super();\n      this.onclick = this.clickHandle;\n      this.state = {\n        file: null,\n        blobUrl: '',\n      };\n    }\n\n    get value() {\n      return this.state.file;\n    }\n\n    clickHandle = () => {\n      const input = this.shadowRoot.querySelector('input');\n      input.click();\n    };\n\n    changeHandle = () => {\n      const input = this.shadowRoot.querySelector('input');\n      const file = input.files[0];\n      if (this.limit) {\n        compressionImg({ file }, this.limit).then(f => {\n          this.revokeURL();\n          this.setState({\n            file: f,\n            blobUrl: URL.createObjectURL(f),\n          });\n        });\n      } else {\n        this.revokeURL();\n        this.setState({\n          file,\n          blobUrl: URL.createObjectURL(file),\n        });\n      }\n      input.value = '';\n    };\n\n    revokeURL = () => {\n      const { blobUrl } = this.state;\n      if (blobUrl) {\n        URL.revokeObjectURL(blobUrl);\n      }\n    };\n\n    render() {\n      const { blobUrl } = this.state;\n      const name = this.getAttribute('name');\n      const src = this.getAttribute('src');\n\n      return html`\n        <style>\n          :host {\n            position: relative;\n            display: block;\n          }\n          :host(:hover) .hint {\n            display: flex;\n            justify-content: center;\n            align-items: center;\n          }\n          img {\n            width: 100%;\n            height: 100%;\n            object-fit: cover;\n            overflow: hidden;\n            position: absolute;\n          }\n          img::before {\n            content: '';\n            display: inline-block;\n            width: 100%;\n            height: 100%;\n            background: var(--player-text-secondary-color) center no-repeat;\n            background-size: contain;\n          }\n          .hint {\n            position: absolute;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            background: #0008;\n            color: #fff;\n            font-size: 1.2rem;\n            text-align: center;\n          }\n          @media ${mediaQuery.HOVER} {\n            :host(:not(:hover)) .hint {\n              display: none;\n            }\n          }\n        </style>\n        <input\n          type=\"file\"\n          accept=\"image/*\"\n          @change=\"${this.changeHandle}\"\n          name=\"${name}\"\n          hidden\n        />\n        <img alt=\" \" src=\"${getSrc(blobUrl || src)}\" />\n        <div class=\"hint\">change picture</div>\n      `;\n    }\n\n    unmounted() {\n      this.revokeURL();\n    }\n  },\n);\n","import { html } from '../../js_modules/lit-html.js';\nimport Component from '../../lib/component.js';\nimport { throttle } from '../../utils/misc.js';\nimport { htmlClass } from '../../utils/string.js';\n\ncustomElements.define(\n  'form-text',\n  class extends Component {\n    static observedAttributes = [\n      'name',\n      'label',\n      'value',\n      'placeholder',\n      'disabled',\n      'autofocus',\n    ];\n\n    constructor() {\n      super();\n      this.isComposition = false;\n      this.inputHandle = this.inputHandle.bind(this);\n      this.compositionHandle = this.compositionHandle.bind(this);\n      this.state = {\n        isStartedInput: false,\n      };\n    }\n\n    get input() {\n      return this.shadowRoot.querySelector('input');\n    }\n\n    get value() {\n      return this.input.value;\n    }\n\n    set value(v) {\n      this.input.value = v;\n    }\n\n    get validity() {\n      this.setStartedInput();\n      return this.input.validity;\n    }\n\n    setStartedInput() {\n      const { isStartedInput } = this.state;\n      if (!isStartedInput) {\n        this.setState({ isStartedInput: true });\n      }\n    }\n\n    inputHandle() {\n      this.setStartedInput();\n      if (!this.isComposition) {\n        this.dispatchEvent(new CustomEvent('change', { detail: this.value }));\n      }\n    }\n\n    compositionHandle({ type }) {\n      this.isComposition = type !== 'compositionend';\n    }\n\n    render() {\n      const name = this.getAttribute('name');\n      const label = this.getAttribute('label');\n      const pattern = this.getAttribute('pattern') || '.*';\n      const value = this.getAttribute('value') || '';\n      const placeholder = this.getAttribute('placeholder') || '';\n\n      const required = this.hasAttribute('required');\n      const disabled = this.hasAttribute('disabled');\n\n      const { isStartedInput } = this.state;\n      return html`\n        <style>\n          :host(:not([hidden])) {\n            display: block;\n            flex-grow: 1;\n          }\n          :focus {\n            outline: none;\n          }\n          .wrap {\n            position: relative;\n            display: block;\n            font-size: 1.6rem;\n          }\n          .wrap .label {\n            font-size: 0.75em;\n            color: var(--form-text-secondary-color);\n            text-transform: capitalize;\n          }\n          input {\n            display: block;\n            box-sizing: border-box;\n            width: 100%;\n            padding: 0.5em 0;\n            border-width: 0 0 1px;\n            border-color: var(--form-text-secondary-color);\n            border-style: solid;\n            background: transparent;\n            color: inherit;\n            caret-color: var(--theme-color);\n            font-size: inherit;\n            border-radius: 0;\n          }\n          input + .border {\n            pointer-events: none;\n            position: absolute;\n            bottom: 0;\n            left: 0;\n            width: 100%;\n            height: 2px;\n            background: transparent;\n            transform: scaleX(0);\n            transition: transform 0.3s;\n          }\n          input:hover,\n          input:focus {\n            border-color: var(--theme-color);\n          }\n          input:focus + .border {\n            background: var(--theme-color);\n            transform: scaleX(1);\n          }\n          input.started-input:invalid {\n            border-color: var(--theme-error-color);\n          }\n          input.started-input:invalid + .border {\n            background: var(--theme-error-color);\n          }\n        </style>\n        <label class=\"wrap\">\n          <div class=\"label\" ?hidden=\"${!label}\">${label}</div>\n          <input\n            class=\"${htmlClass({ startedInput: isStartedInput })}\"\n            type=\"text\"\n            name=\"${name}\"\n            value=\"${value}\"\n            pattern=\"${pattern}\"\n            placeholder=\"${placeholder}\"\n            ?required=\"${required}\"\n            ?disabled=\"${disabled}\"\n            autocomplete=\"off\"\n            @input=\"${throttle(this.inputHandle, 1000)}\"\n            @compositionstart=\"${this.compositionHandle}\"\n            @compositionupdate=\"${this.compositionHandle}\"\n            @compositionend=\"${this.compositionHandle}\"\n            spellcheck=\"false\"\n          />\n          <div class=\"border\"></div>\n        </label>\n      `;\n    }\n\n    connected() {\n      const autofocus = this.hasAttribute('autofocus');\n      if (autofocus) {\n        this.focus();\n      }\n    }\n\n    focus() {\n      this.input.focus();\n    }\n  },\n);\n","import { html } from '../../js_modules/lit-html.js';\nimport Component from '../../lib/component.js';\n\nimport './button.js';\nimport './image.js';\nimport './text.js';\n\ncustomElements.define(\n  'app-form',\n  class extends Component {\n    get elements() {\n      return this.querySelectorAll('[name]');\n    }\n\n    get value() {\n      const formData = new FormData();\n      this.elements.forEach(ele => {\n        if ('value' in ele) {\n          formData.append(ele.getAttribute('name'), ele.value);\n        }\n      });\n      return formData;\n    }\n\n    render() {\n      return html`\n        <style>\n          :host {\n            display: block;\n            color: var(--form-text-primary-color);\n          }\n        </style>\n        <slot></slot>\n      `;\n    }\n\n    valid() {\n      let valid = true;\n      this.elements.forEach(ele => {\n        // Verify each element\n        if (ele.validity && !ele.validity.valid) {\n          valid = false;\n        }\n      });\n      return valid;\n    }\n  },\n);\n","import { html } from '../../js_modules/lit-html.js';\nimport Component from '../../lib/component.js';\nimport history from '../../lib/history.js';\n\ncustomElements.define(\n  'app-link',\n  class extends Component {\n    static observedStores = [history.historyState];\n\n    constructor() {\n      super();\n      this.onclick = this.clickHandle;\n    }\n\n    get active() {\n      const path = this.getAttribute('path');\n      const query = this.getAttribute('query') || '';\n\n      const { href } = history.location;\n      return path + query === href;\n    }\n\n    clickHandle = () => {\n      const { $close } = history.location.state;\n      const path = this.getAttribute('path');\n      const query = this.getAttribute('query') || '';\n      if (!this.active) {\n        if ($close) {\n          history.back();\n          setTimeout(() => {\n            history.push({ path, query });\n          }, 200);\n        } else {\n          history.push({ path, query });\n        }\n      }\n    };\n\n    render() {\n      if (this.active) {\n        this.setAttribute('active', '');\n      } else {\n        this.removeAttribute('active');\n      }\n\n      return html`\n        <style>\n          :host {\n            display: contents;\n          }\n        </style>\n        <slot></slot>\n      `;\n    }\n  },\n);\n","/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\nimport { createMarker, directive, NodePart, removeNodes, reparentNodes } from \"../../lit-html.js\"; // Helper functions for manipulating parts\n// TODO(kschaaf): Refactor into Part API?\n\nconst createAndInsertPart = (containerPart, beforePart) => {\n  const container = containerPart.startNode.parentNode;\n  const beforeNode = beforePart === undefined ? containerPart.endNode : beforePart.startNode;\n  const startNode = container.insertBefore(createMarker(), beforeNode);\n  container.insertBefore(createMarker(), beforeNode);\n  const newPart = new NodePart(containerPart.options);\n  newPart.insertAfterNode(startNode);\n  return newPart;\n};\n\nconst updatePart = (part, value) => {\n  part.setValue(value);\n  part.commit();\n  return part;\n};\n\nconst insertPartBefore = (containerPart, part, ref) => {\n  const container = containerPart.startNode.parentNode;\n  const beforeNode = ref ? ref.startNode : containerPart.endNode;\n  const endNode = part.endNode.nextSibling;\n\n  if (endNode !== beforeNode) {\n    reparentNodes(container, part.startNode, endNode, beforeNode);\n  }\n};\n\nconst removePart = part => {\n  removeNodes(part.startNode.parentNode, part.startNode, part.endNode.nextSibling);\n}; // Helper for generating a map of array item to its index over a subset\n// of an array (used to lazily generate `newKeyToIndexMap` and\n// `oldKeyToIndexMap`)\n\n\nconst generateMap = (list, start, end) => {\n  const map = new Map();\n\n  for (let i = start; i <= end; i++) {\n    map.set(list[i], i);\n  }\n\n  return map;\n}; // Stores previous ordered list of parts and map of key to index\n\n\nconst partListCache = new WeakMap();\nconst keyListCache = new WeakMap();\n/**\n * A directive that repeats a series of values (usually `TemplateResults`)\n * generated from an iterable, and updates those items efficiently when the\n * iterable changes based on user-provided `keys` associated with each item.\n *\n * Note that if a `keyFn` is provided, strict key-to-DOM mapping is maintained,\n * meaning previous DOM for a given key is moved into the new position if\n * needed, and DOM will never be reused with values for different keys (new DOM\n * will always be created for new keys). This is generally the most efficient\n * way to use `repeat` since it performs minimum unnecessary work for insertions\n * amd removals.\n *\n * IMPORTANT: If providing a `keyFn`, keys *must* be unique for all items in a\n * given call to `repeat`. The behavior when two or more items have the same key\n * is undefined.\n *\n * If no `keyFn` is provided, this directive will perform similar to mapping\n * items to values, and DOM will be reused against potentially different items.\n */\n\nexport const repeat = directive((items, keyFnOrTemplate, template) => {\n  let keyFn;\n\n  if (template === undefined) {\n    template = keyFnOrTemplate;\n  } else if (keyFnOrTemplate !== undefined) {\n    keyFn = keyFnOrTemplate;\n  }\n\n  return containerPart => {\n    if (!(containerPart instanceof NodePart)) {\n      throw new Error('repeat can only be used in text bindings');\n    } // Old part & key lists are retrieved from the last update\n    // (associated with the part for this instance of the directive)\n\n\n    const oldParts = partListCache.get(containerPart) || [];\n    const oldKeys = keyListCache.get(containerPart) || []; // New part list will be built up as we go (either reused from\n    // old parts or created for new keys in this update). This is\n    // saved in the above cache at the end of the update.\n\n    const newParts = []; // New value list is eagerly generated from items along with a\n    // parallel array indicating its key.\n\n    const newValues = [];\n    const newKeys = [];\n    let index = 0;\n\n    for (const item of items) {\n      newKeys[index] = keyFn ? keyFn(item, index) : index;\n      newValues[index] = template(item, index);\n      index++;\n    } // Maps from key to index for current and previous update; these\n    // are generated lazily only when needed as a performance\n    // optimization, since they are only required for multiple\n    // non-contiguous changes in the list, which are less common.\n\n\n    let newKeyToIndexMap;\n    let oldKeyToIndexMap; // Head and tail pointers to old parts and new values\n\n    let oldHead = 0;\n    let oldTail = oldParts.length - 1;\n    let newHead = 0;\n    let newTail = newValues.length - 1; // Overview of O(n) reconciliation algorithm (general approach\n    // based on ideas found in ivi, vue, snabbdom, etc.):\n    //\n    // * We start with the list of old parts and new values (and\n    // arrays of\n    //   their respective keys), head/tail pointers into each, and\n    //   we build up the new list of parts by updating (and when\n    //   needed, moving) old parts or creating new ones. The initial\n    //   scenario might look like this (for brevity of the diagrams,\n    //   the numbers in the array reflect keys associated with the\n    //   old parts or new values, although keys and parts/values are\n    //   actually stored in parallel arrays indexed using the same\n    //   head/tail pointers):\n    //\n    //      oldHead v                 v oldTail\n    //   oldKeys:  [0, 1, 2, 3, 4, 5, 6]\n    //   newParts: [ ,  ,  ,  ,  ,  ,  ]\n    //   newKeys:  [0, 2, 1, 4, 3, 7, 6] <- reflects the user's new\n    //   item order\n    //      newHead ^                 ^ newTail\n    //\n    // * Iterate old & new lists from both sides, updating,\n    // swapping, or\n    //   removing parts at the head/tail locations until neither\n    //   head nor tail can move.\n    //\n    // * Example below: keys at head pointers match, so update old\n    // part 0 in-\n    //   place (no need to move it) and record part 0 in the\n    //   `newParts` list. The last thing we do is advance the\n    //   `oldHead` and `newHead` pointers (will be reflected in the\n    //   next diagram).\n    //\n    //      oldHead v                 v oldTail\n    //   oldKeys:  [0, 1, 2, 3, 4, 5, 6]\n    //   newParts: [0,  ,  ,  ,  ,  ,  ] <- heads matched: update 0\n    //   and newKeys:  [0, 2, 1, 4, 3, 7, 6]    advance both oldHead\n    //   & newHead\n    //      newHead ^                 ^ newTail\n    //\n    // * Example below: head pointers don't match, but tail pointers\n    // do, so\n    //   update part 6 in place (no need to move it), and record\n    //   part 6 in the `newParts` list. Last, advance the `oldTail`\n    //   and `oldHead` pointers.\n    //\n    //         oldHead v              v oldTail\n    //   oldKeys:  [0, 1, 2, 3, 4, 5, 6]\n    //   newParts: [0,  ,  ,  ,  ,  , 6] <- tails matched: update 6\n    //   and newKeys:  [0, 2, 1, 4, 3, 7, 6]    advance both oldTail\n    //   & newTail\n    //         newHead ^              ^ newTail\n    //\n    // * If neither head nor tail match; next check if one of the\n    // old head/tail\n    //   items was removed. We first need to generate the reverse\n    //   map of new keys to index (`newKeyToIndexMap`), which is\n    //   done once lazily as a performance optimization, since we\n    //   only hit this case if multiple non-contiguous changes were\n    //   made. Note that for contiguous removal anywhere in the\n    //   list, the head and tails would advance from either end and\n    //   pass each other before we get to this case and removals\n    //   would be handled in the final while loop without needing to\n    //   generate the map.\n    //\n    // * Example below: The key at `oldTail` was removed (no longer\n    // in the\n    //   `newKeyToIndexMap`), so remove that part from the DOM and\n    //   advance just the `oldTail` pointer.\n    //\n    //         oldHead v           v oldTail\n    //   oldKeys:  [0, 1, 2, 3, 4, 5, 6]\n    //   newParts: [0,  ,  ,  ,  ,  , 6] <- 5 not in new map; remove\n    //   5 and newKeys:  [0, 2, 1, 4, 3, 7, 6]    advance oldTail\n    //         newHead ^           ^ newTail\n    //\n    // * Once head and tail cannot move, any mismatches are due to\n    // either new or\n    //   moved items; if a new key is in the previous \"old key to\n    //   old index\" map, move the old part to the new location,\n    //   otherwise create and insert a new part. Note that when\n    //   moving an old part we null its position in the oldParts\n    //   array if it lies between the head and tail so we know to\n    //   skip it when the pointers get there.\n    //\n    // * Example below: neither head nor tail match, and neither\n    // were removed;\n    //   so find the `newHead` key in the `oldKeyToIndexMap`, and\n    //   move that old part's DOM into the next head position\n    //   (before `oldParts[oldHead]`). Last, null the part in the\n    //   `oldPart` array since it was somewhere in the remaining\n    //   oldParts still to be scanned (between the head and tail\n    //   pointers) so that we know to skip that old part on future\n    //   iterations.\n    //\n    //         oldHead v        v oldTail\n    //   oldKeys:  [0, 1, -, 3, 4, 5, 6]\n    //   newParts: [0, 2,  ,  ,  ,  , 6] <- stuck; update & move 2\n    //   into place newKeys:  [0, 2, 1, 4, 3, 7, 6]    and advance\n    //   newHead\n    //         newHead ^           ^ newTail\n    //\n    // * Note that for moves/insertions like the one above, a part\n    // inserted at\n    //   the head pointer is inserted before the current\n    //   `oldParts[oldHead]`, and a part inserted at the tail\n    //   pointer is inserted before `newParts[newTail+1]`. The\n    //   seeming asymmetry lies in the fact that new parts are moved\n    //   into place outside in, so to the right of the head pointer\n    //   are old parts, and to the right of the tail pointer are new\n    //   parts.\n    //\n    // * We always restart back from the top of the algorithm,\n    // allowing matching\n    //   and simple updates in place to continue...\n    //\n    // * Example below: the head pointers once again match, so\n    // simply update\n    //   part 1 and record it in the `newParts` array.  Last,\n    //   advance both head pointers.\n    //\n    //         oldHead v        v oldTail\n    //   oldKeys:  [0, 1, -, 3, 4, 5, 6]\n    //   newParts: [0, 2, 1,  ,  ,  , 6] <- heads matched; update 1\n    //   and newKeys:  [0, 2, 1, 4, 3, 7, 6]    advance both oldHead\n    //   & newHead\n    //            newHead ^        ^ newTail\n    //\n    // * As mentioned above, items that were moved as a result of\n    // being stuck\n    //   (the final else clause in the code below) are marked with\n    //   null, so we always advance old pointers over these so we're\n    //   comparing the next actual old value on either end.\n    //\n    // * Example below: `oldHead` is null (already placed in\n    // newParts), so\n    //   advance `oldHead`.\n    //\n    //            oldHead v     v oldTail\n    //   oldKeys:  [0, 1, -, 3, 4, 5, 6] // old head already used;\n    //   advance newParts: [0, 2, 1,  ,  ,  , 6] // oldHead newKeys:\n    //   [0, 2, 1, 4, 3, 7, 6]\n    //               newHead ^     ^ newTail\n    //\n    // * Note it's not critical to mark old parts as null when they\n    // are moved\n    //   from head to tail or tail to head, since they will be\n    //   outside the pointer range and never visited again.\n    //\n    // * Example below: Here the old tail key matches the new head\n    // key, so\n    //   the part at the `oldTail` position and move its DOM to the\n    //   new head position (before `oldParts[oldHead]`). Last,\n    //   advance `oldTail` and `newHead` pointers.\n    //\n    //               oldHead v  v oldTail\n    //   oldKeys:  [0, 1, -, 3, 4, 5, 6]\n    //   newParts: [0, 2, 1, 4,  ,  , 6] <- old tail matches new\n    //   head: update newKeys:  [0, 2, 1, 4, 3, 7, 6]   & move 4,\n    //   advance oldTail & newHead\n    //               newHead ^     ^ newTail\n    //\n    // * Example below: Old and new head keys match, so update the\n    // old head\n    //   part in place, and advance the `oldHead` and `newHead`\n    //   pointers.\n    //\n    //               oldHead v oldTail\n    //   oldKeys:  [0, 1, -, 3, 4, 5, 6]\n    //   newParts: [0, 2, 1, 4, 3,   ,6] <- heads match: update 3\n    //   and advance newKeys:  [0, 2, 1, 4, 3, 7, 6]    oldHead &\n    //   newHead\n    //                  newHead ^  ^ newTail\n    //\n    // * Once the new or old pointers move past each other then all\n    // we have\n    //   left is additions (if old list exhausted) or removals (if\n    //   new list exhausted). Those are handled in the final while\n    //   loops at the end.\n    //\n    // * Example below: `oldHead` exceeded `oldTail`, so we're done\n    // with the\n    //   main loop.  Create the remaining part and insert it at the\n    //   new head position, and the update is complete.\n    //\n    //                   (oldHead > oldTail)\n    //   oldKeys:  [0, 1, -, 3, 4, 5, 6]\n    //   newParts: [0, 2, 1, 4, 3, 7 ,6] <- create and insert 7\n    //   newKeys:  [0, 2, 1, 4, 3, 7, 6]\n    //                     newHead ^ newTail\n    //\n    // * Note that the order of the if/else clauses is not important\n    // to the\n    //   algorithm, as long as the null checks come first (to ensure\n    //   we're always working on valid old parts) and that the final\n    //   else clause comes last (since that's where the expensive\n    //   moves occur). The order of remaining clauses is is just a\n    //   simple guess at which cases will be most common.\n    //\n    // * TODO(kschaaf) Note, we could calculate the longest\n    // increasing\n    //   subsequence (LIS) of old items in new position, and only\n    //   move those not in the LIS set. However that costs O(nlogn)\n    //   time and adds a bit more code, and only helps make rare\n    //   types of mutations require fewer moves. The above handles\n    //   removes, adds, reversal, swaps, and single moves of\n    //   contiguous items in linear time, in the minimum number of\n    //   moves. As the number of multiple moves where LIS might help\n    //   approaches a random shuffle, the LIS optimization becomes\n    //   less helpful, so it seems not worth the code at this point.\n    //   Could reconsider if a compelling case arises.\n\n    while (oldHead <= oldTail && newHead <= newTail) {\n      if (oldParts[oldHead] === null) {\n        // `null` means old part at head has already been used\n        // below; skip\n        oldHead++;\n      } else if (oldParts[oldTail] === null) {\n        // `null` means old part at tail has already been used\n        // below; skip\n        oldTail--;\n      } else if (oldKeys[oldHead] === newKeys[newHead]) {\n        // Old head matches new head; update in place\n        newParts[newHead] = updatePart(oldParts[oldHead], newValues[newHead]);\n        oldHead++;\n        newHead++;\n      } else if (oldKeys[oldTail] === newKeys[newTail]) {\n        // Old tail matches new tail; update in place\n        newParts[newTail] = updatePart(oldParts[oldTail], newValues[newTail]);\n        oldTail--;\n        newTail--;\n      } else if (oldKeys[oldHead] === newKeys[newTail]) {\n        // Old head matches new tail; update and move to new tail\n        newParts[newTail] = updatePart(oldParts[oldHead], newValues[newTail]);\n        insertPartBefore(containerPart, oldParts[oldHead], newParts[newTail + 1]);\n        oldHead++;\n        newTail--;\n      } else if (oldKeys[oldTail] === newKeys[newHead]) {\n        // Old tail matches new head; update and move to new head\n        newParts[newHead] = updatePart(oldParts[oldTail], newValues[newHead]);\n        insertPartBefore(containerPart, oldParts[oldTail], oldParts[oldHead]);\n        oldTail--;\n        newHead++;\n      } else {\n        if (newKeyToIndexMap === undefined) {\n          // Lazily generate key-to-index maps, used for removals &\n          // moves below\n          newKeyToIndexMap = generateMap(newKeys, newHead, newTail);\n          oldKeyToIndexMap = generateMap(oldKeys, oldHead, oldTail);\n        }\n\n        if (!newKeyToIndexMap.has(oldKeys[oldHead])) {\n          // Old head is no longer in new list; remove\n          removePart(oldParts[oldHead]);\n          oldHead++;\n        } else if (!newKeyToIndexMap.has(oldKeys[oldTail])) {\n          // Old tail is no longer in new list; remove\n          removePart(oldParts[oldTail]);\n          oldTail--;\n        } else {\n          // Any mismatches at this point are due to additions or\n          // moves; see if we have an old part we can reuse and move\n          // into place\n          const oldIndex = oldKeyToIndexMap.get(newKeys[newHead]);\n          const oldPart = oldIndex !== undefined ? oldParts[oldIndex] : null;\n\n          if (oldPart === null) {\n            // No old part for this value; create a new one and\n            // insert it\n            const newPart = createAndInsertPart(containerPart, oldParts[oldHead]);\n            updatePart(newPart, newValues[newHead]);\n            newParts[newHead] = newPart;\n          } else {\n            // Reuse old part\n            newParts[newHead] = updatePart(oldPart, newValues[newHead]);\n            insertPartBefore(containerPart, oldPart, oldParts[oldHead]); // This marks the old part as having been used, so that\n            // it will be skipped in the first two checks above\n\n            oldParts[oldIndex] = null;\n          }\n\n          newHead++;\n        }\n      }\n    } // Add parts for any remaining new values\n\n\n    while (newHead <= newTail) {\n      // For all remaining additions, we insert before last new\n      // tail, since old pointers are no longer valid\n      const newPart = createAndInsertPart(containerPart, newParts[newTail + 1]);\n      updatePart(newPart, newValues[newHead]);\n      newParts[newHead++] = newPart;\n    } // Remove any remaining unused old parts\n\n\n    while (oldHead <= oldTail) {\n      const oldPart = oldParts[oldHead++];\n\n      if (oldPart !== null) {\n        removePart(oldPart);\n      }\n    } // Save order of new parts for next round\n\n\n    partListCache.set(containerPart, newParts);\n    keyListCache.set(containerPart, newKeys);\n  };\n});","import { html } from '../../js_modules/lit-html.js';\nimport { repeat } from '../../js_modules/npm:lit-html@1.0.0/directives/repeat.js';\nimport Component from '../../lib/component.js';\nimport { store } from '../../models/index.js';\nimport { playlistMap, songMap } from '../../models/data-map.js';\n\nexport default class AppSongList extends Component {\n  static observedAttributes = ['id', 'filtername', 'filtervalue'];\n  static observedPropertys = ['data'];\n  static observedStores = [store.playerState];\n\n  render() {\n    const id = this.getAttribute('id');\n    const filtername = this.getAttribute('filtername');\n    const filtervalue = this.getAttribute('filtervalue');\n    let list;\n    if (id !== null) {\n      // playlist\n      ({ list = [] } = playlistMap.get(id));\n    } else {\n      ({ list = [] } = this.data);\n    }\n    if (filtername) {\n      list = list.filter(\n        songId => songMap.get(songId)[filtername] === filtervalue,\n      );\n    }\n    return html`\n      <style>\n        :host {\n          flex-grow: 1;\n        }\n      </style>\n      ${repeat(list, songId => songId, this.renderItem)}\n    `;\n  }\n\n  renderItem = songId => {\n    const { errorList, currentSong, state } = store.playerState;\n    const playIcon = state === 'paused' ? 'pause' : 'playing';\n    const isError = errorList.includes(songId);\n    const { updatedAt } = songMap.get(songId);\n    return html`\n      <song-list-item\n        id=\"${songId}\"\n        updatedat=\"${updatedAt}\"\n        ?error=\"${isError}\"\n        ?active=\"${currentSong === songId}\"\n      >\n        <app-icon\n          name=\"${playIcon}\"\n          ?hidden=\"${currentSong !== songId || isError}\"\n        >\n        </app-icon>\n      </song-list-item>\n    `;\n  };\n\n  mounted() {\n    this.connectStores([this.data]);\n    if (this.fetchData) this.fetchData();\n  }\n\n  attributeChanged() {\n    if (this.fetchData) this.fetchData();\n  }\n}\n\ncustomElements.define('app-song-list', AppSongList);\n","export const secondToMinute = number => {\n  const second = Math.round(number % 60);\n  return `${Math.floor(number / 60)}:${second > 9 ? second : `0${second}`}`;\n};\n","import { html } from '../../js_modules/lit-html.js';\nimport { store, updateStore } from '../../models/index.js';\nimport { SingleInstanceComponent } from '../../lib/component.js';\nimport history from '../../lib/history.js';\nimport mediaQuery from '../../lib/mediaquery.js';\n\nconst InitData = Object.assign({}, store.menuState);\n\nexport default class AppMenu extends SingleInstanceComponent {\n  static open(state) {\n    updateStore(store.menuState, {\n      ...InitData,\n      ...state,\n      isOpen: true,\n    });\n    if (mediaQuery.isPhone) {\n      history.pushState({\n        title: state.title,\n        close: AppMenu.close,\n      });\n    }\n  }\n\n  static close() {\n    updateStore(store.menuState, { isOpen: false });\n    setTimeout(() => {\n      // Restore to default style\n      // To perform the animation the next time you open the default menu.\n      const { isOpen } = store.menuState;\n      if (!isOpen) {\n        updateStore(store.menuState, { type: '' });\n      }\n    }, 200);\n  }\n\n  static observedStores = [store.menuState];\n\n  closeHandle = () => {\n    const { onclose } = store.menuState;\n    AppMenu.close();\n    if (mediaQuery.isPhone) history.back();\n    if (onclose) onclose();\n  };\n\n  clickHandle = index => {\n    const { list } = store.menuState;\n    this.closeHandle();\n    setTimeout(list[index].handle, 100);\n  };\n\n  render() {\n    const { list, target, stage, type } = store.menuState;\n    const position = { x: 0, y: 0 };\n    const translate = { x: 0, y: 0 };\n    if (stage && target) {\n      const stageRect = stage.getBoundingClientRect();\n      const targetRect = target.getBoundingClientRect();\n\n      position.x = targetRect.x;\n      position.y = targetRect.y + targetRect.height;\n\n      if (stageRect.right - targetRect.right < 169) {\n        translate.x = -100;\n        position.x = targetRect.x + targetRect.width;\n        if (mediaQuery.isPhone) {\n          position.y -= targetRect.height;\n        }\n      }\n      if (stageRect.bottom - targetRect.bottom < list.length * 34 + 16) {\n        translate.y = -100;\n        position.y = targetRect.y;\n        if (mediaQuery.isPhone) {\n          position.y += targetRect.height;\n        }\n      }\n    }\n    const items = list.map(\n      (ele, index) => html`\n        <li @click=\"${() => this.clickHandle(index)}\">\n          ${ele.text}\n          <app-ripple type=\"touch\" scale=\"1\"></app-ripple>\n        </li>\n      `,\n    );\n\n    const style =\n      type === 'center'\n        ? ''\n        : `\n      left: ${position.x}px;\n      top: ${position.y}px;\n      transform: translate(${translate.x}%, ${translate.y}%);\n    `;\n    return html`\n      <style>\n        :host {\n          z-index: 10;\n          position: fixed;\n          left: 0;\n          top: 0;\n          display: block;\n          width: 100%;\n          height: 100%;\n          opacity: 0;\n          pointer-events: none;\n        }\n        :host(.open) {\n          opacity: 1;\n          pointer-events: auto;\n        }\n        .backdrop {\n          position: absolute;\n          top: 0;\n          left: 0;\n          width: 100%;\n          height: 100%;\n        }\n        .backdrop.center {\n          background: var(--theme-backdrop-color);\n        }\n        .menu {\n          position: absolute;\n          overflow: auto;\n          scrollbar-width: none;\n          border-radius: 0.2rem;\n          box-shadow: var(--menu-box-shadow);\n        }\n        .menu::-webkit-scrollbar {\n          width: 0;\n        }\n        .menu.center {\n          top: 50%;\n          left: 50%;\n          transform: translate(-50%, -50%);\n          width: 30rem;\n          max-width: calc(var(--safe-width) * 0.9);\n          max-height: calc(var(--safe-height) * 0.9);\n        }\n        .menu.center ol {\n          transition: none;\n          width: 100%;\n          margin: 0;\n        }\n        ol {\n          width: 16.9rem;\n          margin: 0 0 -2rem -3rem;\n          padding: 0.8rem 0;\n          background: var(--menu-background-color);\n          color: var(--menu-text-color);\n        }\n        :host(.open) ol {\n          margin: 0;\n        }\n        li {\n          position: relative;\n          line-height: 4.4rem;\n          padding: 0px 1.4rem;\n          list-style: none;\n          text-transform: capitalize;\n          text-overflow: ellipsis;\n          white-space: nowrap;\n          overflow: hidden;\n        }\n        @media ${mediaQuery.HOVER} {\n          li:hover {\n            cursor: default;\n            background: var(--menu-hover-background-color);\n            color: var(--menu-hover-text-color);\n          }\n        }\n        @media ${mediaQuery.PHONE} {\n          ol {\n            padding: 0;\n          }\n\n          :host,\n          ol {\n            transition-property: margin, opacity;\n            transition-duration: 0.1s;\n            transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n          }\n        }\n      </style>\n      <div @click=\"${this.closeHandle}\" class=\"backdrop ${type}\"></div>\n      <div class=\"menu ${type}\" style=\"${style}\">\n        <ol>\n          ${items}\n        </ol>\n      </div>\n    `;\n  }\n\n  mounted() {\n    this.hidden = false;\n  }\n\n  updated() {\n    const { isOpen } = store.menuState;\n    if (isOpen) {\n      this.classList.add('open');\n    } else {\n      this.classList.remove('open');\n    }\n  }\n}\ncustomElements.define('app-menu', AppMenu);\n","import { html, render } from '../../js_modules/lit-html.js';\nimport mediaQuery from '../../lib/mediaquery.js';\nimport { getSrc } from '../../utils/misc.js';\nimport { update } from '../../services/song.js';\n\nexport default function getSongEditModal(song) {\n  const form = document.createElement('app-form');\n  render(\n    html`\n      <style>\n        app-form {\n          display: flex;\n        }\n        form-img {\n          width: 10rem;\n          height: 10rem;\n          margin: 0 var(--modal-margin) var(--modal-margin) 0;\n        }\n        form-text {\n          margin-bottom: 2em;\n        }\n        .text {\n          flex-grow: 1;\n        }\n        @media ${mediaQuery.PHONE} {\n          app-form {\n            flex-direction: column;\n          }\n        }\n      </style>\n      <form-img\n        name=\"picture\"\n        .limit=\"${{ size: { width: 512, height: 512 }, filesize: 200 * 1024 }}\"\n        src=\"${getSrc(song.picture)}\"\n      >\n      </form-img>\n      <div class=\"text\">\n        <form-text\n          label=\"title\"\n          name=\"title\"\n          value=\"${song.title || ''}\"\n        ></form-text>\n        <form-text\n          label=\"artist\"\n          name=\"artist\"\n          value=\"${song.artist || ''}\"\n        ></form-text>\n        <form-text\n          label=\"album\"\n          name=\"album\"\n          value=\"${song.album || ''}\"\n        ></form-text>\n      </div>\n    `,\n    form,\n  );\n  const oncomplete = () => {\n    update(Number(song.id), form.value);\n  };\n  return {\n    title: 'edit music info',\n    complete: 'save',\n    cancel: 'cancel',\n    template: form,\n    oncomplete,\n  };\n}\n","import { html } from '../../js_modules/lit-html.js';\nimport { AsyncComponent } from '../../lib/component.js';\nimport history from '../../lib/history.js';\nimport { store, updateStore } from '../../models/index.js';\nimport { secondToMinute } from '../../utils/datetime.js';\nimport AppMenu from '../menu/index.js';\nimport routeMap from '../router/map.js';\nimport { del, update } from '../../services/song.js';\nimport Modal from '../modal/index.js';\nimport Confirm from '../confirm/index.js';\nimport mediaQuery from '../../lib/mediaquery.js';\nimport getSongEditModal from '../modals/song-edit.js';\nimport { addSong, removeSong } from '../../services/playlist.js';\nimport { songMap, playlistMap } from '../../models/data-map.js';\n\ncustomElements.define(\n  'song-list-item',\n  class extends AsyncComponent {\n    static observedAttributes = ['id', 'updatedat'];\n\n    constructor() {\n      super();\n      this.onclick = this.clickHandle;\n    }\n\n    clickHandle = () => {\n      updateStore(store.playerState, {\n        currentSong: Number(this.id),\n        state: 'playing',\n      });\n    };\n\n    addToPlaylist = async () => {\n      const songId = Number(this.id);\n      const { list } = store.playlistData;\n      AppMenu.open({\n        type: 'center',\n        list: list.map(playlistId => ({\n          text: playlistMap.get(playlistId).title,\n          handle() {\n            addSong(playlistId, songId);\n          },\n        })),\n      });\n    };\n\n    openMenuHandle = event => {\n      this.classList.add('hover');\n      const { path, query } = history.location;\n      const actions = [\n        {\n          text: 'edit',\n          handle: this.editHandle,\n        },\n        {\n          text: 'delete',\n          handle: this.deleteHandle,\n        },\n      ];\n      const playlistId = path === routeMap.PLAYLIST.path && query.get('id');\n      if (playlistId) {\n        actions.push({\n          text: 'remove from playlist',\n          handle: () => removeSong(playlistId, Number(this.id)),\n        });\n      } else {\n        actions.push({\n          text: 'add to playlist',\n          handle: this.addToPlaylist,\n        });\n      }\n      if (path === routeMap.FAVORITES.path) {\n        actions.push({\n          text: 'remove from favorites',\n          handle: () => update(Number(this.id), { star: 0 }),\n        });\n      }\n      AppMenu.open({\n        list: actions,\n        target: event.currentTarget,\n        stage: mediaQuery.isPhone ? document.body : this.getRootNode().host,\n        onclose: () => this.classList.remove('hover'),\n      });\n      event.stopPropagation();\n    };\n\n    editHandle = () => {\n      Modal.open(getSongEditModal(songMap.get(Number(this.id))));\n    };\n\n    deleteHandle = () => {\n      Confirm.open({\n        complete: 'confirm',\n        cancel: 'cancel',\n        text: 'delete song?',\n        oncomplete: () => del(Number(this.id)),\n      });\n    };\n\n    render() {\n      const song = songMap.get(Number(this.id));\n      return html`\n        <style>\n          :host {\n            contain: content;\n            position: relative;\n            display: flex;\n            padding: 1.6rem;\n            transition: background-color 0.3s;\n          }\n          :host([active]) {\n            --list-item-playing-color: var(--theme-color);\n          }\n          :host([error]) {\n            --list-item-playing-color: var(--theme-error-color);\n          }\n          .info {\n            flex-grow: 1;\n            width: 0;\n          }\n          .title {\n            color: var(--list-item-playing-color);\n            fill: var(--list-item-playing-color);\n          }\n          ::slotted(app-icon:not([hidden])) {\n            vertical-align: middle;\n            margin: -0.6rem 0 -0.4rem -0.5rem;\n          }\n          .title,\n          .name {\n            overflow: hidden;\n            white-space: nowrap;\n            text-overflow: ellipsis;\n          }\n          .name {\n            margin-top: 0.25em;\n          }\n          .name:blank {\n            display: none;\n          }\n          .name,\n          .duration {\n            font-size: 0.875em;\n            color: var(--list-text-secondary-color);\n          }\n          .more app-icon {\n            margin-top: -0.2rem;\n          }\n          .more app-ripple {\n            z-index: 1;\n          }\n          .more,\n          .duration {\n            min-width: 4rem;\n            padding-left: 0.75rem;\n            text-align: right;\n          }\n          .duration {\n            padding-top: 0.125em;\n            color: var(--list-item-playing-color);\n          }\n\n          @media ${mediaQuery.HOVER} {\n            :host(:hover),\n            :host(.hover) {\n              background: var(--list-hover-background-color);\n            }\n\n            .more {\n              display: none;\n            }\n\n            :host(:hover) .more,\n            :host(.hover) .more {\n              display: block;\n            }\n          }\n          @media ${mediaQuery.PHONE} {\n            .more app-ripple {\n              transform: scale(2);\n            }\n          }\n        </style>\n        <div class=\"info\">\n          <div class=\"title\">\n            <slot></slot>\n            ${song.title}\n          </div>\n          <div class=\"name\">${song.artist || 'unknown'}</div>\n        </div>\n        <div class=\"more\">\n          <app-icon @click=\"${this.openMenuHandle}\" name=\"more-horiz\">\n            <app-ripple circle></app-ripple>\n          </app-icon>\n        </div>\n        <div class=\"duration\">\n          ${secondToMinute(song.duration)}\n        </div>\n        <app-ripple type=\"touch\"></app-ripple>\n      `;\n    }\n  },\n);\n","import { html } from '../../js_modules/lit-html.js';\nimport { repeat } from '../../js_modules/npm:lit-html@1.0.0/directives/repeat.js';\nimport AppSongList from './song.js';\nimport mediaQuery from '../../lib/mediaquery.js';\nimport routeMap from '../router/map.js';\nimport { playlistMap } from '../../models/data-map.js';\n\nexport default class AppPlaylistList extends AppSongList {\n  render() {\n    const { list } = this.data;\n    return html`\n      <style>\n        :host {\n          flex-grow: 1;\n          display: grid;\n          grid-template-columns: repeat(auto-fill, minmax(13rem, 1fr));\n          grid-template-rows: max-content;\n          grid-gap: 2rem;\n        }\n        @media ${mediaQuery.PHONE} {\n          :host {\n            padding: 0.4rem;\n            grid-template-columns: repeat(auto-fill, minmax(10rem, 1fr));\n            grid-gap: 1rem;\n          }\n        }\n      </style>\n      ${repeat(list, playlistId => playlistId, this.renderItem)}\n    `;\n  }\n\n  renderItem = playlistId => {\n    const { id, title, image, updatedAt } = playlistMap.get(playlistId);\n    const link = {\n      path: routeMap.PLAYLIST.path,\n      query: `?id=${id}`,\n    };\n    const data = {\n      id,\n      image,\n      title,\n    };\n    return html`\n      <gallery-item\n        title=\"${title}\"\n        .link=\"${link}\"\n        .data=\"${data}\"\n        updatedat=\"${updatedAt}\"\n      >\n      </gallery-item>\n    `;\n  };\n}\n\ncustomElements.define('app-playlist-list', AppPlaylistList);\n","import { html } from '../../js_modules/lit-html.js';\nimport AppPlaylistList from './playlist.js';\nimport routeMap from '../router/map.js';\n\ncustomElements.define(\n  'app-album-list',\n  class extends AppPlaylistList {\n    renderItem = ({ title, cover }) => {\n      const link = {\n        path: routeMap.SONGS.path,\n        query: `?${routeMap.ALBUMS.subTitle}=${encodeURIComponent(title)}`,\n      };\n      const data = { image: cover, title };\n      return html`\n        <gallery-item title=\"${title}\" .link=\"${link}\" .data=\"${data}\">\n        </gallery-item>\n      `;\n    };\n  },\n);\n","import { html } from '../../js_modules/lit-html.js';\nimport AppPlaylistList from './playlist.js';\nimport routeMap from '../router/map.js';\n\ncustomElements.define(\n  'app-artist-list',\n  class extends AppPlaylistList {\n    renderItem = ({ name, photo }) => {\n      const link = {\n        path: routeMap.SONGS.path,\n        query: `?${routeMap.ARTISTS.subTitle}=${encodeURIComponent(name)}`,\n      };\n      const data = {\n        image: photo,\n        title: name,\n      };\n      return html`\n        <gallery-item\n          title=\"${name}\"\n          .link=\"${link}\"\n          .data=\"${data}\"\n        ></gallery-item>\n      `;\n    };\n  },\n);\n","import { html } from '../../js_modules/lit-html.js';\nimport { AsyncComponent } from '../../lib/component.js';\nimport mediaQuery from '../../lib/mediaquery.js';\nimport history from '../../lib/history.js';\n\ncustomElements.define(\n  'gallery-item',\n  class extends AsyncComponent {\n    static observedAttributes = ['id', 'updatedat'];\n\n    onClick = () => {\n      if (this.link) {\n        history.push(this.link);\n      }\n    };\n\n    render() {\n      const { image, title, dec = '' } = this.data;\n      return html`\n        <style>\n          :host {\n            position: relative;\n            text-align: center;\n          }\n          .footer {\n            padding: 1rem;\n          }\n          .title,\n          .name {\n            line-height: 1.3em;\n            overflow: hidden;\n            text-overflow: ellipsis;\n            white-space: nowrap;\n          }\n          @media ${mediaQuery.HOVER} {\n            :host(:hover) {\n              cursor: pointer;\n            }\n          }\n          @media ${mediaQuery.PHONE} {\n            .footer {\n              padding: 0.4rem;\n            }\n          }\n        </style>\n        <app-img data-src=\"${image || ''}\" data-alt=\"${title}\"></app-img>\n        <div class=\"footer\">\n          <div class=\"title\">${title}</div>\n          <div class=\"dec\">${dec}</div>\n        </div>\n        <app-ripple @click=\"${this.onClick}\" type=\"touch\"></app-ripple>\n      `;\n    }\n  },\n);\n","import { html } from '../../js_modules/lit-html.js';\nimport Component from '../../lib/component.js';\nimport { capitalize } from '../../utils/string.js';\nimport mediaQuery from '../../lib/mediaquery.js';\nimport routeMap from '../router/map.js';\n\ncustomElements.define(\n  'app-notfound',\n  class extends Component {\n    render() {\n      return html`\n        <style>\n          :host {\n            flex-grow: 1;\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n            align-items: center;\n            color: var(--notfound-text-secondary-color);\n            fill: var(--notfound-text-secondary-color);\n          }\n          h1 {\n            margin: 0.2em 0;\n            font-size: 3em;\n            font-weight: 500;\n            text-transform: uppercase;\n          }\n          app-link {\n            color: var(--notfound-text-primary-color);\n          }\n          app-link span {\n            border-bottom: 1px solid transparent;\n          }\n          @media ${mediaQuery.HOVER} {\n            app-link span:hover {\n              cursor: pointer;\n              border-color: currentColor;\n            }\n          }\n        </style>\n        <h1>not found</h1>\n        <app-link path=\"${routeMap.HOME.path}\" title=\"go homepage\">\n          <span>${capitalize('go homepage')}</span>\n        </app-link>\n      `;\n    }\n  },\n);\n","import { html } from '../../js_modules/lit-html.js';\nimport Component from '../../lib/component.js';\nimport { store, updateStore } from '../../models/index.js';\nimport mediaQuery from '../../lib/mediaquery.js';\nimport { update } from '../../services/song.js';\nimport AppMenu from '../menu/index.js';\nimport { addSong } from '../../services/playlist.js';\nimport { songMap, playlistMap } from '../../models/data-map.js';\n\ncustomElements.define(\n  'player-song-info',\n  class extends Component {\n    static observedStores = [store.playerState];\n\n    addToPlaylist = () => {\n      const { currentSong } = store.playerState;\n      const { list } = store.playlistData;\n      AppMenu.open({\n        type: 'center',\n        list: list.map(playlistId => ({\n          text: playlistMap.get(playlistId).title,\n          handle() {\n            addSong(playlistId, currentSong);\n          },\n        })),\n      });\n    };\n\n    tooglePipMode = () => {\n      const { pip } = store.playerState;\n      updateStore(store.playerState, {\n        pip: pip ? null : this.shadowRoot.querySelector('app-img').img,\n      });\n    };\n\n    render() {\n      const { currentSong, pip } = store.playerState;\n      const song = songMap.get(currentSong);\n      return html`\n        <style>\n          :host {\n            display: flex;\n            align-items: center;\n            font-size: 1.4rem;\n          }\n          .img {\n            --padding: 1.6rem;\n            position: relative;\n            flex-shrink: 0;\n            margin: var(--padding);\n            width: calc(var(--player-height) - (var(--padding)) * 2);\n            box-shadow: var(--player-cover-box-shadow);\n          }\n          app-img {\n            width: 100%;\n            height: 100%;\n          }\n          .pip {\n            display: none;\n          }\n          .wrap {\n            display: contents;\n          }\n          .text {\n            overflow: hidden;\n          }\n          .name,\n          .artist {\n            overflow: hidden;\n            text-overflow: ellipsis;\n            white-space: nowrap;\n          }\n          .artist {\n            margin-top: 0.28em;\n            font-size: 0.85em;\n            color: var(--player-text-secondary-color);\n          }\n          .wrap app-icon {\n            padding: 1.6rem;\n          }\n          .add-playlist {\n            display: none;\n          }\n          @media ${mediaQuery.HOVER} {\n            .img:hover .pip:not([hidden]) {\n              display: flex;\n              position: absolute;\n              top: 0;\n              left: 0;\n              width: 100%;\n              height: 100%;\n              justify-content: center;\n              align-items: center;\n              background: rgba(0, 0, 0, 0.45);\n              cursor: pointer;\n            }\n          }\n          @media ${mediaQuery.PHONE} {\n            :host(:not([maximize])) .img,\n            :host(:not([maximize])) .star {\n              display: none;\n            }\n            :host([maximize]) {\n              flex-direction: column;\n              font-size: 1.6rem;\n            }\n            :host([maximize]) .img {\n              display: flex;\n              flex-shrink: 1;\n              width: calc(100vw - 5.6rem);\n              margin: 0;\n            }\n            :host([maximize]) .text {\n              flex-grow: 1;\n              box-sizing: border-box;\n              padding: 1.6rem 0;\n              text-align: center;\n            }\n            :host([maximize]) .wrap {\n              display: flex;\n              width: 100%;\n            }\n            :host([maximize]) .star {\n              order: -1;\n            }\n            :host([maximize]) .add-playlist {\n              display: block;\n            }\n            :host([maximize]) .name {\n              width: auto;\n            }\n            :host([maximize]) .artist {\n              width: auto;\n            }\n          }\n          @media ${mediaQuery.SMALL_PHONE} {\n            :host([maximize]) .img {\n              height: 0;\n              flex-grow: 1;\n            }\n            :host([maximize]) .wrap {\n              flex-grow: 0;\n            }\n          }\n          @media ${mediaQuery.WATCH} {\n            .img,\n            .wrap app-icon {\n              display: none;\n            }\n            .wrap {\n              width: 100%;\n            }\n          }\n          @media ${mediaQuery.SHORT} {\n            .img {\n              width: 20vw;\n              height: 100%;\n              margin-left: 0;\n            }\n          }\n        </style>\n        <div class=\"img\">\n          <app-img\n            data-src=\"${song.picture || ''}\"\n            data-alt=\"${song.title}\"\n          ></app-img>\n          <div\n            class=\"pip\"\n            ?hidden=\"${!document.pictureInPictureEnabled}\"\n            @click=\"${this.tooglePipMode}\"\n          >\n            <app-icon name=\"${pip ? 'pip-open' : 'pip'}\"></app-icon>\n          </div>\n        </div>\n        <div class=\"wrap\">\n          <div class=\"text\">\n            <div class=\"name\">${song.title}</div>\n            <div class=\"artist\">\n              ${song.title ? song.artist || 'unknown' : ''}\n            </div>\n          </div>\n          <app-icon\n            class=\"add-playlist\"\n            @click=\"${this.addToPlaylist}\"\n            name=\"add-circle-outline\"\n          >\n            <app-ripple circle></app-ripple>\n          </app-icon>\n          <app-icon\n            class=\"star\"\n            @click=\"${() => update(song.id, { star: song.star ? 0 : 1 })}\"\n            name=\"${song.star ? 'star' : 'star-border'}\"\n          >\n            <app-ripple circle></app-ripple>\n          </app-icon>\n        </div>\n      `;\n    }\n  },\n);\n","import { getSrc } from '../../utils/misc.js';\nimport { transformSVGDataURLToBitmap } from '../../utils/canvas.js';\nimport Image from '../image/index.js';\n\nconst emptyFunction = () => {};\n\nconst getPicture = async title =>\n  transformSVGDataURLToBitmap(await Image.getAltPlaceholder(title));\n\nconst mediaSession = {\n  async setMetadata({ title, artist, album, picture }) {\n    if ('mediaSession' in navigator) {\n      const metadata = { title };\n\n      if (artist) metadata.artist = artist;\n      if (album) metadata.album = album;\n      const src = picture || (await getPicture(title));\n      metadata.artwork = [\n        {\n          src: getSrc(src),\n        },\n      ];\n\n      navigator.mediaSession.metadata = new window.MediaMetadata(metadata);\n      navigator.mediaSession.setActionHandler('play', mediaSession.onplay);\n      navigator.mediaSession.setActionHandler('pause', mediaSession.onpause);\n      // navigator.mediaSession.setActionHandler('seekbackward', mediaSession.onseekbackward);\n      // navigator.mediaSession.setActionHandler('seekforward', mediaSession.onseekforward);\n      navigator.mediaSession.setActionHandler(\n        'previoustrack',\n        mediaSession.onprevioustrack,\n      );\n      navigator.mediaSession.setActionHandler(\n        'nexttrack',\n        mediaSession.onnexttrack,\n      );\n    }\n  },\n  onplay: emptyFunction,\n  onpause: emptyFunction,\n  onseekbackward: emptyFunction,\n  onseekforward: emptyFunction,\n  onprevioustrack: emptyFunction,\n  onnexttrack: emptyFunction,\n};\n\nexport default mediaSession;\n","import { html } from '../../js_modules/lit-html.js';\nimport Component from '../../lib/component.js';\nimport { store, updateStore } from '../../models/index.js';\nimport mediaSession from './mediasession.js';\nimport mediaQuery from '../../lib/mediaquery.js';\n\ncustomElements.define(\n  'player-control',\n  class extends Component {\n    static observedStores = [store.playerState];\n\n    constructor() {\n      super();\n\n      mediaSession.onplay = this.clickPlayHandle;\n      mediaSession.onpause = this.clickPlayHandle;\n      mediaSession.onprevioustrack = this.clickPrevHandle;\n      mediaSession.onnexttrack = this.clickNextHandle;\n    }\n\n    clickShuffleHandle = () => {\n      const { shuffle } = store.playerState;\n      updateStore(store.playerState, {\n        shuffle: !shuffle,\n      });\n    };\n\n    clickPrevHandle = () => {\n      const { currentSong } = store.playerState;\n      const { list } = store.songData;\n      const currentIndex = list.findIndex(songId => songId === currentSong);\n      let prevIndex;\n      if (currentIndex === 0) {\n        prevIndex = list.length - 1;\n      } else {\n        prevIndex = currentIndex - 1;\n      }\n      updateStore(store.playerState, { currentSong: list[prevIndex] });\n    };\n\n    clickPlayHandle = () => {\n      const { state, currentSong } = store.playerState;\n      updateStore(store.playerState, {\n        currentSong: currentSong === null ? 0 : currentSong,\n        state: state === 'paused' ? 'playing' : 'paused',\n      });\n    };\n\n    clickNextHandle = () => {\n      const { currentSong } = store.playerState;\n      const { list } = store.songData;\n      const currentIndex = list.findIndex(songId => songId === currentSong);\n      let nextIndex;\n      if (currentIndex === list.length - 1) {\n        nextIndex = 0;\n      } else {\n        nextIndex = currentIndex + 1;\n      }\n      updateStore(store.playerState, {\n        currentSong: list[nextIndex],\n        state: 'playing',\n      });\n    };\n\n    clickModeHandle = () => {\n      const { mode } = store.playerState;\n      updateStore(store.playerState, {\n        mode: mode === 'repeat' ? 'repeat-one' : 'repeat',\n      });\n    };\n\n    render() {\n      const { state, shuffle, mode } = store.playerState;\n      return html`\n        <style>\n          :host {\n            display: flex;\n            align-items: center;\n            justify-content: space-between;\n            width: 24.6rem;\n            padding: 0 1.6rem;\n          }\n          app-icon.play {\n            padding: 1.3rem;\n            border: 2px solid;\n            border-radius: 100%;\n          }\n          app-icon.edge {\n            color: var(--player-text-secondary-color);\n            fill: var(--player-text-secondary-color);\n          }\n          [error] {\n            color: var(--theme-error-color);\n            fill: var(--theme-error-color);\n          }\n          @media ${mediaQuery.PHONE} {\n            :host(:not([maximize])) {\n              width: auto;\n              padding: 0;\n            }\n            :host(:not([maximize])) app-icon:not(.play) {\n              display: none;\n            }\n            :host(:not([maximize])) app-icon.play {\n              padding: 1.6rem;\n              border: none;\n            }\n            :host([maximize]) {\n              margin: 2.4rem auto;\n            }\n            :host([maximize]) app-icon.play {\n              padding: 2rem;\n            }\n          }\n          @media ${mediaQuery.WATCH} {\n            :host {\n              justify-content: space-evenly;\n            }\n            app-icon.edge {\n              display: none;\n            }\n          }\n        </style>\n\n        <app-icon\n          @click=\"${this.clickShuffleHandle}\"\n          class=\"edge\"\n          name=\"shuffle\"\n          style=\"opacity: ${shuffle ? 1 : 0.5}\"\n        >\n          <app-ripple circle></app-ripple>\n        </app-icon>\n        <app-icon @click=\"${this.clickPrevHandle}\" name=\"skip-previous\">\n          <app-ripple circle></app-ripple>\n        </app-icon>\n        <!-- TODO: animate -->\n        <app-icon\n          @click=\"${this.clickPlayHandle}\"\n          class=\"play\"\n          ?error=\"${state === 'error'}\"\n          name=\"${state === 'paused' ? 'play-arrow' : 'pause'}\"\n        >\n          <app-ripple circle></app-ripple>\n        </app-icon>\n        <app-icon @click=\"${this.clickNextHandle}\" name=\"skip-next\">\n          <app-ripple circle></app-ripple>\n        </app-icon>\n        <app-icon @click=\"${this.clickModeHandle}\" class=\"edge\" name=\"${mode}\">\n          <app-ripple circle></app-ripple>\n        </app-icon>\n      `;\n    }\n  },\n);\n","import { html } from '../../js_modules/lit-html.js';\nimport Component from '../../lib/component.js';\nimport { store, updateStore } from '../../models/index.js';\n\ncustomElements.define(\n  'player-volume',\n  class extends Component {\n    static observedStores = [store.playerState];\n\n    changeHandle = ({ detail }) => {\n      updateStore(store.playerState, {\n        volume: detail / 100,\n      });\n    };\n\n    clickHandle = () => {\n      const { muted } = store.playerState;\n      updateStore(store.playerState, {\n        muted: !muted,\n      });\n    };\n\n    render() {\n      const { volume, muted } = store.playerState;\n      let icon;\n      if (volume === 0 || muted) {\n        icon = 'volume-off';\n      } else if (volume < 0.3) {\n        icon = 'volume-mute';\n      } else if (volume < 0.66) {\n        icon = 'volume-down';\n      } else {\n        icon = 'volume-up';\n      }\n      return html`\n        <style>\n          :host {\n            display: flex;\n            justify-content: flex-end;\n            align-items: center;\n          }\n          app-icon {\n            margin-right: 1.6rem;\n          }\n          app-range {\n            max-width: 14.4rem;\n            margin-right: 2.4rem;\n            flex-shrink: 1;\n            flex-grow: 1;\n          }\n        </style>\n        <app-icon name=\"${icon}\" @click=\"${this.clickHandle}\">\n          <app-ripple circle></app-ripple>\n        </app-icon>\n        <app-range\n          @change=\"${this.changeHandle}\"\n          value=\"${volume * 100}\"\n        ></app-range>\n      `;\n    }\n  },\n);\n","import { html } from '../../js_modules/lit-html.js';\nimport Component from '../../lib/component.js';\nimport { store, updateStore } from '../../models/index.js';\nimport { secondToMinute } from '../../utils/datetime.js';\nimport mediaQuery from '../../lib/mediaquery.js';\n\ncustomElements.define(\n  'player-progress',\n  class extends Component {\n    static observedStores = [store.audioState];\n\n    constructor() {\n      super();\n      this.onclick = this.clickHandle;\n    }\n\n    clickHandle = ({ x }) => {\n      const { duration } = store.audioState;\n      const { left, width } = this.getBoundingClientRect();\n      const nextTime = Math.floor(((x - left) * duration) / width);\n      updateStore(store.audioState, {\n        currentTime: nextTime,\n      });\n    };\n\n    render() {\n      const { currentTime, duration } = store.audioState;\n      return html`\n        <style>\n          :host {\n            position: absolute;\n            left: 0;\n            top: 0;\n            width: 100%;\n            height: 3px;\n            margin-top: -3px;\n            padding-top: 3px;\n            padding-bottom: 3px;\n          }\n          .track {\n            height: 100%;\n          }\n          .value {\n            height: 100%;\n            background: var(--theme-color);\n          }\n          .times {\n            display: none;\n          }\n          @media ${mediaQuery.HOVER} {\n            :host {\n              cursor: pointer;\n            }\n          }\n          @media ${mediaQuery.PHONE} {\n            :host([maximize]) {\n              position: static;\n              width: calc(100vw - 3.2rem);\n              margin: 1.125em auto;\n            }\n            :host([maximize]) .track {\n              background: var(--player-text-secondary-color);\n            }\n            :host([maximize]) .times {\n              display: flex;\n              justify-content: space-between;\n              margin-top: 0.5em;\n              font-size: 0.75em;\n            }\n          }\n          @media ${mediaQuery.SHORT} {\n            :host {\n              margin-left: 20vw;\n            }\n          }\n        </style>\n        <div class=\"track\">\n          <div\n            class=\"value\"\n            style=\"width: ${(currentTime / duration).toFixed(4) * 100}%\"\n          ></div>\n        </div>\n        <div class=\"times\">\n          <span>${secondToMinute(currentTime)}</span>\n          <span>${secondToMinute(duration)}</span>\n        </div>\n      `;\n    }\n  },\n);\n","import Component from '../../lib/component.js';\nimport { store, updateStore } from '../../models/index.js';\nimport { get } from '../../services/song.js';\nimport mediaSession from './mediasession.js';\nimport { getSrc } from '../../utils/misc.js';\nimport mediaQuery from '../../lib/mediaquery.js';\nimport { songMap } from '../../models/data-map.js';\n\ncustomElements.define(\n  'player-audio',\n  class extends Component {\n    static observedStores = [store.playerState, store.audioState];\n\n    constructor() {\n      super();\n      this.audio = new Audio();\n      this.audio.onended = this.endHandle.bind(this);\n      this.audio.onerror = this.playError.bind(this);\n      this.audio.onplaying = this.playSuccess.bind(this);\n      this.audio.onabort = this.playSuccess.bind(this); // Enter the waiting stage\n      this.audio.onplay = () => this.video && this.video.play();\n      this.audio.onpause = () => this.video && this.video.pause();\n      this.setCurrentTime();\n\n      const canvas = document.createElement('canvas');\n      canvas.width = 300;\n      canvas.height = 300;\n      const ctx = canvas.getContext('2d');\n      this.video = document.createElement('video');\n      this.video.hidden = true;\n      this.video.muted = true;\n      this.video.srcObject = canvas.captureStream();\n      this.video.play();\n      const draw = () => {\n        const { pip } = store.playerState;\n        if (!pip) {\n          ctx.rect(0, 0, 1, 1);\n          ctx.fill();\n        } else {\n          const landscape = pip.naturalWidth > pip.naturalHeight;\n          ctx.drawImage(\n            pip,\n            landscape ? (pip.naturalWidth - pip.naturalHeight) / 2 : 0,\n            landscape ? 0 : -(pip.naturalWidth - pip.naturalHeight) / 2,\n            landscape ? pip.naturalHeight : pip.naturalWidth,\n            landscape ? pip.naturalHeight : pip.naturalWidth,\n            0,\n            0,\n            300,\n            300,\n          );\n        }\n        setTimeout(draw, 80);\n      };\n      draw();\n      this.video.addEventListener('leavepictureinpicture', () => {\n        updateStore(store.playerState, { pip: null });\n      });\n    }\n\n    endHandle = () => {\n      const { shuffle, mode } = store.playerState;\n      if (shuffle) {\n        this.randomPlay();\n      } else if (mode === 'repeat') {\n        this.nextPlay();\n      } else {\n        // repeat-one\n        this.audio.play();\n      }\n    };\n\n    randomPlay = () => {\n      const { list } = store.songData;\n      const randomIndex = Math.floor(Math.random() * list.length);\n      updateStore(store.playerState, { currentSong: list[randomIndex] });\n    };\n\n    nextPlay = () => {\n      const { currentSong } = store.playerState;\n      const { list } = store.songData;\n      const currentIndex = list.findIndex(songId => songId === currentSong);\n      let nextIndex;\n      if (currentIndex === list.length - 1) {\n        nextIndex = 0;\n      } else {\n        nextIndex = currentIndex + 1;\n      }\n\n      updateStore(store.playerState, {\n        state: 'playing',\n        currentSong: list[nextIndex],\n      });\n    };\n\n    playSuccess = () => {\n      const { currentSong, errorList, state } = store.playerState;\n\n      const index = errorList.indexOf(currentSong);\n      const isError = index > -1;\n      const isPlayingState = state === 'playing';\n      if (isError) errorList.splice(index, 1);\n      if (isError || !isPlayingState) {\n        updateStore(store.playerState, { errorList, state: 'playing' });\n      }\n    };\n\n    playError = () => {\n      const { currentSong, errorList, state } = store.playerState;\n\n      const isError = errorList.includes(currentSong);\n      const isErrorState = state === 'error';\n      if (!isError) errorList.push(currentSong);\n      if (!isError || !isErrorState) {\n        updateStore(store.playerState, { errorList, state: 'error' });\n      }\n    };\n\n    enterPictureInPicture = () => {\n      this.video.requestPictureInPicture().catch(error => {\n        console.error(error);\n        updateStore(store.playerState, { pip: null });\n      });\n    };\n\n    render = () => {\n      const { currentSong, state, volume, muted, pip } = store.playerState;\n      const { currentTime } = store.audioState;\n      const song = songMap.get(currentSong);\n      if (!('id' in song)) return;\n\n      if (document.pictureInPictureElement && !pip) {\n        document.exitPictureInPicture();\n      }\n      if (!document.pictureInPictureElement && pip) {\n        this.enterPictureInPicture();\n      }\n\n      // switch mute\n      if (muted !== this.audio.muted) {\n        this.audio.muted = muted;\n      }\n      // Change volume\n      if (!mediaQuery.isPhone && volume !== this.audio.volume) {\n        this.audio.volume = volume;\n      }\n      // Adjust playback position\n      if (Math.abs(currentTime - this.audio.currentTime) > 1.2) {\n        this.audio.currentTime = currentTime;\n      }\n      // Change track\n      if (song.id !== Number(this.id)) {\n        this.id = song.id;\n        this.audio.src = getSrc(song.src);\n        updateStore(store.audioState, { currentTime: 0 });\n        mediaSession.setMetadata(song);\n      }\n      // play\n      if (state === 'playing' && this.audio.paused) {\n        this.audio.play();\n        this.video.play();\n      }\n      // pause\n      if (state === 'paused' && !this.audio.paused) {\n        this.audio.pause();\n        this.video.pause();\n      }\n    };\n\n    setCurrentTime = () => {\n      setInterval(() => {\n        const { duration } = store.audioState;\n        if (!this.audio.paused && !this.audio.error) {\n          updateStore(store.audioState, {\n            currentTime: this.audio.duration ? this.audio.currentTime : 0,\n            duration: this.audio.duration || duration,\n          });\n        }\n      }, 1000);\n    };\n\n    async mounted() {\n      const list = await get();\n      if (list[0]) {\n        updateStore(store.playerState, { currentSong: list[0].id });\n      }\n    }\n  },\n);\n","import { html } from '../../js_modules/lit-html.js';\nimport { store, updateStore } from '../../models/index.js';\nimport Component from '../../lib/component.js';\nimport history from '../../lib/history.js';\nimport mediaQuery from '../../lib/mediaquery.js';\nimport Modal from '../modal/index.js';\nimport routeMap from '../router/map.js';\nimport getSongEditModal from '../modals/song-edit.js';\nimport { songMap } from '../../models/data-map.js';\n\nimport './song-info.js';\nimport './control.js';\nimport './volume.js';\nimport './progress.js';\nimport './audio.js';\n\ncustomElements.define(\n  'app-player',\n  class extends Component {\n    static observedStores = [store.playerState];\n\n    close = () => {\n      this.removeAttribute('maximize');\n      updateStore(store.playerState, { maximize: false });\n    };\n\n    clickHandle = () => {\n      const { maximize } = store.playerState;\n\n      if (maximize) {\n        this.removeAttribute('maximize');\n        updateStore(store.playerState, { maximize: false });\n        history.back();\n      } else {\n        this.setAttribute('maximize', '');\n        updateStore(store.playerState, { maximize: true });\n        history.pushState({\n          close: this.close,\n        });\n      }\n    };\n\n    editHandle = () => {\n      const { currentSong } = store.playerState;\n      const song = songMap.get(currentSong);\n      Modal.open(getSongEditModal(song));\n    };\n\n    searchHandle = () => {\n      this.clickHandle();\n      setTimeout(() => {\n        history.push({\n          path: routeMap.SEARCH.path,\n          close: () => setTimeout(this.clickHandle, 100),\n        });\n      }, 100);\n    };\n\n    render() {\n      const { maximize } = store.playerState;\n\n      return html`\n        <style>\n          :host {\n            z-index: 5;\n            contain: strict;\n            position: -webkit-sticky;\n            position: sticky;\n            bottom: 0;\n            flex-shrink: 0;\n            height: var(--player-height);\n            padding-bottom: env(safe-area-inset-bottom);\n            box-sizing: border-box;\n            display: flex;\n            overflow: hidden;\n            background: var(--player-background-color);\n            border-top: 1px solid var(--player-separator-color);\n            color: var(--player-text-primary-color);\n            fill: var(--player-text-primary-color);\n          }\n          player-control {\n            flex-shrink: 0;\n          }\n          player-song-info,\n          player-volume {\n            flex-shrink: 1;\n            flex-grow: 1;\n            width: 0;\n          }\n          .header {\n            display: none;\n          }\n          @media ${mediaQuery.PHONE} {\n            :host {\n              position: fixed;\n              width: 100%;\n              transition: height 0.3s;\n            }\n            :host([maximize]) {\n              flex-direction: column;\n              justify-content: space-between;\n              height: 100%;\n              padding-top: env(safe-area-inset-top);\n            }\n            :host([maximize]) player-song-info {\n              width: auto;\n              flex-grow: initial;\n            }\n            .header {\n              display: flex;\n              align-items: center;\n              flex-shrink: 0;\n              justify-content: space-between;\n              padding: 0.4rem;\n            }\n            :host(:not([maximize])) .header {\n              margin-right: 1.6rem;\n            }\n            :host([maximize]) .nav {\n              margin-right: auto;\n            }\n            :host(:not([maximize])) .action {\n              display: none;\n            }\n            .header app-icon {\n              padding: 1.2rem;\n            }\n          }\n          @media ${mediaQuery.SMALL_PHONE} {\n            :host([maximize]) player-song-info {\n              flex-grow: 1;\n            }\n          }\n          @media ${mediaQuery.MOTION_REDUCE} {\n            :host {\n              transition: none;\n            }\n          }\n          @media ${mediaQuery.WATCH}, ${mediaQuery.PHONE}, ${mediaQuery.SHORT} {\n            :host {\n              border-top: none;\n            }\n            player-volume {\n              display: none;\n            }\n          }\n          @media ${mediaQuery.WATCH} {\n            :host {\n              position: fixed;\n              flex-direction: column;\n              justify-content: space-evenly;\n              align-items: center;\n              width: 100%;\n              height: 100%;\n            }\n            player-song-info {\n              width: 90%;\n              flex-grow: initial;\n              text-align: center;\n            }\n          }\n        </style>\n        <player-audio hidden></player-audio>\n        <div class=\"header\">\n          <app-icon\n            class=\"nav\"\n            @click=\"${this.clickHandle}\"\n            name=\"${maximize ? 'expand-more' : 'expand-less'}\"\n          >\n            <app-ripple scale=\".8\" circle></app-ripple>\n          </app-icon>\n          <app-icon class=\"action\" @click=\"${this.editHandle}\" name=\"edit\">\n            <app-ripple scale=\".8\" circle></app-ripple>\n          </app-icon>\n          <app-icon class=\"action\" @click=\"${this.searchHandle}\" name=\"search\">\n            <app-ripple scale=\".8\" circle></app-ripple>\n          </app-icon>\n        </div>\n        <player-song-info ?maximize=\"${maximize}\"></player-song-info>\n        <player-progress ?maximize=\"${maximize}\"></player-progress>\n        <player-control ?maximize=\"${maximize}\"></player-control>\n        <player-volume></player-volume>\n      `;\n    }\n  },\n);\n","import { html } from '../../js_modules/lit-html.js';\nimport Component from '../../lib/component.js';\n\ncustomElements.define(\n  'app-range',\n  class extends Component {\n    static observedAttributes = ['value'];\n\n    clickHandle = ({ x }) => {\n      const { left, width } = this.getBoundingClientRect();\n      const nextValue = Math.floor(((x - left) * 100) / width);\n      this.setAttribute('value', nextValue);\n      this.dispatchEvent(new CustomEvent('change', { detail: nextValue }));\n    };\n\n    render() {\n      const value = this.getAttribute('value');\n\n      return html`\n        <style>\n          :host {\n            display: flex;\n            flex-direction: row-reverse;\n            align-items: center;\n          }\n          .track {\n            width: 100%;\n            height: 2px;\n            padding: calc((1em - 2px) / 2) 0;\n            background: var(--player-text-secondary-color);\n            background-clip: content-box;\n          }\n          .value {\n            position: relative;\n            height: 100%;\n            background: currentColor;\n          }\n          .dot {\n            position: absolute;\n            top: 50%;\n            right: 0;\n            width: 0.75em;\n            height: 0.75em;\n            border-radius: 100%;\n            background: currentColor;\n            transform: translate(50%, -50%);\n          }\n        </style>\n        <div class=\"track\" @click=\"${this.clickHandle}\">\n          <div class=\"value\" style=\"width: ${value}%\">\n            <div class=\"dot\"></div>\n          </div>\n        </div>\n      `;\n    }\n  },\n);\n","import { html } from '../../js_modules/lit-html.js';\nimport Component from '../../lib/component.js';\nimport { isEqual } from '../../utils/object.js';\n\ncustomElements.define(\n  'app-ripple',\n  class extends Component {\n    constructor() {\n      super();\n      const type = this.getAttribute('type');\n      this.timer = null;\n      if (type === 'touch') {\n        this.touchHandleTimer = null;\n        this.ontouchstart = this.touchStartHandle;\n        this.ontouchend = this.touchEndHandle;\n      } else {\n        this.onmousedown = this.mouseDownHandle;\n      }\n    }\n\n    touchStartHandle({ targetTouches: [touche] }) {\n      const { left, top } = this.getBoundingClientRect();\n      const x = touche.clientX - left;\n      const y = touche.clientY - top;\n\n      const touchHandleTimer = setTimeout(() => {\n        const {\n          left: currentLeft,\n          top: currentTop,\n        } = this.getBoundingClientRect();\n        if (\n          isEqual({ left: currentLeft, top: currentTop }, { left, top }) &&\n          this.touchHandleTimer === touchHandleTimer\n        ) {\n          this.mouseDownHandle({ offsetX: x, offsetY: y });\n        }\n      }, 200);\n      this.touchHandleTimer = touchHandleTimer;\n    }\n\n    touchEndHandle() {\n      clearTimeout(this.touchHandleTimer);\n      this.touchHandleTimer = null;\n    }\n\n    mouseDownHandle(event) {\n      const { offsetX: x, offsetY: y } = event;\n      const disabled = this.hasAttribute('disabled');\n      if (disabled) return;\n\n      const isCircle = this.hasAttribute('circle');\n\n      const duration = parseInt(this.getAttribute('duration'), 10) || 600;\n      const color =\n        this.getAttribute('color') || window.getComputedStyle(this).color;\n      const scale = this.getAttribute('scale') || (isCircle ? 1.5 : 1);\n      const opacity = this.getAttribute('opacity') || 0.08;\n\n      this.classList.add('animating');\n      const { clientWidth, clientHeight } = this;\n      const start = performance.now();\n      cancelAnimationFrame(this.timer);\n      const raf = now => {\n        const count = Math.floor(now - start);\n        this.style.cssText = `\n          --ripple-x: ${isCircle ? clientWidth / 2 : x};\n          --ripple-y: ${isCircle ? clientHeight / 2 : y};\n          --ripple-color: ${color};\n          --animation-tick: ${count};\n          --animation-duration: ${duration};\n          transform: scale(${scale});\n          opacity: ${opacity};\n        `;\n        if (count > duration) {\n          this.classList.remove('animating');\n          this.style.cssText = '--animation-tick: 0';\n          return;\n        }\n        this.timer = requestAnimationFrame(raf);\n      };\n      requestAnimationFrame(raf);\n    }\n\n    render() {\n      return html`\n        <style>\n          :host {\n            position: absolute;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n          }\n          :host(.animating) {\n            background-image: paint(ripple);\n          }\n          :host([circle]) {\n            border-radius: 100vw;\n          }\n        </style>\n      `;\n    }\n  },\n);\n","import { store, updateStore, connect } from '../models/index.js';\nimport { songMap } from '../models/data-map.js';\n\n// eslint-disable-next-line\nexport const get = async () => {\n  const map = new Map();\n  songMap.forEach(song => {\n    if (map.has(song.album)) return;\n    map.set(song.album, {\n      title: song.album,\n      cover: song.picture,\n    });\n  });\n  const list = [...map.values()];\n  updateStore(store.albumData, { list });\n  return list;\n};\n\nconnect(\n  store.songData,\n  get,\n);\n","import { store, updateStore, connect } from '../models/index.js';\nimport { songMap } from '../models/data-map.js';\n\nconst map = new Map();\n\nexport const get = async () => {\n  songMap.forEach(song => {\n    if (map.has(song.artist)) return;\n    map.set(song.artist, {\n      name: song.artist,\n      photo: '',\n    });\n  });\n  const list = [...map.values()];\n  updateStore(store.artistData, { list });\n  return list;\n};\n\nconnect(\n  store.songData,\n  get,\n);\n","import { html } from '../../js_modules/lit-html.js';\nimport Component from '../../lib/component.js';\nimport history from '../../lib/history.js';\nimport mediaQuery from '../../lib/mediaquery.js';\nimport { store } from '../../models/index.js';\nimport { getFavorite } from '../../services/song.js';\nimport { get as getAllPlaylist, getSong } from '../../services/playlist.js';\nimport { get as getAllAlbum } from '../../services/album.js';\nimport { get as getAllArtist } from '../../services/artist.js';\nimport AppAction from '../action/index.js';\nimport routeMap from './map.js';\n\ncustomElements.define(\n  'app-router',\n  class extends Component {\n    static observedStores = [history.historyState];\n\n    href = history.location.href;\n\n    shouldUpdate() {\n      const { href } = history.location;\n      if (href !== this.href) {\n        this.scrollTop = 0;\n        this.href = href;\n        return true;\n      }\n      return false;\n    }\n\n    render() {\n      const { path, query } = history.location;\n      const filtername = query.has(routeMap.ARTISTS.subTitle)\n        ? routeMap.ARTISTS.subTitle\n        : query.has(routeMap.ALBUMS.subTitle) && routeMap.ALBUMS.subTitle;\n      const filtervalue = query.get(filtername);\n\n      let content;\n      let action;\n      switch (path) {\n        case routeMap.HOME.path:\n        case routeMap.SONGS.path:\n          content = html`\n            <app-song-list\n              filtername=\"${filtername || ''}\"\n              filtervalue=\"${filtervalue}\"\n              .data=\"${store.songData}\"\n            >\n            </app-song-list>\n          `;\n          action = html`\n            <app-action\n              .actions=\"${[\n                AppAction.MENU,\n                AppAction.TITLE,\n                AppAction.UPLOAD,\n                AppAction.SEARCH,\n              ]}\"\n            >\n            </app-action>\n          `;\n          break;\n        case routeMap.PLAYLIST.path:\n          content = html`\n            <app-song-list\n              id=\"${query.get('id')}\"\n              .fetchData=\"${() => getSong(history.location.query.get('id'))}\"\n              .data=\"${store.playlistData}\"\n            >\n            </app-song-list>\n          `;\n          action = html`\n            <app-action\n              .actions=\"${[\n                AppAction.MENU,\n                AppAction.TITLE,\n                AppAction.UPLOAD,\n                AppAction.SEARCH,\n              ]}\"\n            >\n            </app-action>\n          `;\n          break;\n        case routeMap.FAVORITES.path:\n          content = html`\n            <app-song-list\n              .fetchData=\"${getFavorite}\"\n              .data=\"${store.favoriteData}\"\n            >\n            </app-song-list>\n          `;\n          action = html`\n            <app-action\n              .actions=\"${[\n                AppAction.MENU,\n                AppAction.TITLE,\n                AppAction.UPLOAD,\n                AppAction.SEARCH,\n              ]}\"\n            >\n            </app-action>\n          `;\n          break;\n        case routeMap.SEARCH.path:\n          content = html`\n            <app-song-list .data=\"${store.searchData}\"> </app-song-list>\n          `;\n          action = html`\n            <app-action .actions=\"${[AppAction.BACK, AppAction.SEARCH_INPUT]}\">\n            </app-action>\n          `;\n          break;\n        case routeMap.ALBUMS.path:\n          content = html`\n            <app-album-list\n              .fetchData=\"${getAllAlbum}\"\n              .data=\"${store.albumData}\"\n            >\n            </app-album-list>\n          `;\n          action = html`\n            <app-action\n              .actions=\"${[\n                AppAction.MENU,\n                AppAction.TITLE,\n                AppAction.UPLOAD,\n                AppAction.SEARCH,\n              ]}\"\n            >\n            </app-action>\n          `;\n          break;\n        case routeMap.ARTISTS.path:\n          content = html`\n            <app-artist-list\n              .fetchData=\"${getAllArtist}\"\n              .data=\"${store.artistData}\"\n            >\n            </app-artist-list>\n          `;\n          action = html`\n            <app-action\n              .actions=\"${[\n                AppAction.MENU,\n                AppAction.TITLE,\n                AppAction.UPLOAD,\n                AppAction.SEARCH,\n              ]}\"\n            >\n            </app-action>\n          `;\n          break;\n        case routeMap.PLAYLISTS.path:\n          content = html`\n            <app-playlist-list\n              .fetchData=\"${getAllPlaylist}\"\n              .data=\"${store.playlistData}\"\n            >\n            </app-playlist-list>\n          `;\n          action = html`\n            <app-action\n              .actions=\"${[\n                AppAction.MENU,\n                AppAction.TITLE,\n                AppAction.ADD_PLAYLIST,\n                AppAction.SEARCH,\n              ]}\"\n            >\n            </app-action>\n          `;\n          break;\n        default:\n          content = html`\n            <app-notfound></app-notfound>\n          `;\n          action = html`\n            <app-action\n              .actions=\"${mediaQuery.isPhone\n                ? [AppAction.MENU, AppAction.TITLE]\n                : []}\"\n            >\n            </app-action>\n          `;\n      }\n      return html`\n        <style>\n          :host {\n            flex-grow: 1;\n            display: flex;\n            flex-direction: column;\n            padding: var(--list-padding) var(--list-padding) 0\n              calc(var(--drawer-width) + var(--list-padding));\n            background: linear-gradient(\n              to top,\n              var(--list-background-color),\n              var(--list-background-light-color)\n            );\n            color: var(--list-text-primary-color);\n            fill: var(--list-text-primary-color);\n            overflow: auto;\n            scrollbar-width: thin;\n            scrollbar-color: var(--scrollbar-color) var(--scrollbar-track-color);\n          }\n\n          :host::after {\n            content: '';\n            display: block;\n            height: var(--list-padding);\n            flex-shrink: 0;\n          }\n\n          .wrap {\n            flex-shrink: 0;\n            flex-grow: 1;\n            display: flex;\n            flex-direction: column;\n            width: 100%;\n            max-width: 86rem;\n            margin: 0 auto;\n            box-sizing: border-box;\n          }\n          @media ${mediaQuery.PHONE} {\n            :host {\n              margin-bottom: var(--player-height);\n            }\n          }\n          @media ${mediaQuery.PHONE_LANDSCAPE},\n            ${mediaQuery.PHONE},\n            ${mediaQuery.TABLET} {\n            :host {\n              padding: var(--list-padding) var(--list-padding) 0;\n            }\n            :host::-webkit-scrollbar {\n              width: 0;\n            }\n            :host {\n              scrollbar-width: none;\n            }\n          }\n        </style>\n        <div class=\"wrap\">\n          ${action} ${content}\n        </div>\n      `;\n    }\n  },\n);\n","import Component from '../../lib/component.js';\nimport history from '../../lib/history.js';\nimport { capitalize } from '../../utils/string.js';\nimport routeMap from '../router/map.js';\n\n/**\n * Synchronize documet.title\n * also show in AppBar\n */\ncustomElements.define(\n  'app-title',\n  class extends Component {\n    static observedStores = [history.historyState];\n\n    routeMap = Object.values(routeMap);\n\n    render() {\n      const { list, currentIndex } = history.historyState;\n      const { path: currentPath, title } = list[currentIndex];\n      const route = this.routeMap.find(({ path }) => path === currentPath);\n\n      document.title = capitalize(\n        title || (route && route.title) || routeMap.HOME.title,\n      );\n      if (this.hidden) return '';\n      return document.title;\n    }\n  },\n);\n","import { html } from '../../js_modules/lit-html.js';\nimport { store, updateStore } from '../../models/index.js';\nimport { SingleInstanceComponent } from '../../lib/component.js';\n\nconst LIFE_TIME = 3000;\nconst InitData = Object.assign({}, store.toastState);\n\nconst showToastList = [];\nlet showUploaderState = 0;\n\nexport default class AppToast extends SingleInstanceComponent {\n  static open(state) {\n    updateStore(store.toastState, state);\n    setTimeout(() => {\n      updateStore(store.toastState, InitData);\n    }, LIFE_TIME);\n  }\n\n  static observedStores = [store.toastState, store.uploaderState];\n\n  preprocess() {\n    const { text } = store.toastState;\n    const { list } = store.uploaderState;\n    if (list.length) {\n      showUploaderState = list.length;\n    } else if (showUploaderState) {\n      showUploaderState = 'uploaded';\n      setTimeout(() => {\n        showUploaderState = 0;\n        this.update();\n      }, LIFE_TIME);\n    }\n\n    if (text) {\n      const index = showToastList.findIndex(({ text: t }) => t === text);\n      if (index > -1) {\n        const toast = showToastList[index];\n        clearTimeout(toast.timer);\n        showToastList.splice(index, 1);\n      }\n      showToastList.push({\n        text,\n        timer: setTimeout(() => {\n          showToastList.splice(\n            showToastList.findIndex(({ text: t }) => t === text),\n            1,\n          );\n          this.update();\n        }, LIFE_TIME),\n      });\n    }\n  }\n\n  render() {\n    this.preprocess();\n\n    if (!showToastList.length && !showUploaderState) return html``;\n\n    const { errorList } = store.uploaderState;\n\n    return html`\n      <style>\n        :host {\n          z-index: 9;\n          position: fixed;\n          left: 1.6rem;\n          bottom: calc(1.6rem + var(--player-height));\n          display: flex;\n          flex-direction: column;\n          color: var(--toast-text-color);\n          font-size: 1.4rem;\n        }\n        div {\n          min-width: 20em;\n          padding: 0.6em;\n          border: 1px solid var(--toast-border-color);\n          background: var(--toast-background-color);\n        }\n        div:not(:last-of-type) {\n          margin-bottom: 0.6em;\n        }\n      </style>\n      ${showToastList.map(\n        ({ text }) =>\n          html`\n            <div>${text}</div>\n          `,\n      )}\n      <div ?hidden=\"${!showUploaderState}\">\n        ${showUploaderState === 'uploaded'\n          ? `upload compelete: failure ${errorList.length}`\n          : `${showUploaderState} songs are being uploaded...`}\n      </div>\n    `;\n  }\n}\n\ncustomElements.define('app-toast', AppToast);\n","import './theme.js';\n\nimport './icons/index.js';\n\nimport './components/action/index.js';\nimport './components/confirm/index.js';\nimport './components/drawer/index.js';\nimport './components/image/index.js';\nimport './components/form/index.js';\nimport './components/link/index.js';\nimport './components/list/index.js';\nimport './components/menu/index.js';\nimport './components/modal/index.js';\nimport './components/notfound/index.js';\nimport './components/player/index.js';\nimport './components/range/index.js';\nimport './components/ripple/index.js';\nimport './components/router/index.js';\nimport './components/splash/index.js';\nimport './components/title/index.js';\nimport './components/toast/index.js';\nimport './components/upload/index.js';\n\nimport {\n  isSupportPaintWorklet,\n  isSupportWerviceWorker,\n} from './utils/feature.js';\n\nwindow.addEventListener('load', () => {\n  if (isSupportPaintWorklet()) {\n    CSS.paintWorklet.addModule('paintworklet.js');\n  }\n\n  if (isSupportWerviceWorker()) {\n    navigator.serviceWorker.register('serviceworker.js');\n  }\n});\n\nwindow.onerror = null;\n\n// test\n// import './test/models.tests.js';\n","export function isSupportPaintWorklet() {\n  return 'paintWorklet' in CSS;\n}\n\nexport function isSupportWerviceWorker() {\n  return 'serviceWorker' in navigator;\n}\n"],"sourceRoot":""}